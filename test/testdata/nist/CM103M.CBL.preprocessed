      *> HEADER,COBOL,CM103M
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           CM103M.
       AUTHOR.
      *>CE     FEDERAL COMPILER TESTING CENTER.
      *>  INSTALLATION.
      *>CE      GENERAL SERVICES ADMINISTRATION
      *>CE *     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
      *>CE      SOFTWARE DEVELOPMENT OFFICE.
      *>CE      5203 LEESBURG PIKE  SUITE 1100
      *>CE      FALLS CHURCH VIRGINIA 22041.
      *>CE 
      *>CE      PHONE   (703) 756-6153
      *>CE 
      *>CE      " HIGH       ".
       DATE-WRITTEN.
      *>CE     CCVS-74 VERSION 4.0 - 1980 JULY 1.
      *>CE     CREATION DATE     /    VALIDATION DATE
      *>CE     "4.2 ".
       SECURITY.
      *>CE     NONE.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE
           LABEL RECORDS
           XXXXX084
           DATA RECORD IS PRINT-REC DUMMY-RECORD.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       WORKING-STORAGE SECTION.
       01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
       01  REC-CT PICTURE 99 VALUE ZERO.
       01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
       01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
       01  INSPECT-COUNTER PIC 999 VALUE ZERO.
       01  PASS-COUNTER PIC 999 VALUE ZERO.
       01  TOTAL-ERROR PIC 999 VALUE ZERO.
       01  ERROR-HOLD PIC 999 VALUE ZERO.
       01  DUMMY-HOLD PIC X(120) VALUE SPACE.
       01  RECORD-COUNT PIC 9(5) VALUE ZERO.
       01  CCVS-H-1.
           02  FILLER   PICTURE X(27)  VALUE SPACE.
           02 FILLER PICTURE X(67) VALUE
           " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION   SYSTEM".
           02  FILLER     PICTURE X(26)  VALUE SPACE.
       01  CCVS-H-2.
           02 FILLER PICTURE X(52) VALUE IS
           "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
           02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
           02 TEST-ID PICTURE IS X(9).
           02 FILLER PICTURE IS X(40) VALUE IS SPACE.
       01  CCVS-H-3.
           02  FILLER PICTURE X(34) VALUE
           " FOR OFFICIAL USE ONLY    ".
           02  FILLER PICTURE X(58) VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER PICTURE X(28) VALUE
           "  COPYRIGHT   1974 ".
       01  CCVS-E-1.
           02 FILLER PICTURE IS X(52) VALUE IS SPACE.
           02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN PICTURE IS X(9).
           02 FILLER PICTURE X(45) VALUE IS
           " NTIS DISTRIBUTION COBOL 74".
       01  CCVS-E-2.
           02  FILLER                   PICTURE X(31)  VALUE
           SPACE.
           02  FILLER                   PICTURE X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
               03 FILLER PICTURE IS X VALUE IS SPACE.
               03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER PICTURE X(22) VALUE
           " FOR OFFICIAL USE ONLY".
           02  FILLER PICTURE X(12) VALUE SPACE.
           02  FILLER PICTURE X(58) VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER PICTURE X(13) VALUE SPACE.
           02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
       01  CCVS-E-4.
           02 CCVS-E-4-1 PIC XXX VALUE SPACE.
           02 FILLER PIC XXXX VALUE " OF ".
           02 CCVS-E-4-2 PIC XXX VALUE SPACE.
           02 FILLER PIC X(40) VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
           02 INFO-TEXT.
           04 FILLER PIC X(20) VALUE SPACE.
           04 XXCOMPUTED PIC X(20).
           04 FILLER PIC X(5) VALUE SPACE.
           04 XXCORRECT PIC X(20).
       01  HYPHEN-LINE.
           02 FILLER PICTURE IS X VALUE IS SPACE.
           02 FILLER PICTURE IS X(65) VALUE IS "*****************************************************************".
           02 FILLER PICTURE IS X(54) VALUE IS "******************************************************".
       01  CCVS-PGM-ID PIC X(6) VALUE
           "CM103M".
       01  MCS-TIME.
           02  HRS PIC 99.
           02  MINS PIC 99.
           02  SECS PIC 99V99.
       01  IN-TIME.
           02  IN-HRS PIC 99.
           02  IN-MINS PIC 99.
           02  IN-SECS PIC 99V99.
       01  OUT-TIME.
           02  OUT-HRS PIC 99.
           02  OUT-MINS PIC 99.
           02  OUT-SECS PIC 99V99.
       01  LOG-HDR-1.
           02  FILLER PIC X(54) VALUE SPACES.
           02  FILLER PIC X(11) VALUE "MESSAGE LOG".
       01  LOG-HDR-2.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(12) VALUE "MCS RECEIPT".
           02  FILLER PIC X(8) VALUE "PROGRAM".
           02  FILLER PIC X(9) VALUE "MCS REC".
           02  FILLER PIC X(12) VALUE "RECV SEND".
           02  FILLER PIC X(38) VALUE "MSG".
           02  FILLER PIC X(7) VALUE "MESSAGE".
       01  LOG-HDR-3.
           02  FILLER PIC XXX VALUE SPACE.
           02  FILLER PIC X(10) VALUE "INBOUND".
           02  FILLER PIC X(8) VALUE "RECEIPT".
           02  FILLER PIC X(9) VALUE "OUTB""ND".
           02  FILLER PIC X(11) VALUE "STAT STAT".
           02  FILLER PIC X(39) VALUE "LENGTH".
           02  FILLER PIC X(7) VALUE "CONTENT".
       01  LOG-HDR-4.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(11) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(7) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(7) VALUE ALL "-".
           02  FILLER PIC XX VALUE SPACES.
           02  FILLER PIC X(11) VALUE "---- ----".
           02  FILLER PIC X(5) VALUE ALL "-".
           02  FILLER PIC XX VALUE SPACES.
           02  FILLER PIC X(72) VALUE ALL "-".
       01  LOG-LINE.
           02  FILLER PIC X VALUE SPACE.
           02  TIME-REC.
               03  HRS PIC 99.
               03  FILLER PIC X VALUE ":".
               03  MINS PIC 99.
               03  FILLER PIC X VALUE ":".
               03  SECS PIC 99.99.
           02  FILLER PIC X VALUE SPACE.
           02  PROG-TIME PIC ---.99.
           02  FILLER PIC XX VALUE SPACES.
           02  TIME-SENT PIC ---.99.
           02  FILLER PIC XXXX VALUE SPACES.
           02  RECV-STATUS PIC XX.
           02  FILLER PIC XX VALUE SPACES.
           02  SEND-STATUS PIC XX.
           02  FILLER PIC X VALUE "/".
           02  SEND-ERR PIC X.
           02  FILLER PIC XXX VALUE SPACES.
           02  MSG-LNGTH PIC ZZ9.
           02  FILLER PIC XXX VALUE SPACES.
           02  MSG.
               03  KILL-FIELD PIC X(4).
               03  FILLER PIC X(68).
       COMMUNICATION SECTION.
       CD  CM-INQUE-1 FOR INPUT
           MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3 FILLER TIME-RECEIVED
           FILLER IN-LENGTH END-KEY IN-STATUS FILLER.
       CD  CM-OUTQUE-1 FOR OUTPUT.
       01  OUTQUE-SPECIFICATIONS.
           02  ONE PIC 9999 VALUE IS 1.
           02  OUT-LENGTH PIC 9999.
           02  OUT-STATUS PIC XX.
           02  ERR-KEY PIC X.
           02  SYM-DEST PIC X(12) VALUE IS
           XXXXX032.
       PROCEDURE    DIVISION.
       SECT-CM103M-0001 SECTION.
       CM103M-INIT.
           OPEN     OUTPUT PRINT-FILE.
           MOVE "CM103M     " TO TEST-ID.
           MOVE     TEST-ID TO ID-AGAIN.
           MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           ENABLE INPUT CM-INQUE-1 WITH KEY
           XXXXX031.
           ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
           XXXXX033.
           PERFORM HEAD-ROUTINE.
           PERFORM LOG-HEADER.
       RECEIVE-ECHO-AND-LOG.
           MOVE SPACES TO MSG.
           RECEIVE CM-INQUE-1 MESSAGE INTO MSG.
           ACCEPT IN-TIME FROM TIME.
           IF IN-LENGTH IS GREATER THAN 72
               MOVE 72 TO OUT-LENGTH
               ELSE MOVE IN-LENGTH TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM MSG WITH EMI.
           ACCEPT OUT-TIME FROM TIME.
           MOVE TIME-RECEIVED TO MCS-TIME.
           MOVE CORR MCS-TIME TO TIME-REC.
           COMPUTE PROG-TIME =
               (IN-HRS * 3600 + IN-MINS * 60 + IN-SECS)  -
               (HRS OF MCS-TIME * 3600 + MINS OF MCS-TIME * 60 +
                SECS OF MCS-TIME).
           COMPUTE TIME-SENT =
               (OUT-HRS * 3600 + OUT-MINS * 60 + OUT-SECS)  -
               (HRS OF MCS-TIME * 3600 + MINS OF MCS-TIME * 60 +
                SECS OF MCS-TIME).
           MOVE IN-STATUS TO RECV-STATUS.
           MOVE OUT-STATUS TO SEND-STATUS.
           MOVE ERR-KEY TO SEND-ERR.
           MOVE IN-LENGTH TO MSG-LNGTH.
           MOVE LOG-LINE TO PRINT-REC.
           WRITE PRINT-REC.
           IF KILL-FIELD IS NOT EQUAL TO "KILL"
               GO TO RECEIVE-ECHO-AND-LOG.
           PERFORM END-ROUTINE THRU END-ROUTINE-3.
           CLOSE    PRINT-FILE.
           STOP     RUN.
       END-ROUTINE.
           MOVE     HYPHEN-LINE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       PARA-Z.
           PERFORM  BLANK-LINE-PRINT 4 TIMES.
           MOVE     CCVS-E-1 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-3.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           MOVE CCVS-E-3 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       BLANK-LINE-PRINT.
           MOVE     SPACE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       WRITE-LINE.
           WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
       LOG-HEADER.
           MOVE LOG-HDR-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER 3 LINES.
           MOVE LOG-HDR-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 3 LINES.
           MOVE LOG-HDR-3 TO PRINT-REC.
           WRITE PRINT-REC
           MOVE LOG-HDR-4 TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE SPACES TO PRINT-REC.
           PERFORM WRITE-LINE.
       HEAD-ROUTINE.
           MOVE CCVS-H-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER ADVANCING PAGE.
           MOVE CCVS-H-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE CCVS-H-3 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 5 LINES.
           MOVE HYPHEN-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
      *> END-OF,CM103M