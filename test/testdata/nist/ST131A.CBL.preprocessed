      *> HEADER,COBOL,ST131A
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           ST131A.
      *> ***************************************************************
      *>                                                               *
      *>     VALIDATION FOR:-                                          *
      *>                                                               *
      *>     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
      *>                                                               *
      *>     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
      *>                                                               *
      *> ***************************************************************
      *>                                                               *
      *>       X-CARDS USED BY THIS PROGRAM ARE :-                     *
      *>                                                               *
      *>         X-55  - SYSTEM PRINTER NAME.                          *
      *>         X-82  - SOURCE COMPUTER NAME.                         *
      *>         X-83  - OBJECT COMPUTER NAME.                         *
      *>                                                               *
      *> ***************************************************************
      *>     THIS PROGRAM CONTAINS 3 SORTS USING NUMERIC OR ALPHABETIC
      *>     KEYS - BUT NOT BOTH IN THE SAME KEY  DUE TO DIFFERING
      *>     COLLATING SEQUENCES AMONG COMPUTERS. EXTERNAL FILES ARE
      *>     GENERATED INTERNALLY FOR SUBSEQUENT USE. THE SELECT CLAUSE
      *>     IS HIGHLY DEPENDENT ON HARDWARE. THE USER SHOULD EXERCISE THE
      *>     VARIOUS OPTIONS OF HARDWARE ASSIGNMENTS TO THE EXTENT THEY
      *>     ARE AVAILABLE. THE SORT OF A MULTI-REEL FILE IS EXERCISED
      *>     IN PROGRAM ST202. HOWEVER THE EXERCISE OF THE "FOR MULTIPLE
      *>     REEL-UNIT" OF THE GIVING OPTION IS NOT DUE TO THE INDETER-
      *>     MINATE LENGTH OF SUCH A FILE (E.G. RECORDING DENSITY OR SIZE
      *>     OF UNIT) AND PROCESSING COST. SORT INPUT-OUTPUT OPTIONS
      *>     WILL BE EXERCISED AS FOLLOWS.
      *>         SORT 1  USING        GIVING
      *>         SORT 2  INPUT PROC   GIVING
      *>         SORT 3  INPUT PROC   OUTPUT PROC
       
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
           SELECT SORT1 ASSIGN TO
           XXXXX027.
           SELECT SORT2 ASSIGN TO
           XXXXX028.
           SELECT SORT3 ASSIGN TO
           XXXXX029.
           SELECT FILE1 ASSIGN TO
           XXXXX001.
           SELECT FILE2 ASSIGN TO
           XXXXX014.
           SELECT FILE3 ASSIGN TO
           XXXXX015.
       I-O-CONTROL.
           SAME RECORD AREA FOR SORT1 SORT2
           SAME RECORD AREA FOR SORT3 FILE3.
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       FD  FILE1
           LABEL RECORDS ARE STANDARD
           VALUE OF
           XXXXX074
           IS
           XXXXX075
           BLOCK CONTAINS 10 RECORDS
           DATA RECORD R1
           .
       01  R1.
           02  FILLER PICTURE X(120).
       FD  FILE2
           LABEL RECORDS ARE STANDARD
           VALUE OF
           XXXXX074
           IS
           XXXXX076
           BLOCK CONTAINS 10 RECORDS
           DATA RECORD R2
           .
       01  R2.
           02  R2-KEYS.
               03  R2-1 PICTURE 999.
               03  R2-2 PICTURE AA.
               03  R2-3 PICTURE AA.
           02  FILLER PICTURE X(113).
       FD  FILE3
           BLOCK CONTAINS 10 RECORDS
           LABEL RECORDS ARE STANDARD
           VALUE OF
           XXXXX074
           IS
           XXXXX077
           DATA RECORD IS R3
           .
       01  R3.
           02  R3-KEYS.
               03  R3-1 PICTURE 999.
               03  R3-2 PICTURE AA.
               03  R3-3 PICTURE AA.
               03  R3-4 PICTURE 9999.
           02  FILLER PICTURE X(109).
       SD  SORT1
           RECORD CONTAINS 120 CHARACTERS
           DATA RECORD IS S1.
       01  S1.
           02  S1-KEYS.
               03  S1-1 PICTURE 999.
               03  S1-2 PICTURE AA.
           02  FILLER PICTURE X(115).
       SD  SORT2
           RECORD 120
           DATA RECORD IS S2.
       01  S2.
           02  S2-KEYS.
               03  S2-1 PICTURE 999.
               03  S2-2 PICTURE AA.
               03  S2-3 PICTURE AA.
           02  FILLER PICTURE X(113).
       SD  SORT3
           RECORD 120 CHARACTERS
           DATA RECORD S3.
       01  S3.
           02  S3-KEYS.
               03  S3-1 PICTURE 999.
               03  S3-2 PICTURE AA.
               03  S3-3 PICTURE AA.
               03  S3-4 PICTURE 9999.
           02  FILLER PICTURE X(109).
       WORKING-STORAGE SECTION.
       77  SUBSCRIPT-1 PICTURE  99 COMPUTATIONAL VALUE ZERO.
       77  C0 PICTURE  99 COMPUTATIONAL VALUE ZERO.
       77  C1 PICTURE  99 COMPUTATIONAL VALUE 1.
       77  CA PICTURE A VALUE "A".
       77  CB PICTURE A VALUE "B".
       01  ALPHA-TABLE.
           02  ALPHA-TAB PICTURE IS A(25) VALUE IS "ABCDEFGHIJKLMNPQRSTUVWXYZ".
           02  ALPHA-TBL REDEFINES ALPHA-TAB PICTURE A OCCURS 25 TIMES.
       01  W-KEYS.
           02  W-S3-KEYS.
               03  W-S2-KEYS.
                   04  W-S1-KEYS.
                       05  S1-1W PICTURE 999 VALUE 567.
                       05  S1-2W.
                           06  S1-2W-A PICTURE A.
                           06  S1-2W-B PICTURE A.
                   04  S2-3W.
                       05  S2-3W-A PICTURE A.
                       05  S2-3W-B PICTURE A.
               03  S3-4W PICTURE 9999 VALUE 7051.
       01  FILE-RECORD-INFORMATION-REC.
           03 FILE-RECORD-INFO-SKELETON.
              05 FILLER                 PICTURE X(48)       VALUE
                   "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
              05 FILLER                 PICTURE X(46)       VALUE
                   ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
              05 FILLER                 PICTURE X(26)       VALUE
                   ",LFIL=000000,ORG=  ,LBLR= ".
              05 FILLER                 PICTURE X(37)       VALUE
                   ",RECKEY=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY1=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY2=                             ".
              05 FILLER                 PICTURE X(7)        VALUE SPACE.
           03 FILE-RECORD-INFO          OCCURS  10  TIMES.
              05 FILE-RECORD-INFO-P1-120.
                 07 FILLER              PIC X(5).
                 07 XFILE-NAME           PIC X(6).
                 07 FILLER              PIC X(8).
                 07 XRECORD-NAME         PIC X(6).
                 07 FILLER              PIC X(1).
                 07 REELUNIT-NUMBER     PIC 9(1).
                 07 FILLER              PIC X(7).
                 07 XRECORD-NUMBER       PIC 9(6).
                 07 FILLER              PIC X(6).
                 07 UPDATE-NUMBER       PIC 9(2).
                 07 FILLER              PIC X(5).
                 07 ODO-NUMBER          PIC 9(4).
                 07 FILLER              PIC X(5).
                 07 XPROGRAM-NAME        PIC X(5).
                 07 FILLER              PIC X(7).
                 07 XRECORD-LENGTH       PIC 9(6).
                 07 FILLER              PIC X(7).
                 07 CHARS-OR-RECORDS    PIC X(2).
                 07 FILLER              PIC X(1).
                 07 XBLOCK-SIZE          PIC 9(4).
                 07 FILLER              PIC X(6).
                 07 RECORDS-IN-FILE     PIC 9(6).
                 07 FILLER              PIC X(5).
                 07 XFILE-ORGANIZATION   PIC X(2).
                 07 FILLER              PIC X(6).
                 07 XLABEL-TYPE          PIC X(1).
              05 FILE-RECORD-INFO-P121-240.
                 07 FILLER              PIC X(8).
                 07 XRECORD-KEY          PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY1      PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY2      PIC X(29).
                 07 FILLER              PIC X(7).
       01  TEST-RESULTS.
           02 FILLER                   PIC X      VALUE SPACE.
           02 FEATURE                  PIC X(20)  VALUE SPACE.
           02 FILLER                   PIC X      VALUE SPACE.
           02 P-OR-F                   PIC X(5)   VALUE SPACE.
           02 FILLER                   PIC X      VALUE SPACE.
           02  PAR-NAME.
             03 FILLER                 PIC X(19)  VALUE SPACE.
             03  PARDOT-X              PIC X      VALUE SPACE.
             03 DOTVALUE               PIC 99     VALUE ZERO.
           02 FILLER                   PIC X(8)   VALUE SPACE.
           02 RE-MARK                  PIC X(61).
       01  TEST-COMPUTED.
           02 FILLER                   PIC X(30)  VALUE SPACE.
           02 FILLER                   PIC X(17)  VALUE
                  "       COMPUTED=".
           02 COMPUTED-X.
           03 COMPUTED-A               PIC X(20)  VALUE SPACE.
           03 COMPUTED-N               REDEFINES COMPUTED-A
                                       PIC -9(9).9(9).
           03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
           03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
           03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
           03       CM-18V0 REDEFINES COMPUTED-A.
               04 COMPUTED-18V0                    PIC -9(18).
               04 FILLER                           PIC X.
           03 FILLER PIC X(50) VALUE SPACE.
       01  TEST-CORRECT.
           02 FILLER PIC X(30) VALUE SPACE.
           02 FILLER PIC X(17) VALUE "       CORRECT =".
           02 CORRECT-X.
           03 CORRECT-A                  PIC X(20) VALUE SPACE.
           03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
           03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
           03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
           03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
           03      CR-18V0 REDEFINES CORRECT-A.
               04 CORRECT-18V0                     PIC -9(18).
               04 FILLER                           PIC X.
           03 FILLER PIC X(2) VALUE SPACE.
           03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
       01  CCVS-C-1.
           02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PASS  PARAGRAPH-NAME                                                 REMARKS".
           02 FILLER                     PIC X(20)    VALUE SPACE.
       01  CCVS-C-2.
           02 FILLER                     PIC X        VALUE SPACE.
           02 FILLER                     PIC X(6)     VALUE "TESTED".
           02 FILLER                     PIC X(15)    VALUE SPACE.
           02 FILLER                     PIC X(4)     VALUE "FAIL".
           02 FILLER                     PIC X(94)    VALUE SPACE.
       01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
       01  REC-CT                        PIC 99       VALUE ZERO.
       01  DELETE-COUNTER                PIC 999      VALUE ZERO.
       01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
       01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
       01  PASS-COUNTER                  PIC 999      VALUE ZERO.
       01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
       01  ERROR-HOLD                    PIC 999      VALUE ZERO.
       01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
       01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
       01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
       01  CCVS-H-1.
           02  FILLER                    PIC X(39)    VALUE SPACES.
           02  FILLER                    PIC X(42)    VALUE
           "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
           02  FILLER                    PIC X(39)    VALUE SPACES.
       01  CCVS-H-2A.
         02  FILLER                        PIC X(40)  VALUE SPACE.
         02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
         02  FILLER                        PIC XXXX   VALUE
           "4.2 ".
         02  FILLER                        PIC X(28)  VALUE
                  " COPY - NOT FOR DISTRIBUTION".
         02  FILLER                        PIC X(41)  VALUE SPACE.
       
       01  CCVS-H-2B.
         02  FILLER                        PIC X(15)  VALUE
                  "TEST RESULT OF ".
         02  TEST-ID                       PIC X(9).
         02  FILLER                        PIC X(4)   VALUE
                  " IN ".
         02  FILLER                        PIC X(12)  VALUE
           " HIGH       ".
         02  FILLER                        PIC X(22)  VALUE
                  " LEVEL VALIDATION FOR ".
         02  FILLER                        PIC X(58)  VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
       01  CCVS-H-3.
           02  FILLER                      PIC X(34)  VALUE
                  " FOR OFFICIAL USE ONLY    ".
           02  FILLER                      PIC X(58)  VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER                      PIC X(28)  VALUE
                  "  COPYRIGHT   1985 ".
       01  CCVS-E-1.
           02 FILLER                       PIC X(52)  VALUE SPACE.
           02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN                     PIC X(9).
           02 FILLER                       PIC X(45)  VALUE SPACES.
       01  CCVS-E-2.
           02  FILLER                      PIC X(31)  VALUE SPACE.
           02  FILLER                      PIC X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
               03 FILLER                   PIC X      VALUE SPACE.
               03 ENDER-DESC               PIC X(44)  VALUE
                  "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER                      PIC X(22)  VALUE
                  " FOR OFFICIAL USE ONLY".
           02  FILLER                      PIC X(12)  VALUE SPACE.
           02  FILLER                      PIC X(58)  VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER                      PIC X(13)  VALUE SPACE.
           02 FILLER                       PIC X(15)  VALUE
                   " COPYRIGHT 1985".
       01  CCVS-E-4.
           02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
           02 FILLER                       PIC X(4)   VALUE " OF ".
           02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
           02 FILLER                       PIC X(40)  VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER                       PIC X(19)  VALUE
                  "*** INFORMATION ***".
           02 INFO-TEXT.
             04 FILLER                     PIC X(8)   VALUE SPACE.
             04 XXCOMPUTED                 PIC X(20).
             04 FILLER                     PIC X(5)   VALUE SPACE.
             04 XXCORRECT                  PIC X(20).
           02 INF-ANSI-REFERENCE           PIC X(48).
       01  HYPHEN-LINE.
           02 FILLER  PIC IS X VALUE IS SPACE.
           02 FILLER  PIC IS X(65)    VALUE IS "*****************************************************************".
           02 FILLER  PIC IS X(54)    VALUE IS "******************************************************".
       01  CCVS-PGM-ID                     PIC X(9)   VALUE
           "ST131A".
       PROCEDURE DIVISION.
       CCVS1 SECTION.
       OPEN-FILES.
           OPEN     OUTPUT PRINT-FILE.
           MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
           MOVE    SPACE TO TEST-RESULTS.
           PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
           GO TO CCVS1-EXIT.
       CLOSE-FILES.
           PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
       TERMINATE-CCVS.
      *>     EXIT PROGRAM.
      *> TERMINATE-CALL.
           STOP     RUN.
       INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
              PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
                ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       HEAD-ROUTINE.
           MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
           MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
       COLUMN-NAMES-ROUTINE.
           MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
       END-ROUTINE.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
       END-RTN-EXIT.
           MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
       END-ROUTINE-1.
            ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
            ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
            ADD PASS-COUNTER TO ERROR-HOLD.
      *>      IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
            MOVE PASS-COUNTER TO CCVS-E-4-1.
            MOVE ERROR-HOLD TO CCVS-E-4-2.
            MOVE CCVS-E-4 TO CCVS-E-2-2.
            MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
        END-ROUTINE-12.
            MOVE "TEST(S) FAILED" TO ENDER-DESC.
           IF       ERROR-COUNTER IS EQUAL TO ZERO
               MOVE "NO " TO ERROR-TOTAL
               ELSE
               MOVE ERROR-COUNTER TO ERROR-TOTAL.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-13.
           IF DELETE-COUNTER IS EQUAL TO ZERO
               MOVE "NO " TO ERROR-TOTAL  ELSE
               MOVE DELETE-COUNTER TO ERROR-TOTAL.
           MOVE "TEST(S) DELETED     " TO ENDER-DESC.
           MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
            IF   INSPECT-COUNTER EQUAL TO ZERO
                MOVE "NO " TO ERROR-TOTAL
            ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
            MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
            MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
       WRITE-LINE.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 42
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
      *>         MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
      *>         MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
      *>         MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
      *>         MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN.
       WRT-LN.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT.
           PERFORM WRT-LN.
       FAIL-ROUTINE.
           IF     COMPUTED-X NOT EQUAL TO SPACE
                  GO TO   FAIL-ROUTINE-WRITE.
           IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
           MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
           MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE   SPACES TO INF-ANSI-REFERENCE.
           GO TO  FAIL-ROUTINE-EX.
       FAIL-ROUTINE-WRITE.
           MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
           MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
           MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
           MOVE   SPACES TO COR-ANSI-REFERENCE.
       FAIL-ROUTINE-EX. EXIT.
       BAIL-OUT.
           IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
           IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
       BAIL-OUT-WRITE.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
           MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE   SPACES TO INF-ANSI-REFERENCE.
       BAIL-OUT-EX. EXIT.
       CCVS1-EXIT.
           EXIT.
       P1-CREATE-F1.
           OPEN    OUTPUT FILE1.
           MOVE CA TO S1-2W-A.
           MOVE CB TO S2-3W-A.
       P2-CREATE-F1.
           PERFORM P4-CREATE-F1 2 TIMES.
       P3-CREATE-F1.
           MOVE CA TO S2-3W-A.
           PERFORM P4-CREATE-F1 2 TIMES.
           CLOSE FILE1.
           GO TO FIRST-SORT.
       P4-CREATE-F1.
           MOVE C0 TO SUBSCRIPT-1.
           PERFORM P5-CREATE-F1 25 TIMES.
       P5-CREATE-F1.
           ADD C1 TO SUBSCRIPT-1.
           SUBTRACT C1 FROM S3-4W.
           MOVE ALPHA-TBL (SUBSCRIPT-1) TO S1-2W-B S2-3W-B.
           MOVE W-S3-KEYS TO R1.
           WRITE R1.
       F1-NOTE.
      *>     NOTE.
      *>       KEY-1 WILL BE 567 IN ALL RECORDS.
      *>       KEY-2 WILL BE >A> IN FIRST LETTER WITH 4 OCCURRENCES OF THE
      *>         ALPHABET IN THE SECOND LETTER.
      *>       KEY-3 WILL BE >A> OR >B> IN FIRST LETTER WITH 2 OCCURRENCES
      *>         OF THE ALPHABET FOR EACH IN THE SECOND LETTER.
      *>       KEY-4 WILL VARY FROM 7050 THRU 6951.
      *>       THE LETTER "O" HAS BEEN OMITTED.
       SRT-1 SECTION.
       FIRST-SORT.
           SORT SORT1
               ON DESCENDING KEY S1-1
               ON ASCENDING KEY S1-2
               USING FILE1
               GIVING FILE2.
      *>     NOTE SORT STATEMENT WITH ALL OPTIONAL WORDS.
      *>     NOTE OUTPUT WILL BE TESTED IN THE FOLLOWING INPUT PROCEDURE.
       SRT-2 SECTION.
       SECOND-SORT.
           SORT SORT2
               ASCENDING S2-1
               DESCENDING S2-2
               ASCENDING S2-3
               INPUT PROCEDURE SRT-2-INPUT
               GIVING FILE3.
      *>       NOTE SORT STATEMENT WITH ALL OPTIONAL WORDS OMITTED.
           GO TO SRT-3.
       SRT-2-INPUT SECTION.
       OPEN-1.
           OPEN     INPUT FILE2.
           MOVE     "SORT, INPUT PROC" TO FEATURE.
       SORT-TEST-1.
           PERFORM  READ-RELEASE-FILE2.
           IF       W-S1-KEYS EQUAL TO "567AA"
                    PERFORM PASS-1 GO TO SORT-WRITE-1.
           GO       TO SORT-FAIL-1.
       SORT-DELETE-1.
           PERFORM  DE-LETE-1.
           GO       TO SORT-WRITE-1.
       SORT-FAIL-1.
           MOVE     W-S1-KEYS TO COMPUTED-A.
           MOVE     "567AA" TO CORRECT-A.
           PERFORM  FAIL-1.
       SORT-WRITE-1.
           MOVE     "SORT-TEST-1 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-1.
       SORT-TEST-2.
           PERFORM  READ-RELEASE-FILE2 35 TIMES.
           IF       W-S1-KEYS EQUAL TO "567AI"
                    PERFORM PASS-1 GO TO SORT-WRITE-2.
           GO       TO SORT-FAIL-2.
       SORT-DELETE-2.
           PERFORM  DE-LETE-1.
           GO       TO SORT-WRITE-2.
       SORT-FAIL-2.
           MOVE     W-S1-KEYS TO COMPUTED-A.
           MOVE     "567AI" TO CORRECT-A.
           PERFORM  FAIL-1.
       SORT-WRITE-2.
           MOVE     "SORT-TEST-2 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-1.
       SORT-TEST-3.
           PERFORM  READ-RELEASE-FILE2 35 TIMES.
           IF       W-S1-KEYS EQUAL TO "567AS"
                    PERFORM PASS-1 GO TO SORT-WRITE-3.
           GO       TO SORT-FAIL-3.
       SORT-DELETE-3.
           PERFORM  DE-LETE-1.
           GO       TO SORT-WRITE-3.
       SORT-FAIL-3.
           MOVE     W-S1-KEYS TO COMPUTED-A.
           MOVE     "567AS" TO CORRECT-A.
           PERFORM  FAIL-1.
       SORT-WRITE-3.
           MOVE     "SORT-TEST-3 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-1.
       SORT-TEST-4.
           PERFORM  READ-RELEASE-FILE2 29 TIMES.
           IF       W-S1-KEYS EQUAL TO "567AZ"
                    PERFORM PASS-1 GO TO SORT-WRITE-4.
           GO       TO SORT-FAIL-4.
       SORT-DELETE-4.
           PERFORM  DE-LETE-1.
           GO       TO SORT-WRITE-4.
       SORT-FAIL-4.
           MOVE     W-S1-KEYS TO COMPUTED-A.
           MOVE     "567AZ" TO CORRECT-A.
           PERFORM  FAIL-1.
       SORT-WRITE-4.
           MOVE     "SORT-TEST-4 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-1.
       CLOSE-1.
           CLOSE    FILE2.
           GO       TO EXIT-1.
       READ-RELEASE-FILE2.
           READ     FILE2 AT END GO TO TERMINAL-1.
           MOVE     R2 TO W-S3-KEYS.
           RELEASE  S2 FROM R2.
       TERMINAL-1.
           PERFORM  FAIL-1.
           MOVE     "TERMINAL-1" TO PAR-NAME.
           MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
           PERFORM  PRINT-DETAIL-1.
           MOVE     SPACE TO FEATURE.
           MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
           PERFORM  PRINT-DETAIL-1.
           MOVE     "LAST SUCCESSFUL TEST." TO RE-MARK.
           PERFORM  PRINT-DETAIL-1.
           GO       TO CLOSE-1.
       INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL-1.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
              PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
                ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       WRITE-LINE-1.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 50
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
      *>         MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN-1.
       WRT-LN-1.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT-1.
           PERFORM WRT-LN-1.
       FAIL-ROUTINE-1.
           IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
           IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
           MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
           GO TO FAIL-ROUTINE-EX-1.
       FAIL-RTN-WRITE-1.
           MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
       FAIL-ROUTINE-EX-1. EXIT.
       BAIL-OUT-1.
           IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
           IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
       BAIL-OUT-WRITE-1.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
       BAIL-OUT-EX-1. EXIT.
       EXIT-1.
           EXIT.
       SRT-3 SECTION.
       THIRD-SORT.
           SORT SORT3
               ON DESCENDING KEY S3-1 S3-2 S3-3
               ASCENDING S3-4
             INPUT PROCEDURE IS SRT3-INPUT
             OUTPUT PROCEDURE SRT3-OUTPUT-1 THRU SRT3-OUTPUT-2.
       NOTE-SORT-3.
      *>     NOTE SORT STATEMENT WITH INCLUSION-OMISSION OF OPTIONAL
      *>         WORDS AND THRU OPTION. THE OUTPUT OF SRT-2 IS TESTED
      *>         IN THE INPUT PROCEDURE OF THIS (THIRD) SORT.  THE OUTPUT
      *>         OF THE THIRD SORT IS TESTED IN THE OUTPUT PROCEDURE
      *>         WITHOUT THE GENERATION OF AN OUTPUT FILE.
       END-FIRST-PROGRAM.
           GO TO CCVS-EXIT.
       SRT3-INPUT SECTION.
       OPEN-2.
           OPEN     INPUT FILE3.
           MOVE     "SORT, INPUT PROC" TO FEATURE.
       SORT-TEST-5.
           PERFORM  READ-RELEASE-FILE3.
           MOVE     R3-KEYS TO W-S3-KEYS.
           IF       W-S2-KEYS EQUAL TO "567AZAZ"
                    PERFORM PASS-2 GO TO SORT-WRITE-5.
           GO       TO SORT-FAIL-5.
       SORT-DELETE-5.
           PERFORM  DE-LETE-2.
           GO       TO SORT-WRITE-5.
       SORT-FAIL-5.
           MOVE     W-S2-KEYS TO COMPUTED-A.
           MOVE     "567AZAZ" TO CORRECT-A.
           PERFORM  FAIL-2.
       SORT-WRITE-5.
           MOVE     "SORT-TEST-5 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-2.
       SORT-TEST-6.
           PERFORM  READ-RELEASE-FILE3 35 TIMES.
           MOVE     R3-KEYS TO W-S3-KEYS.
           IF       W-S2-KEYS EQUAL TO "567ARBR"
                    PERFORM PASS-2 GO TO SORT-WRITE-6.
           GO       TO SORT-FAIL-6.
       SORT-DELETE-6.
           PERFORM  DE-LETE-2.
           GO       TO SORT-WRITE-6.
       SORT-FAIL-6.
           MOVE     W-S2-KEYS TO COMPUTED-A.
           MOVE     "567ARBR" TO CORRECT-A.
           PERFORM  FAIL-2.
       SORT-WRITE-6.
           MOVE     "SORT-TEST-6 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-2.
       SORT-TEST-7.
           PERFORM  READ-RELEASE-FILE3 35 TIMES.
           MOVE     R3-KEYS TO W-S3-KEYS.
           IF       W-S2-KEYS EQUAL TO "567AHBH"
                    PERFORM PASS-2 GO TO SORT-WRITE-7.
           GO       TO SORT-FAIL-7.
       SORT-DELETE-7.
           PERFORM  DE-LETE-2.
           GO       TO SORT-WRITE-7.
       SORT-FAIL-7.
           MOVE     W-S2-KEYS TO COMPUTED-A.
           MOVE     "567AHBH" TO CORRECT-A.
           PERFORM  FAIL-2.
       SORT-WRITE-7.
           MOVE     "SORT-TEST-7 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-2.
       SORT-TEST-8.
           PERFORM  READ-RELEASE-FILE3 29 TIMES.
           MOVE     R3-KEYS TO W-S3-KEYS.
           IF       W-S2-KEYS EQUAL TO "567AABA"
                    PERFORM PASS-2 GO TO SORT-WRITE-8.
           GO       TO SORT-FAIL-8.
       SORT-DELETE-8.
           PERFORM  DE-LETE-2.
           GO       TO SORT-WRITE-8.
       SORT-FAIL-8.
           MOVE     W-S2-KEYS TO COMPUTED-A.
           MOVE     "567AABA" TO CORRECT-A.
           PERFORM  FAIL-2.
       SORT-WRITE-8.
           MOVE     "SORT-TEST-8 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-2.
       CLOSE-2.
           CLOSE    FILE3.
           GO       TO EXIT-2.
       READ-RELEASE-FILE3.
           READ     FILE3 AT END GO TO TERMINAL-2.
           RELEASE  S3.
      *>     NOTE    READ AND RELEASE ARE THE ONLY STATEMENTS NECESSARY
      *>     TO USE FILE3 AS INPUT TO THE THIRD SORT.  THIS IS SINCE
      *>     THE RECORD AREAS ARE THE SAME FROM THE CLAUSE
      *>             SAME RECORD AREA SORT3 FILE3.
       TERMINAL-2.
           PERFORM  FAIL-2.
           MOVE     "TERMINAL-2" TO PAR-NAME.
           MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
           PERFORM  PRINT-DETAIL-2.
           MOVE     SPACE TO FEATURE.
           MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
           PERFORM  PRINT-DETAIL-2.
           MOVE     "LAST SUCCESSFUL TEST" TO RE-MARK.
           PERFORM  PRINT-DETAIL-2.
           GO       TO CLOSE-2.
       INSPT-2. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS-2.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL-2.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE-2.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL-2.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-2.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-2
              PERFORM FAIL-ROUTINE-2 THRU FAIL-ROUTINE-EX-2
                ELSE PERFORM BAIL-OUT-2 THRU BAIL-OUT-EX-2.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       WRITE-LINE-2.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 50
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-2
      *>         MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-2 2 TIMES
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-2
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN-2.
       WRT-LN-2.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT-2.
           PERFORM WRT-LN-2.
       FAIL-ROUTINE-2.
           IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
           IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
           MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
           GO TO FAIL-ROUTINE-EX-2.
       FAIL-RTN-WRITE-2.
           MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-2
           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-2 2 TIMES.
       FAIL-ROUTINE-EX-2. EXIT.
       BAIL-OUT-2.
           IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-2.
           IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-2.
       BAIL-OUT-WRITE-2.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
       BAIL-OUT-EX-2. EXIT.
       EXIT-2.
           EXIT.
       SRT3-OUTPUT-1 SECTION.
       INIT-3.
           MOVE     "SORT, OUTPUT PROC" TO FEATURE.
       SORT-TEST-9.
           PERFORM  RETURN-SORT3.
           IF       S3-KEYS EQUAL TO "567AZBZ7001"
                    PERFORM PASS-3 GO TO SORT-WRITE-9.
           GO       TO SORT-FAIL-9.
       SORT-DELETE-9.
           PERFORM  DE-LETE-3.
           GO       TO SORT-WRITE-9.
       SORT-FAIL-9.
           MOVE     S3-KEYS TO COMPUTED-A.
           MOVE     "567AZBZ7001" TO CORRECT-A.
           PERFORM  FAIL-3.
       SORT-WRITE-9.
           MOVE     "SORT-TEST-9 " TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       SORT-TEST-10.
           PERFORM  RETURN-SORT3.
           IF       S3-KEYS EQUAL TO "567AZBZ7026"
                    PERFORM PASS-3 GO TO SORT-WRITE-10.
           GO       TO SORT-FAIL-10.
       SORT-DELETE-10.
           PERFORM  DE-LETE-3.
           GO       TO SORT-WRITE-10.
       SORT-FAIL-10.
           MOVE     S3-KEYS TO COMPUTED-A.
           MOVE     "567AZBZ7026" TO CORRECT-A.
           PERFORM  FAIL-3.
       SORT-WRITE-10.
           MOVE     "SORT-TEST-10" TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       SORT-TEST-11.
           PERFORM  RETURN-SORT3 35 TIMES.
           IF       S3-KEYS EQUAL TO "567AQBQ7010"
                    PERFORM PASS-3 GO TO SORT-WRITE-11.
           GO       TO SORT-FAIL-11.
       SORT-DELETE-11.
           PERFORM  DE-LETE-3.
           GO       TO SORT-WRITE-11.
       SORT-FAIL-11.
           MOVE     S3-KEYS TO COMPUTED-A.
           MOVE     "567AQBQ7010" TO CORRECT-A.
           PERFORM  FAIL-3.
       SORT-WRITE-11.
           MOVE     "SORT-TEST-11" TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       SORT-TEST-12.
           PERFORM  RETURN-SORT3.
           IF       S3-KEYS EQUAL TO "567AQBQ7035"
                    PERFORM PASS-3 GO TO SORT-WRITE-12.
           GO       TO SORT-FAIL-12.
       SORT-DELETE-12.
           PERFORM  DE-LETE-3.
           GO       TO SORT-WRITE-12.
       SORT-FAIL-12.
           MOVE     S3-KEYS TO COMPUTED-A.
           MOVE     "567AQBQ7035" TO CORRECT-A.
           PERFORM  FAIL-3.
       SORT-WRITE-12.
           MOVE     "SORT-TEST-12" TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       SORT-TEST-13.
           PERFORM  RETURN-SORT3 35 TIMES.
           IF       S3-KEYS EQUAL TO "567AGBG7019"
                    PERFORM PASS-3 GO TO SORT-WRITE-13.
           GO       TO SORT-FAIL-13.
       SORT-DELETE-13.
           PERFORM  DE-LETE-3.
           GO       TO SORT-WRITE-13.
       SORT-FAIL-13.
           MOVE     S3-KEYS TO COMPUTED-A.
           MOVE     "567AGBG7019" TO CORRECT-A.
           PERFORM  FAIL-3.
       SORT-WRITE-13.
           MOVE     "SORT-TEST-13" TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       SORT-TEST-14.
           PERFORM  RETURN-SORT3 27 TIMES.
           IF       S3-KEYS EQUAL TO "567AAAA7000"
                    PERFORM PASS-3 GO TO SORT-WRITE-14.
           GO       TO SORT-FAIL-14.
       SORT-DELETE-14.
           PERFORM  DE-LETE-3.
           GO       TO SORT-WRITE-14.
       SORT-FAIL-14.
           MOVE     S3-KEYS TO COMPUTED-A.
           MOVE     "567AAAA7000" TO CORRECT-A.
           PERFORM  FAIL-3.
       SORT-WRITE-14.
           MOVE     "SORT-TEST-14" TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       SORT-TEST-15.
           RETURN   SORT3 RECORD AT END
                    PERFORM PASS-3 GO TO SORT-WRITE-15.
      *>     NOTE     THE FOLLOWING SENTENCES SHOULD NOT BE EXECUTED.
           PERFORM FAIL-3.
           MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
           GO       TO SORT-WRITE-15.
       SORT-DELETE-15.
           PERFORM  DE-LETE-3.
       SORT-WRITE-15.
           MOVE     "SORT-TEST-15" TO PAR-NAME.
           PERFORM  PRINT-DETAIL-3.
       CLOSE-3.
           GO       TO EXIT-3.
       SRT3-OUTPUT-2 SECTION.
       RETURN-SORT3.
           RETURN   SORT3 RECORD AT END GO TO TERMINAL-3.
      *>     NOTE     RETURN VERB WITH ALL OPTIONS EXCEPT INTO.
       TERMINAL-3.
           PERFORM  FAIL-3.
           MOVE     "TERMINAL-3" TO PAR-NAME.
           MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
           PERFORM  PRINT-DETAIL-3.
           MOVE     SPACE TO FEATURE.
           MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
           PERFORM  PRINT-DETAIL-3.
           MOVE     "LAST SUCCESSFUL TEST." TO RE-MARK
           PERFORM  PRINT-DETAIL-3.
           GO       TO CLOSE-3.
       PASS-3.
           MOVE "PASS" TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL-3.
           ADD      1 TO ERROR-COUNTER.
           MOVE "FAIL*" TO P-OR-F.
       DE-LETE-3.
           MOVE     SPACE TO P-OR-F.
           MOVE     "    ************    " TO COMPUTED-A.
           MOVE     "    ************    " TO CORRECT-A.
           MOVE "****TEST DELETED****" TO RE-MARK.
           ADD 1 TO DELETE-COUNTER.
       PRINT-DETAIL-3.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE     SPACE TO P-OR-F.
           MOVE     SPACE TO COMPUTED-A.
           MOVE SPACE TO CORRECT-A.
           IF     REC-CT EQUAL TO ZERO
                    MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       EXIT-3.
           EXIT.
       END-CCVS SECTION.
       CCVS-EXIT SECTION.
       CCVS-999999.
           GO TO CLOSE-FILES.
      *> END-OF,ST131A