      *> HEADER,COBOL,CM201M
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           CM201M.
       AUTHOR.
      *>CE     FEDERAL COMPILER TESTING CENTER.
       INSTALLATION.
      *>CE     GENERAL SERVICES ADMINISTRATION
      *>CE      AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
      *>CE     SOFTWARE DEVELOPMENT OFFICE.
      *>CE     5203 LEESBURG PIKE  SUITE 1100
      *>CE     FALLS CHURCH VIRGINIA 22041.
      *>CE 
      *>CE     PHONE   (703) 756-6153
      *>CE 
      *>CE     " HIGH       ".
       DATE-WRITTEN.
      *>CE     CCVS-74 VERSION 4.0 - 1980 JULY 1.
      *>CE     CREATION DATE     /    VALIDATION DATE
      *>CE     "4.2 ".
       SECURITY.
      *>CE     NONE.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77  MSG-72 PIC X(72).
       01  RECOGNITION-MSG-1.
           02  FILLER PIC X(32) VALUE
               "RECEIPT OF MESSAGE FROM DEVICE """.
           02 DEVICE-NAME PIC X(12).
           02  FILLER PIC X(18) VALUE
               """ IS ACKNOWLEDGED.".
       01  RECOGNITION-MSG-2.
           02  FILLER PIC X(20) VALUE
               "QUEUE INVOLVED WAS """.
           02  QUEUE-INVOLVED PIC X(48).
           02  FILLER PIC XX VALUE """.".
       01  RECOGNITION-MSG-3 PIC X(41) VALUE
           "CM201M INVOKED BUT NO DATA WAS AVAILABLE.".
       COMMUNICATION SECTION.
       CD  CM-INQUE-1 FOR INITIAL INPUT.
       01  INQUE-1-RECORD.
           02  QUEUE-SET PIC X(48).
           02  FILLER PIC X(14).
           02  SYM-SOURCE PIC X(12).
           02  IN-LENGTH PIC 9(4).
           02  FILLER PIC XXX.
           02  MSG-COUNT PIC 9(6).
       CD  CM-OUTQUE-1 FOR OUTPUT.
       01  OUTQUE-1-RECORD.
           02  FILLER PIC 9999 VALUE 1.
           02  OUT-LENGTH PIC 9999.
           02  FILLER PIC XXX.
           02  SYM-DEST PIC X(12) VALUE
           XXXXX032.
       PROCEDURE    DIVISION.
       SECT-CM201M-0001 SECTION.
       CM201M-INIT.
           ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
           XXXXX033.
       TAKE-NEXT-MSG.
           RECEIVE CM-INQUE-1 MESSAGE INTO MSG-72
               NO DATA GO TO SOMETHING-IS-WRONG-HERE.
           MOVE QUEUE-SET TO QUEUE-INVOLVED.
           MOVE SYM-SOURCE TO DEVICE-NAME.
           MOVE 62 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-1 WITH EMI.
           MOVE 70 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-2 WITH EMI.
           MOVE IN-LENGTH TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM MSG-72 WITH EGI.
           ACCEPT CM-INQUE-1 MESSAGE COUNT.
           IF MSG-COUNT IS EQUAL TO 0 STOP RUN
               ELSE GO TO TAKE-NEXT-MSG.
       SOMETHING-IS-WRONG-HERE.
           MOVE 40 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-3 WITH EMI.
           MOVE QUEUE-SET TO QUEUE-INVOLVED.
           MOVE 70 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-2 WITH EGI.
           STOP RUN.
      *> END-OF,CM201M