      *> HEADER,COBOL,SQ124A
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           SQ124A.
      *> ***************************************************************
      *>                                                               *
      *>     VALIDATION FOR:-                                          *
      *>     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
      *>     USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
      *>                              REVISED 1986, AUGUST             *
      *>                                                               *
      *>     CREATION DATE     /     VALIDATION DATE                   *
      *>     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
      *>                                                               *
      *> ***************************************************************
      *>                                                               *
      *>       X-CARDS USED BY THIS PROGRAM ARE :-                     *
      *>                                                               *
      *>             X-14   SEQUENTIAL NON-UNIT MASS STORAGE FILE      *
      *>             X-55   SYSTEM PRINTER                             *
      *>             X-82   SOURCE-COMPUTER                            *
      *>             X-83   OBJECT-COMPUTER.                           *
      *>                                                               *
      *> ***************************************************************
      *>                                                               *
      *>     THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
      *>     TO A MEDIUM WHICH IS NOT A REEL/UNIT MEDIUM.  ONE RECORD  *
      *>     IS WRITTEN TO THE FILE AND A CLOSE UNIT STATEMENT IS      *
      *>     EXECUTED.  THIS SHOULD HAVE NO EFFECT ON THE FILE, EXCEPT *
      *>     TO CAUSE I-O STATUS 07.  THE FILE SHOULD REMAIN OPEN.  A  *
      *>     SECOND RECORD IS THEN WRITTEN AND A  NORMAL, UNQUALIFIED, *
      *>     CLOSE STATEMENT IS EXECUTED. THIS SHOULD BE SUCCESSFUL    *
      *>     AND CLOSE THE FILE.  THE FILE IS THEN REOPENED FOR INPUT  *
      *>     AND THE TWO RECORDS CHECKED.  A CLOSE UNIT STATEMENT IS   *
      *>     EXECUTED BEFORE THE FIRST RECORD IS READ, AND AGAIN THIS  *
      *>     SHOULD HAVE NO EFFECT ON SUBSEQUENT OPERATIONS ON THE     *
      *>     FILE.  AFTER THE TWO RECORDS HAVE BEEN READ, A FURTHER    *
      *>     READ STATEMENT IS EXECUTED TO RAISE THE AT END CONDITION, *
      *>     WHICH IS CHECKED, AND THE FILE IS CLOSED.                 *
      *>                                                               *
      *> ***************************************************************
      *> 
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
      *> 
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
      *> 
      *>     SELECT RAW-DATA   ASSIGN TO
      *>     XXXXX062
      *>           ORGANIZATION IS INDEXED
      *>           ACCESS MODE  IS RANDOM
      *>           RECORD-KEY   IS RAW-DATA-KEY.
      *> 
           SELECT SQ-FS4 ASSIGN
           XXXXX014
                  ORGANIZATION IS SEQUENTIAL
                  ACCESS SEQUENTIAL
                  FILE STATUS SQ-FS4-STATUS
                                IN STATUS-GROUP
                  .
      *> 
      *> 
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE
           LABEL RECORDS
           XXXXX084
           DATA RECORD IS PRINT-REC DUMMY-RECORD
                     .
       01  PRINT-REC    PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
      *> 
      *> FD  RAW-DATA.
      *> 01  RAW-DATA-SATZ.
      *>     05  RAW-DATA-KEY        PIC X(6).
      *>     05  C-DATE              PIC 9(6).
      *>     05  C-TIME              PIC 9(8).
      *>     05  NO-OF-TESTS         PIC 99.
      *>     05  C-OK                PIC 999.
      *>     05  C-ALL               PIC 999.
      *>     05  C-FAIL              PIC 999.
      *>     05  C-DELETED           PIC 999.
      *>     05  C-INSPECT           PIC 999.
      *>     05  C-NOTE              PIC X(13).
      *>     05  C-INDENT            PIC X.
      *>     05  C-ABORT             PIC X(8).
      *> 
       FD  SQ-FS4
           LABEL RECORD IS STANDARD
                      .
       01  SQ-FS4R1-F-G-120.
              05 SQ-FS4R1-RECORD-INFO-P1-120.
                 07 FILLER              PIC X(5).
                 07 FFILE-NAME          PIC X(6).
                 07 FILLER              PIC X(8).
                 07 FRECORD-NAME        PIC X(6).
                 07 FILLER              PIC X(1).
                 07 FREELUNIT-NUMBER    PIC 9(1).
                 07 FILLER              PIC X(7).
                 07 FRECORD-NUMBER      PIC 9(6).
                 07 FILLER              PIC X(6).
                 07 FUPDATE-NUMBER      PIC 9(2).
                 07 FILLER              PIC X(5).
                 07 FODO-NUMBER         PIC 9(4).
                 07 FILLER              PIC X(5).
                 07 FPROGRAM-NAME       PIC X(5).
                 07 FILLER              PIC X(7).
                 07 FRECORD-LENGTH      PIC 9(6).
                 07 FILLER              PIC X(7).
                 07 FCHARS-OR-RECORDS   PIC X(2).
                 07 FILLER              PIC X(1).
                 07 FBLOCK-SIZE         PIC 9(4).
                 07 FILLER              PIC X(6).
                 07 FRECORDS-IN-FILE    PIC 9(6).
                 07 FILLER              PIC X(5).
                 07 FFILE-ORGANIZATION  PIC X(2).
                 07 FILLER              PIC X(6).
                 07 FLABEL-TYPE         PIC X(1).
      *> 
       WORKING-STORAGE SECTION.
      *> 
      *> **************************************************************
      *>                                                              *
      *>     WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
      *>                                                              *
      *> **************************************************************
      *> 
       01  STATUS-GROUP.
           03  SQ-FS4-STATUS.
             05  SQ-FS4-KEY-1   PIC X.
             05  SQ-FS4-KEY-2   PIC X.
      *> 
       01  DELETE-SW.
           03  DELETE-SW-1 PIC X.
           03  DELETE-SW-1-GROUP.
               05  DELETE-SW-2 PIC X.
               05  DELETE-SW-2-GROUP.
                   07  DELETE-SW-3 PIC X.
      *> 
       01  AT-END-SW  PIC X(12).
       01  NOT-END-SW PIC X(12).
      *> 
      *> **************************************************************
      *>                                                              *
      *>     WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
      *>                                                              *
      *> **************************************************************
      *> 
       01  REC-SKEL-SUB   PIC 99.
      *> 
       01  FILE-RECORD-INFORMATION-REC.
           03 FILE-RECORD-INFO-SKELETON.
              05 FILLER                 PICTURE X(48)       VALUE
                   "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
              05 FILLER                 PICTURE X(46)       VALUE
                   ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
              05 FILLER                 PICTURE X(26)       VALUE
                   ",LFIL=000000,ORG=  ,LBLR= ".
              05 FILLER                 PICTURE X(37)       VALUE
                   ",RECKEY=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY1=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY2=                             ".
              05 FILLER                 PICTURE X(7)        VALUE SPACE.
           03 FILE-RECORD-INFO          OCCURS  10  TIMES.
              05 FILE-RECORD-INFO-P1-120.
                 07 FILLER              PIC X(5).
                 07 XFILE-NAME          PIC X(6).
                 07 FILLER              PIC X(8).
                 07 XRECORD-NAME        PIC X(6).
                 07 FILLER              PIC X(1).
                 07 REELUNIT-NUMBER     PIC 9(1).
                 07 FILLER              PIC X(7).
                 07 XRECORD-NUMBER      PIC 9(6).
                 07 FILLER              PIC X(6).
                 07 UPDATE-NUMBER       PIC 9(2).
                 07 FILLER              PIC X(5).
                 07 ODO-NUMBER          PIC 9(4).
                 07 FILLER              PIC X(5).
                 07 XPROGRAM-NAME       PIC X(5).
                 07 FILLER              PIC X(7).
                 07 XRECORD-LENGTH      PIC 9(6).
                 07 FILLER              PIC X(7).
                 07 CHARS-OR-RECORDS    PIC X(2).
                 07 FILLER              PIC X(1).
                 07 XBLOCK-SIZE         PIC 9(4).
                 07 FILLER              PIC X(6).
                 07 RECORDS-IN-FILE     PIC 9(6).
                 07 FILLER              PIC X(5).
                 07 XFILE-ORGANIZATION  PIC X(2).
                 07 FILLER              PIC X(6).
                 07 XLABEL-TYPE         PIC X(1).
              05 FILE-RECORD-INFO-P121-240.
                 07 FILLER              PIC X(8).
                 07 XRECORD-KEY         PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY1      PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY2      PIC X(29).
                 07 FILLER              PIC X(7).
      *> 
       01  TEST-RESULTS.
           02 FILLER              PIC X      VALUE SPACE.
           02  PAR-NAME.
             03 FILLER              PIC X(14)  VALUE SPACE.
             03 PARDOT-X            PIC X      VALUE SPACE.
             03 DOTVALUE            PIC 99     VALUE ZERO.
           02 FILLER              PIC X      VALUE SPACE.
           02 FEATURE             PIC X(24)  VALUE SPACE.
           02 FILLER              PIC X      VALUE SPACE.
           02 P-OR-F              PIC X(5)   VALUE SPACE.
           02 FILLER              PIC X(9)   VALUE SPACE.
           02 RE-MARK             PIC X(61).
       01  TEST-COMPUTED.
         02 FILLER  PIC X(30)  VALUE SPACE.
         02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
         02 COMPUTED-X.
           03 COMPUTED-A    PIC X(20)  VALUE SPACE.
           03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
           03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
           03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
           03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
           03       CM-18V0 REDEFINES COMPUTED-A.
              04 COMPUTED-18V0                   PIC -9(18).
              04 FILLER                          PIC X.
           03 FILLER PIC X(50) VALUE SPACE.
       01  TEST-CORRECT.
           02 FILLER PIC X(30) VALUE SPACE.
           02 FILLER PIC X(17) VALUE "       CORRECT =".
           02 CORRECT-X.
           03 CORRECT-A                  PIC X(20) VALUE SPACE.
           03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
           03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
           03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
           03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
           03      CR-18V0 REDEFINES CORRECT-A.
               04 CORRECT-18V0                     PIC -9(18).
               04 FILLER                           PIC X.
           03 FILLER PIC X(2) VALUE SPACE.
           03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
      *> 
       01  CCVS-C-1.
           02 FILLER  PIC IS X        VALUE  SPACE.
           02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
           02 FILLER  PIC IS X        VALUE  SPACE.
           02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
           02 FILLER  PIC IS X        VALUE  SPACE.
           02 FILLER  PIC IS X(5)     VALUE "PASS ".
           02 FILLER  PIC IS X(9)     VALUE  SPACE.
           02 FILLER  PIC IS X(62)    VALUE "REMARKS".
       01  CCVS-C-2.
           02 FILLER  PIC X(19)  VALUE  SPACE.
           02 FILLER  PIC X(6)   VALUE "TESTED".
           02 FILLER  PIC X(19)  VALUE  SPACE.
           02 FILLER  PIC X(4)   VALUE "FAIL".
           02 FILLER  PIC X(72)  VALUE  SPACE.
      *> 
       01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
       01  REC-CT            PIC 99       VALUE ZERO.
       01  DELETE-COUNTER    PIC 999      VALUE ZERO.
       01  ERROR-COUNTER     PIC 999      VALUE ZERO.
       01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
       01  PASS-COUNTER      PIC 999      VALUE ZERO.
       01  TOTAL-ERROR       PIC 999      VALUE ZERO.
       01  ERROR-HOLD        PIC 999      VALUE ZERO.
       01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
       01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
       01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
       01  CCVS-H-1.
           02  FILLER          PIC X(39)    VALUE SPACES.
           02  FILLER          PIC X(42)    VALUE
           "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
           02  FILLER          PIC X(39)    VALUE SPACES.
       01  CCVS-H-2A.
         02  FILLER            PIC X(40)  VALUE SPACE.
         02  FILLER            PIC X(7)   VALUE "CCVS85 ".
         02  FILLER            PIC XXXX   VALUE
           "4.2 ".
         02  FILLER            PIC X(28)  VALUE
                  " COPY - NOT FOR DISTRIBUTION".
         02  FILLER            PIC X(41)  VALUE SPACE.
      *> 
       01  CCVS-H-2B.
         02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
         02  TEST-ID           PIC X(9).
         02  FILLER            PIC X(4)   VALUE " IN ".
         02  FILLER            PIC X(12)  VALUE
           " HIGH       ".
         02  FILLER            PIC X(22)  VALUE
                  " LEVEL VALIDATION FOR ".
         02  FILLER            PIC X(58)  VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
       01  CCVS-H-3.
           02  FILLER          PIC X(34)  VALUE
                  " FOR OFFICIAL USE ONLY    ".
           02  FILLER          PIC X(58)  VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER          PIC X(28)  VALUE
                  "  COPYRIGHT   1985,1986 ".
       01  CCVS-E-1.
           02 FILLER           PIC X(52)  VALUE SPACE.
           02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN         PIC X(9).
           02 FILLER           PIC X(45)  VALUE SPACES.
       01  CCVS-E-2.
           02  FILLER          PIC X(31)  VALUE SPACE.
           02  FILLER          PIC X(21)  VALUE SPACE.
           02  CCVS-E-2-2.
               03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
               03 FILLER         PIC X      VALUE SPACE.
               03 ENDER-DESC     PIC X(44)  VALUE
                  "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER          PIC X(22)  VALUE
                  " FOR OFFICIAL USE ONLY".
           02  FILLER          PIC X(12)  VALUE SPACE.
           02  FILLER          PIC X(58)  VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER          PIC X(8)   VALUE SPACE.
           02  FILLER          PIC X(20)  VALUE
                   " COPYRIGHT 1985,1986".
       01  CCVS-E-4.
           02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
           02 FILLER           PIC X(4)   VALUE " OF ".
           02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
           02 FILLER           PIC X(40)  VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
           02 INFO-TEXT.
             04 FILLER             PIC X(8)   VALUE SPACE.
             04 XXCOMPUTED         PIC X(20).
             04 FILLER             PIC X(5)   VALUE SPACE.
             04 XXCORRECT          PIC X(20).
           02 INF-ANSI-REFERENCE PIC X(48).
       01  HYPHEN-LINE.
           02 FILLER  PIC IS X VALUE IS SPACE.
           02 FILLER  PIC IS X(65)    VALUE IS "*****************************************************************".
           02 FILLER  PIC IS X(54)    VALUE IS "******************************************************".
       01  CCVS-PGM-ID  PIC X(9)   VALUE
           "SQ124A".
      *> 
      *> 
       PROCEDURE DIVISION.
       CCVS1 SECTION.
       OPEN-FILES.
      *>     OPEN    I-O RAW-DATA.
      *>     MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
      *>     READ    RAW-DATA INVALID KEY GO TO END-E-1.
      *>     MOVE   "ABORTED "   TO C-ABORT.
      *>     ADD     1           TO C-NO-OF-TESTS.
      *>     ACCEPT  C-DATE      FROM DATE.
      *>     ACCEPT  C-TIME      FROM TIME.
      *>     REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
      *> END-E-1.
      *>     CLOSE   RAW-DATA.
           OPEN    OUTPUT PRINT-FILE.
           MOVE    CCVS-PGM-ID TO TEST-ID.
           MOVE    CCVS-PGM-ID TO ID-AGAIN.
           MOVE    SPACE TO TEST-RESULTS.
           PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
           MOVE    ZERO TO REC-SKEL-SUB.
           PERFORM CCVS-INIT-FILE 10 TIMES.
           GO TO CCVS1-EXIT.
      *> 
       CCVS-INIT-FILE.
           ADD     1 TO REC-SKL-SUB.
           MOVE    FILE-RECORD-INFO-SKELETON TO
                        FILE-RECORD-INFO (REC-SKL-SUB).
      *> 
       CLOSE-FILES.
           PERFORM END-ROUTINE THRU END-ROUTINE-13.
           CLOSE   PRINT-FILE.
      *>     OPEN    I-O RAW-DATA.
      *>     MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
      *>     READ    RAW-DATA INVALID KEY GO TO END-E-2.
      *>     MOVE   "OK.     " TO C-ABORT.
      *>     MOVE    PASS-COUNTER  TO C-OK.
      *>     MOVE    ERROR-HOLD    TO C-ALL.
      *>     MOVE    ERROR-COUNTER TO C-FAIL.
      *>     MOVE    DELETE-CNT    TO C-DELETED.
      *>     MOVE    INSPECT-COUNTER TO C-INSPECT.
      *>     REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
      *> END-E-2.
      *>     CLOSE   RAW-DATA.
       TERMINATE-CCVS.
      *>     EXIT    PROGRAM.
           STOP    RUN.
      *> 
       INSPT.
           MOVE   "INSPT" TO P-OR-F.
           ADD     1 TO INSPECT-COUNTER.
           PERFORM PRINT-DETAIL.
      *> 
       PASS.
           MOVE   "PASS " TO P-OR-F.
           ADD     1 TO PASS-COUNTER.
           PERFORM PRINT-DETAIL.
      *> 
       FAIL.
           MOVE   "FAIL*" TO P-OR-F.
           ADD     1 TO ERROR-COUNTER.
           PERFORM PRINT-DETAIL.
      *> 
       DE-LETE.
           MOVE   "****TEST DELETED****" TO RE-MARK.
           MOVE   "*****" TO P-OR-F.
           ADD     1 TO DELETE-COUNTER.
           PERFORM PRINT-DETAIL.
      *> 
       PRINT-DETAIL.
           IF REC-CT NOT EQUAL TO ZERO
               MOVE   "." TO PARDOT-X
               MOVE    REC-CT TO DOTVALUE.
           MOVE    TEST-RESULTS TO PRINT-REC.
           PERFORM WRITE-LINE.
           IF P-OR-F EQUAL TO "FAIL*"
               PERFORM WRITE-LINE
               PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
           ELSE
               PERFORM BAIL-OUT THRU BAIL-OUT-EX.
           MOVE    SPACE TO P-OR-F.
           MOVE    SPACE TO COMPUTED-X.
           MOVE    SPACE TO CORRECT-X.
           IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE    SPACE TO RE-MARK.
      *> 
       HEAD-ROUTINE.
           MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
           MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
       COLUMN-NAMES-ROUTINE.
           MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
       END-ROUTINE.
           MOVE    HYPHEN-LINE TO DUMMY-RECORD.
           PERFORM WRITE-LINE 5 TIMES.
       END-RTN-EXIT.
           MOVE    CCVS-E-1 TO DUMMY-RECORD.
           PERFORM WRITE-LINE 2 TIMES.
      *> 
       END-ROUTINE-1.
           ADD     ERROR-COUNTER   TO ERROR-HOLD
           ADD     INSPECT-COUNTER TO ERROR-HOLD.
           ADD     DELETE-COUNTER  TO ERROR-HOLD.
           ADD     PASS-COUNTER    TO ERROR-HOLD.
           MOVE    PASS-COUNTER    TO CCVS-E-4-1.
           MOVE    ERROR-HOLD      TO CCVS-E-4-2.
           MOVE    CCVS-E-4        TO CCVS-E-2-2.
           MOVE    CCVS-E-2        TO DUMMY-RECORD
           PERFORM WRITE-LINE.
           MOVE   "TEST(S) FAILED" TO ENDER-DESC.
           IF ERROR-COUNTER IS EQUAL TO ZERO
               MOVE   "NO " TO ERROR-TOTAL
           ELSE
               MOVE    ERROR-COUNTER TO ERROR-TOTAL.
           MOVE    CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-13.
           IF DELETE-COUNTER IS EQUAL TO ZERO
               MOVE   "NO " TO ERROR-TOTAL
           ELSE
               MOVE    DELETE-COUNTER TO ERROR-TOTAL.
           MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
           MOVE    CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           IF INSPECT-COUNTER EQUAL TO ZERO
               MOVE   "NO " TO ERROR-TOTAL
           ELSE
               MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
           MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
           MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
      *> 
       WRITE-LINE.
           ADD     1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 50
      *>         MOVE  DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE  SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
      *>         MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE  DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE  ZERO TO RECORD-COUNT.
           PERFORM WRT-LN.
      *> 
       WRT-LN.
           WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE    SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT.
           PERFORM WRT-LN.
       FAIL-ROUTINE.
           IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
           IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
           MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
           MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE    XXINFO TO DUMMY-RECORD.
           PERFORM WRITE-LINE 2 TIMES.
           MOVE    SPACES TO INF-ANSI-REFERENCE.
           GO TO   FAIL-ROUTINE-EX.
       FAIL-ROUTINE-WRITE.
           MOVE    TEST-COMPUTED  TO PRINT-REC
           PERFORM WRITE-LINE
           MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
           MOVE    TEST-CORRECT   TO PRINT-REC
           PERFORM WRITE-LINE 2 TIMES.
           MOVE    SPACES         TO COR-ANSI-REFERENCE.
       FAIL-ROUTINE-EX.
           EXIT.
       BAIL-OUT.
           IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
           IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
       BAIL-OUT-WRITE.
           MOVE    CORRECT-A      TO XXCORRECT.
           MOVE    COMPUTED-A     TO XXCOMPUTED.
           MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
           MOVE    XXINFO TO DUMMY-RECORD.
           PERFORM WRITE-LINE 2 TIMES.
           MOVE    SPACES TO INF-ANSI-REFERENCE.
       BAIL-OUT-EX.
           EXIT.
       CCVS1-EXIT.
           EXIT.
      *> 
      *> ***************************************************************
      *>                                                               *
      *>     THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
      *>     THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
      *>                                                               *
      *> ***************************************************************
      *> 
       SECT-SQ124A-0004 SECTION.
       STA-INIT.
           MOVE    SPACE TO DELETE-SW.
      *> 
           MOVE   "SQ-FS4" TO XFILE-NAME (1).
           MOVE   "R1-F-G" TO XRECORD-NAME (1).
           MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
           MOVE    125 TO XRECORD-LENGTH (1).
           MOVE   "RC" TO CHARS-OR-RECORDS (1).
           MOVE    1   TO XBLOCK-SIZE (1).
           MOVE    2   TO RECORDS-IN-FILE (1).
           MOVE   "SQ" TO XFILE-ORGANIZATION (1).
           MOVE   "S"  TO XLABEL-TYPE (1).
           MOVE    ZERO TO XRECORD-NUMBER (1).
      *> 
      *>     OPEN THE FILE IN THE OUTPUT MODE
      *>     DELETION OF THE OPEN OPERATION DELETES EVERY TEST
      *>     IN THE PROGRAM
      *> 
       SEQ-INIT-01.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "OPEN, CREATE FILE"  TO FEATURE.
           MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
           GO TO   SEQ-TEST-OP-01.
       SEQ-DELETE-01.
           MOVE   "*" TO DELETE-SW-1.
           GO TO   SEQ-DELETE-01-01.
       SEQ-TEST-OP-01.
           OPEN    OUTPUT SQ-FS4.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-01-01.
           GO TO   SEQ-TEST-OP-01-01.
       SEQ-DELETE-01-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-01-01-END.
       SEQ-TEST-OP-01-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
                         TO RE-MARK
               MOVE   "VII-3, VII-23" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-01-01-END.
      *> 
      *> 
      *>     THE FILE HAS BEEN CREATED.  WE NOW WRITE ONE RECORD
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-02.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           ADD     1 TO XRECORD-NUMBER (1).
           MOVE   "WRITE FIRST RECORD" TO FEATURE.
           MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-02.
           GO TO   SEQ-TEST-WR-02.
       SEQ-DELETE-02.
           MOVE   "*" TO DELETE-SW-2.
           GO TO   SEQ-DELETE-02-01.
       SEQ-TEST-WR-02.
           MOVE    FILE-RECORD-INFO (1) TO SQ-FS4R1-F-G-120.
           WRITE   SQ-FS4R1-F-G-120.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM WRITE
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-02-01.
           GO TO   SEQ-TEST-WR-02-01.
       SEQ-DELETE-02-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-02-01-END.
       SEQ-TEST-WR-02-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
               MOVE   "VII-3, VII-53,4.7.4(5)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-02-01-END.
           MOVE    SPACE TO DELETE-SW-2.
      *> 
      *> 
      *>     ONE RECORD HAS BEEN WRITTEN.  WE NOW EXECUTE CLOSE REEL
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-03.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "CLOSE UNIT, NON-UNIT" TO FEATURE.
           MOVE   "SEQ-TEST-CR-03" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-03.
           GO TO   SEQ-TEST-CR-03.
       SEQ-DELETE-03.
           MOVE   "*" TO DELETE-SW-2.
           GO TO   SEQ-DELETE-03-01.
       SEQ-TEST-CR-03.
           CLOSE   SQ-FS4 UNIT.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM CLOSE REEL
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-03-01.
           GO TO   SEQ-TEST-CR-03-01.
       SEQ-DELETE-03-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-03-01-END.
       SEQ-TEST-CR-03-01.
           IF SQ-FS4-STATUS = "07"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "07" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS FROM CLOSE REEL"
                         TO RE-MARK
               MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-03-01-END.
           MOVE    SPACE TO DELETE-SW-2.
      *> 
      *>     THE FILE SHOULD STILL BE OPEN. WE NOW WRITE ONE MORE RECORD
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-04.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           ADD     1 TO XRECORD-NUMBER (1).
           MOVE   "WRITE SECOND RECORD" TO FEATURE.
           MOVE   "SEQ-TEST-WR-04" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-04.
           GO TO   SEQ-TEST-WR-04.
       SEQ-DELETE-04.
           MOVE   "*" TO DELETE-SW-2.
           GO TO   SEQ-DELETE-04-01.
       SEQ-TEST-WR-04.
           MOVE    FILE-RECORD-INFO (1) TO SQ-FS4R1-F-G-120.
           WRITE   SQ-FS4R1-F-G-120.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM WRITE
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-04-01.
           GO TO   SEQ-TEST-WR-04-01.
       SEQ-DELETE-04-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-04-01-END.
       SEQ-TEST-WR-04-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
               MOVE   "VII-3, VII-53,4.7.4(5)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-04-01-END.
           MOVE    SPACE TO DELETE-SW-2.
      *> 
      *> 
      *>     NOW EXECUTE A NORMAL CLOSE ON THE FILE.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-05.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "CLOSE AFTER CLOSE REEL"  TO FEATURE.
           MOVE   "SEQ-TEST-CL-05" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-05.
           GO TO   SEQ-TEST-CL-05.
       SEQ-DELETE-05.
           MOVE   "*" TO DELETE-SW-2.
           GO TO   SEQ-DELETE-05-01.
       SEQ-TEST-CL-05.
           CLOSE   SQ-FS4.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM CLOSE
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-05-01.
           GO TO   SEQ-TEST-CL-05-01.
       SEQ-DELETE-05-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-05-01-END.
       SEQ-TEST-CL-05-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
                         TO RE-MARK
               MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-05-01-END.
           MOVE    SPACE TO DELETE-SW-2.
      *> 
      *> 
      *>     NOW OPEN THE FILE FOR INPUT.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     AND ALSO DELETES THE SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-06.
           MOVE    0 TO REC-CT.
           MOVE    ZERO TO XRECORD-NUMBER (1).
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "OPEN FILE FOR INPUT"  TO FEATURE.
           MOVE   "SEQ-TEST-OP-06" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-06.
           GO TO   SEQ-TEST-OP-06.
       SEQ-DELETE-06.
           MOVE   "*" TO DELETE-SW-2.
           GO TO   SEQ-DELETE-06-01.
       SEQ-TEST-OP-06.
           OPEN    INPUT SQ-FS4.
           MOVE    SPACE TO SQ-FS4R1-F-G-120.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM OPEN
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-06-01.
           GO TO   SEQ-TEST-OP-06-01.
       SEQ-DELETE-06-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-06-01-END.
       SEQ-TEST-OP-06-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED ERROR CODE FROM OPEN INPUT"
                         TO RE-MARK
               MOVE   "VII-3, VII-43,4.3.4(23)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-06-01-END.
      *> 
      *> 
      *>     WE NOW EXECUTE CLOSE REEL BEFORE ANY RECORD HAS BEEN READ.
      *>     APART FROM SETTING I-O STATUS 07 THIS SHOULD HAVE NO EFFECT
      *>     ON THE FILE OR THE SUBSEQUENT RETRIEVAL OF RECORDS.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-07.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "CLOSE UNIT, NON-UNIT" TO FEATURE.
           MOVE   "SEQ-TEST-CU-07" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-07.
           GO TO   SEQ-TEST-CU-07.
       SEQ-DELETE-07.
           MOVE   "*" TO DELETE-SW-3.
           GO TO   SEQ-DELETE-07-01.
       SEQ-TEST-CU-07.
           CLOSE   SQ-FS4 UNIT.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM CLOSE REEL
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-07-01.
           GO TO   SEQ-TEST-CU-07-01.
       SEQ-DELETE-07-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-07-01-END.
       SEQ-TEST-CU-07-01.
           IF SQ-FS4-STATUS = "07"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "07" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS FROM CLOSE UNIT"
                         TO RE-MARK
               MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-07-01-END.
           MOVE    SPACE TO DELETE-SW-3.
      *> 
      *>     THE FILE SHOULD STILL BE OPEN. WE NOW READ A RECORD.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-08.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "NOT EXECUTED" TO AT-END-SW.
           MOVE   "NOT EXECUTED" TO NOT-END-SW.
           ADD     1 TO XRECORD-NUMBER (1).
           MOVE   "READ FIRST RECORD" TO FEATURE.
           MOVE   "SEQ-TEST-RD-08" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-08.
           GO TO   SEQ-TEST-RD-08.
       SEQ-DELETE-08.
           MOVE   "*" TO DELETE-SW-3.
           GO TO   SEQ-DELETE-08-01.
       SEQ-TEST-RD-08.
           MOVE    SPACE TO SQ-FS4R1-F-G-120.
           READ    SQ-FS4
           AT END
               MOVE   "EXECUTED" TO AT-END-SW
           NOT END
               MOVE   "EXECUTED" TO NOT-END-SW.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM READ
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-08-01.
           GO TO   SEQ-TEST-RD-08-01.
       SEQ-DELETE-08-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-08-01-END.
       SEQ-TEST-RD-08-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS FROM READ" TO RE-MARK
               MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-08-01-END.
      *> 
      *>     CHECK EXECUTION OF THE AT END PATH
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-08-02.
           GO TO   SEQ-TEST-RD-08-02.
       SEQ-DELETE-08-02.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-08-02-END.
       SEQ-TEST-RD-08-02.
           IF AT-END-SW = "NOT EXECUTED"
               PERFORM PASS
           ELSE
               MOVE    AT-END-SW TO COMPUTED-A
               MOVE   "NOT EXECUTED" TO CORRECT-A
               MOVE   "UNEXPECTED EXECUTION OF AT END PATH" TO RE-MARK
               MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-08-02-END.
      *> 
      *>     CHECK EXECUTION OF THE NOT AT END PATH
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-08-03.
           GO TO   SEQ-TEST-RD-08-03.
       SEQ-DELETE-08-03.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-08-03-END.
       SEQ-TEST-RD-08-03.
           IF NOT-END-SW = "EXECUTED"
               PERFORM PASS
           ELSE
               MOVE    NOT-END-SW TO COMPUTED-A
               MOVE   "EXECUTED" TO CORRECT-A
               MOVE   "UNEXPECTED NON-EXECUTION OF AT END PATH"
                         TO RE-MARK
               MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-08-03-END.
      *> 
      *>     CHECK THE RECORD NUMBER OF THE RECORD JUST READ.
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-08-04.
           GO TO   SEQ-TEST-RD-08-04.
       SEQ-DELETE-08-04.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-08-04-END.
       SEQ-TEST-RD-08-04.
           IF FRECORD-NUMBER = XRECORD-NUMBER (1)
               PERFORM PASS
           ELSE
               MOVE    FRECORD-NUMBER TO COMPUTED-A
               MOVE    XRECORD-NUMBER (1) TO CORRECT-A
               MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
               PERFORM FAIL.
       SEQ-TEST-08-04-END.
           MOVE    SPACE TO DELETE-SW-3.
      *> 
      *> 
      *>     WE NOW READ THE SECOND AND FINAL RECORD.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-09.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "NOT EXECUTED" TO AT-END-SW.
           MOVE   "NOT EXECUTED" TO NOT-END-SW.
           ADD     1 TO XRECORD-NUMBER (1).
           MOVE   "READ SECOND RECORD" TO FEATURE.
           MOVE   "SEQ-TEST-RD-09" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-09.
           GO TO   SEQ-TEST-RD-09.
       SEQ-DELETE-09.
           MOVE   "*" TO DELETE-SW-3.
           GO TO   SEQ-DELETE-09-01.
       SEQ-TEST-RD-09.
           MOVE    SPACE TO SQ-FS4R1-F-G-120.
           READ    SQ-FS4
           END
                MOVE   "EXECUTED" TO AT-END-SW
           NOT AT END
                MOVE   "EXECUTED" TO NOT-END-SW.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM READ
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-09-01.
           GO TO   SEQ-TEST-RD-09-01.
       SEQ-DELETE-09-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-09-01-END.
       SEQ-TEST-RD-09-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS FROM READ" TO RE-MARK
               MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-09-01-END.
      *> 
      *>     CHECK EXECUTION OF THE AT END PATH
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-09-02.
           GO TO   SEQ-TEST-RD-09-02.
       SEQ-DELETE-09-02.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-09-02-END.
       SEQ-TEST-RD-09-02.
           IF AT-END-SW = "NOT EXECUTED"
               PERFORM PASS
           ELSE
               MOVE    AT-END-SW TO COMPUTED-A
               MOVE   "NOT EXECUTED" TO CORRECT-A
               MOVE   "UNEXPECTED EXECUTION OF AT END PATH" TO RE-MARK
               MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-09-02-END.
      *> 
      *>     CHECK EXECUTION OF THE NOT AT END PATH
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-09-03.
           GO TO   SEQ-TEST-RD-09-03.
       SEQ-DELETE-09-03.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-09-03-END.
       SEQ-TEST-RD-09-03.
           IF NOT-END-SW = "EXECUTED"
               PERFORM PASS
           ELSE
               MOVE    NOT-END-SW TO COMPUTED-A
               MOVE   "EXECUTED" TO CORRECT-A
               MOVE   "UNEXPECTED NON-EXECUTION OF AT END PATH"
                         TO RE-MARK
               MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-09-03-END.
      *> 
      *>     CHECK THE RECORD NUMBER OF THE RECORD JUST READ.
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-09-04.
           GO TO   SEQ-TEST-RD-09-04.
       SEQ-DELETE-09-04.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-09-04-END.
       SEQ-TEST-RD-09-04.
           IF FRECORD-NUMBER = XRECORD-NUMBER (1)
               PERFORM PASS
           ELSE
               MOVE    FRECORD-NUMBER TO COMPUTED-A
               MOVE    XRECORD-NUMBER (1) TO CORRECT-A
               MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
               PERFORM FAIL.
       SEQ-TEST-09-04-END.
           MOVE    SPACE TO DELETE-SW-3.
      *> 
      *> 
      *>     WE NOW ATTEMPT ANOTHER READ, WHICH SHOULD RAISE AT END.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
      *>     BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
      *> 
       SEQ-INIT-10.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "NOT EXECUTED" TO AT-END-SW.
           MOVE   "NOT EXECUTED" TO NOT-END-SW.
           ADD     1 TO XRECORD-NUMBER (1).
           MOVE   "READ TO GIVE AT END" TO FEATURE.
           MOVE   "SEQ-TEST-RD-10" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-10.
           GO TO   SEQ-TEST-RD-10.
       SEQ-DELETE-10.
           MOVE   "*" TO DELETE-SW-3.
           GO TO   SEQ-DELETE-10-01.
       SEQ-TEST-RD-10.
           MOVE    SPACE TO SQ-FS4R1-F-G-120.
           READ    SQ-FS4
           END
                MOVE   "EXECUTED" TO AT-END-SW
           NOT AT END
                MOVE   "EXECUTED" TO NOT-END-SW.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM READ
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-10-01.
           GO TO   SEQ-TEST-RD-10-01.
       SEQ-DELETE-10-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-10-01-END.
       SEQ-TEST-RD-10-01.
           IF SQ-FS4-STATUS = "10"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "10" TO CORRECT-A
               MOVE   "UNEXPECTED I-O STATUS AFTER LAST RECORD"
                          TO RE-MARK
               MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-10-01-END.
      *> 
      *>     CHECK EXECUTION OF THE AT END PATH
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-10-02.
           GO TO   SEQ-TEST-RD-10-02.
       SEQ-DELETE-10-02.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-10-02-END.
       SEQ-TEST-RD-10-02.
           IF AT-END-SW = "EXECUTED"
               PERFORM PASS
           ELSE
               MOVE    AT-END-SW TO COMPUTED-A
               MOVE   "EXECUTED" TO CORRECT-A
               MOVE   "UNEXPECTED NON-EXECUTION OF AT END PATH"
                          TO RE-MARK
               MOVE   "VII-46, 4.4.4(10)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-10-02-END.
      *> 
      *>     CHECK EXECUTION OF THE NOT AT END PATH
      *> 
           ADD     1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-10-03.
           GO TO   SEQ-TEST-RD-10-03.
       SEQ-DELETE-10-03.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-10-03-END.
       SEQ-TEST-RD-10-03.
           IF NOT-END-SW = "NOT EXECUTED"
               PERFORM PASS
           ELSE
               MOVE    NOT-END-SW TO COMPUTED-A
               MOVE   "NOT EXECUTED" TO CORRECT-A
               MOVE   "UNEXPECTED EXECUTION OF AT END PATH" TO RE-MARK
               MOVE   "VII-46, 4.4.4(10)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-10-03-END.
           MOVE    SPACE TO DELETE-SW-3.
      *> 
      *> 
      *>     NOW EXECUTE A NORMAL CLOSE ON THE FILE.
      *>     DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS.
      *> 
       SEQ-INIT-11.
           MOVE    0 TO REC-CT.
           MOVE   "**" TO SQ-FS4-STATUS.
           MOVE   "CLOSE AFTER READING" TO FEATURE.
           MOVE   "SEQ-TEST-CL-11" TO PAR-NAME.
           IF DELETE-SW NOT EQUAL TO SPACE
               GO TO SEQ-DELETE-11.
           GO TO   SEQ-TEST-CL-11.
       SEQ-DELETE-11.
           MOVE   "*" TO DELETE-SW-3.
           GO TO   SEQ-DELETE-11-01.
       SEQ-TEST-CL-11.
           CLOSE   SQ-FS4.
      *> 
      *>     CHECK I-O STATUS RETURNED FROM CLOSE
      *> 
           ADD    1 TO REC-CT.
           IF DELETE-SW NOT = SPACE
               GO TO   SEQ-DELETE-11-01.
           GO TO   SEQ-TEST-CL-11-01.
       SEQ-DELETE-11-01.
           PERFORM DE-LETE.
           GO TO   SEQ-TEST-11-01-END.
       SEQ-TEST-CL-11-01.
           IF SQ-FS4-STATUS = "00"
               PERFORM PASS
           ELSE
               MOVE    SQ-FS4-STATUS TO COMPUTED-A
               MOVE   "00" TO CORRECT-A
               MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
                         TO RE-MARK
               MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
               PERFORM FAIL.
       SEQ-TEST-11-01-END.
      *> 
       CCVS-EXIT SECTION.
       CCVS-999999.
           GO TO   CLOSE-FILES.
      *> END-OF,SQ124A