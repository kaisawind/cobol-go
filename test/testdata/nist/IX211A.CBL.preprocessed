      *> HEADER,COBOL,IX211A
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           IX211A.
      *> ***************************************************************
      *>                                                               *
      *>     VALIDATION FOR:-                                          *
      *>                                                               *
      *>     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
      *>                                                               *
      *>     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
      *>                                                               *
      *> ***************************************************************
      *>                                                               *
      *>       X-CARDS USED BY THIS PROGRAM ARE :-                     *
      *>                                                               *
      *>         X-55  - SYSTEM PRINTER NAME.                          *
      *>         X-82  - SOURCE COMPUTER NAME.                         *
      *>         X-83  - OBJECT COMPUTER NAME.                         *
      *>                                                               *
      *> ***************************************************************
      *>          "IX211A"
      *> *****************************************************************
      *> 
      *>     THIS PROGRAM TESTS THE CAPABILITY TO CHANGE (UPDATE) INDEX
      *>     KEYS OF RECORDS IN AN INDEXED I-O FILE AND THEN RETRIEVE THE
      *>     RECORDS FROM THE FILE IN THE PROPER SEQUENCE.  A RECORD
      *>     MODIFICATION FOR THE FILE WILL INVOLVE THE UPDATING
      *>     OF THE UPDATE-NUMBER FIELD, THE RECORD-KEY OR ALTERNATE-KEY, 
      *>     AND THE ODO-NUMBER FIELD OF THE RECORD.  EACH TIME A GIVEN
      *>     RECORD IS MODIFIED THE UPDATE-NUMBER FIELD WILL BE INCREMENT-
      *>     ED BY ONE.  TO KEEP TRACK OF THOSE RECORDS MODIFIED, 
      *>     THE ODO-NUMBER FIELD WILL ALWAYS CARRY THE SEQUENTIAL LOC-
      *>     ATION OF THE RECORD WITHIN THE FILE WHICH REFLECTS THE LAST
      *>     KEY VALUE POSITION BEFORE THE RECORD WAS MODIFIED.  THIS
      *>     LOCATION NUMBER WILL BE USED FOR VERIFYING THAT THE SEQUENTI-
      *>     AL REORDING OF THE RECORD FOR THE FILE WAS PROPER.  ONLY ONE
      *>     OF THE 3 KEYS OF THE RECORD WILLBE MODIFIED FOR ANY GIVEN
      *>     REWIRTE OF THE RECORD.
      *>     FURTHER A TEST IS MADE TO SEE IF THE POSITION INDICATOR
      *>     IS AFFECTED BY EXECUTION OF THE REWRITE STATEMENT.  IT SHOULD
      *>     NOT (PARAGRAPH 4.6.4 (7), PAGE IX-34).
      *> 
      *>             REFERENCE   AMERICAN NATIONAL STANDARD
      *>                         PROGRAMMING LANGUAGE COBOL, X3.23-1985.
      *>                         SECTION IX, INDEXED I-O, THE REWRITE
      *>                         STATEMENT, PARAGRAPHS 4.6.4 (7),(14), AND
      *>                                              (15 B)
      *> 
      *> 
      *>     THIS PROGRAM FIRST CREATES AN  INDEXED SEQUENTIAL FILE
      *>     CONTAINING TWO ALTERNATE KEYS AND  THE ONE REQUIRED RECORD
      *>     KEY FOR THE FILE.  IMMEDIATELY FOLLOWING FILE CREATION THE
      *>     FILE IS READ AND THE RECORDS OF THE FILE VERIFIED FOR
      *>     ACCURACY.
      *>     THE RECORDS IN THE FILE ARE CREATED IN SEQUENTIAL ORDER BY
      *>     RECORD KEY VALUE.  FOLLOWING  IS A SAMPLE OF THE DATA
      *>     CONTENTS FOR THE RECORD KEY AND TWO ALTERNATE RECORD KEYS IN
      *>     THE FILE.
      *> 
      *>    REC-NO  RECORD-KEY      ALTERNATE-KEY-1     ALTERNATE-KEY-2
      *>    ------  ----------      ---------------     ---------------
      *>     001   BBBBBBBBBC002 EEEEEEEEEF000ALTKEY1 WWWWWWWWWV398ALTKEY2
      *>     002   BBBBBBBBCC004 EEEEEEEEFF004ALTKEY1 WWWWWWWWVV396ALTKEY2
      *>     003   BBBBBBBCCC006 EEEEEEEFFF006ALTKEY1 WWWWWWWVVV394ALTKEY2
      *>      .          .                 .                    .
      *>      .          .                 .                    .
      *>      .          .                 .                    .
      *>     010   CCCCCCCCCC020 FFFFFFFFFF020ALTKEY1 VVVVVVVVVV380ALTKEY2
      *>     011   CCCCCCCCCD022 FFFFFFFFFG022ALTKEY1 VVVVVVVVVV380ALTKEY2
      *>     012   CCCCCCCCDD024 FFFFFFFFGG024ALTKEY1 VVVVVVVVUU376ALTKEY2
      *>      .          .                 .                    .
      *>      .          .                 .                    .
      *>      .          .                 .                    .
      *>     200   UUUUUUUUUU400 YYYYYYYYYY400ALTKEY1 DDDDDDDDDD000ALTKEY2
      *> 
      *>      NOTE 1 - ALTERNATE KEY NUMBER 2 CONTAINS DUPLICATE KEYS
      *>               EVERY 10TH AND 11TH RECORDS.
      *> 
      *>     NOTE 2 - THE FIRST 50 RECORDS AND LAST 25 RECORDS OF THE
      *>     FILE FOLLOW THE ABOVE SEQUENTIAL KEY PATTERN.  FOR THE MIDDLE
      *>     125 RECORDS ONLY THE NUMBER PART OF THE KEYS ARE VARIED
      *>     AND VARIED IN THE SEQUENCE SHOWN ABOVE.  THAT IS, RECORD-KEY
      *>     AND ALTERNATE-KEY-1 ARE INCREMENTED BY 2 AND THE ALTERNATE-
      *>     KEY-2 IS DECREMENTED BY 2 EACH TIME A RECORD IS WRITTEN TO
      *>     THE FILE.  THE FILE IS DESIGNED TO BE LARGE ENOUGH SO THAT
      *>     AN I-O OPERATION IS REQUIRED FOR EACH RECORD ACCESSED FROM
      *>     THE FILE.
      *> 
      *>     FILE CHARACTERISTICS ARE: FILE SIZE            = 200 RECORDS
      *>                               RECORD SIZE          = 240 CHARS.
      *>                               RECORD KEY SIZE      = 13  CHARS.
      *>                               ALTERNATE KEY 1 SIZE = 20  CHARS.
      *>                               ALTERNATE KEY 2 SIZE = 20  CHARS.
      *>                               ACCESS MODE          = DYNAMIC
      *> 
      *>     A LIST OF COBOL ELEMENTS WITH THE PARAGRAPH NAME IN PARENTH-
      *>     ESIS THAT TESTS THE ELEMENT AND A SHORT DESCRIPTION OF THE
      *>     TEST FOLLOWS.
      *> 
      *>       WRITE --- INVALID KEY --. (INX-TEST-001) - THIS TEST
      *>             CREATES A FILE OF 200 RECORDS CONTAINING A RECORD KEY
      *>             AND 2 ALTERNATE KEYS.
      *>       READ --- AT END ---. (INX-TEST-002) - THIS TEST READS THE
      *>             FILE CREATED IN INX-TEST-001 AND VERIFIES THAT THE
      *>             FILE WAS CREATED CORRECTLY.
      *>       START --- KEY IS EQUAL TO ALTERNAT-KEY1 ---.  AND
      *>       READ --- NEXT AT END ---. (INX-TEST-003.01) - THIS TEST
      *>             READS A RECORD AND ESTABLISHES THE ALTERNAT-KEY1 AS
      *>             THE KEY OF REFERENCE FOR THE FOLLOWING REWRITE TEST.
      *>       REWRITE --- INVALID KEY ---. (INX-TEST-003-02) - THIS TEST
      *>             MODIFIES THE ALTERNATE-KEY1 KEY OF THE RECORD AND
      *>             REWRITES THE RECORD
      *>       READ --- NEXT AT END ---. (INX-TEST-003.03) - ONE RECORD
      *>             IS READ SEQUENTIALLY FROM THE FILE.  THE REWRITE
      *>             IN PREVIOUS TEST SHOULD NOT HAVE AFFECTED THE RECORD
      *>             POINTER FOR THE FILE, THUS THE RECORD MADE AVAILABLE
      *>             SHOULD BE THE NEXT RECORD AS THOUGH THE ALTERNATE KEY
      *>             HAD NOT BEEN MODIFIED.
      *>       READ --- NEXT AT END ---. (INX-TEST-003.04) - THIS TEST
      *>             READS THE NEXT 4 RECORDS SEQUENTIALLY TO SEE IF
      *>             THE REWRITE OF THE RECORD CAUSED SEQUENTIAL
      *>             REORDING OF THE RECORDS.
      *> 
      *> *****************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *>     SELECT RAW-DATA   ASSIGN TO
      *>     XXXXX062
      *>            ORGANIZATION IS INDEXED
      *>            ACCESS MODE IS RANDOM
      *>            RECORD KEY IS RAW-DATA-KEY.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
           SELECT  IX-FD1
           ASSIGN TO
           XXXXX024
      *>     XXXXX044
              ACCESS MODE IS DYNAMIC
              ORGANIZATION IS INDEXED
              RECORD KEY IS IX-FD1-KEY
              ALTERNATE RECORD KEY IS IX-FD1-ALTKEY1
              ALTERNATE RECORD KEY IS IX-FD1-ALTKEY2 WITH DUPLICATES
              FILE STATUS IS FD1-STATUS.
       DATA DIVISION.
       FILE SECTION.
      *> 
      *> FD  RAW-DATA.
      *> 
      *> 01  RAW-DATA-SATZ.
      *>     05  RAW-DATA-KEY        PIC X(6).
      *>     05  C-DATE              PIC 9(6).
      *>     05  C-TIME              PIC 9(8).
      *>     05  C-NO-OF-TESTS       PIC 99.
      *>     05  C-OK                PIC 999.
      *>     05  C-ALL               PIC 999.
      *>     05  C-FAIL              PIC 999.
      *>     05  C-DELETED           PIC 999.
      *>     05  C-INSPECT           PIC 999.
      *>     05  C-NOTE              PIC X(13).
      *>     05  C-INDENT            PIC X.
      *>     05  C-ABORT             PIC X(8).
       FD  PRINT-FILE.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       FD  IX-FD1
           LABEL RECORDS ARE STANDARD
           DATA RECORD IS IX-FD1R1-F-G-240
           RECORD CONTAINS 240 CHARACTERS.
       01  IX-FD1R1-F-G-240.
           05 IX-FD1-REC-120           PICTURE X(120).
           05 IX-FD1-REC-121-240.
              10 FILLER                PICTURE X(8).
              10 IX-REC-KEY-AREA.
                 15 IX-FD1-KEY.
                    20 IX-FD1-KEY-1-10.
                       25 IX-FD1-KEY-1-5      PICTURE X(5).
                       25 IX-FD1-KEY-6-10     PICTURE X(5).
                     20 IX-FD1-KEY-11-13      PICTURE X(3).
                 15 FILLER             PICTURE X(16).
              10 FILLER                PICTURE X(9).
              10 IX-ALT-KEY1-AREA.
                 15 IX-FD1-ALTKEY1.
                    20 IX-FD1-ALTKEY1-1-10.
                       25 IX-FD1-ALTKEY1-1-5  PICTURE X(5).
                       25 IX-FD1-ALTKEY1-6-10 PICTURE X(5).
                    20 IX-FD1-ALTKEY1-11-13   PICTURE X(3).
                    20 IX-FD1-ALTKEY1-14-20   PICTURE X(7).
                 15 FILLER             PICTURE X(9).
              10 FILLER                PICTURE X(9).
              10 IX-ALT-KEY2-AREA.
                 15 IX-FD1-ALTKEY2.
                    20 IX-FD1-ALTKEY2-1-10.
                       25 IX-FD1-ALTKEY2-1-5  PICTURE X(5).
                       25 IX-FD1-ALTKEY2-6-10 PICTURE X(5).
                    20 IX-FD1-ALTKEY2-11-13   PICTURE X(3).
                    20 IX-FD1-ALTKEY2-14-20   PICTURE X(7).
                 15 FILLER             PICTURE X(9).
              10 FILLER                PICTURE X(7).
       WORKING-STORAGE SECTION.
       01  WRK-FD1-RECKEY.
           05 FD1-RECKEY-1-13.
              10 FD1-RECKEY-1-10       PICTURE X(10).
              10 FD1-RECKEY-11-13      PICTURE 9(3).
           05 FILLER                   PICTURE X(16)  VALUE SPACE.
       01  WRK-FD1-ALTKEY1.
            05 FD1-ALTKEY1-1-20.
             10  FD1-ALTKEY1-1-10.
              15 FD1-ALTKEY1-1-5       PICTURE X(5).
              15 FD1-ALTKEY1-6-10      PICTURE X(5).
             10 FD1-ALTKEY1-11-13      PICTURE 9(3).
             10 FD1-ALTKEY1-14-20      PICTURE X(7).
           05 FILLER                   PICTURE X(9)  VALUE SPACE.
       01  WRK-FD1-ALTKEY2.
           05 FD1-ALTKEY2-1-20.
              10 FD1-ALTKEY2-1-10.
                 15 FD1-ALTKEY2-1-5    PICTURE X(5).
                 15 FD1-ALTKEY2-6-10   PICTURE X(5).
              10 FD1-ALTKEY2-11-13     PICTURE 9(3).
              10 FD1-ALTKEY2-14-20     PICTURE X(7).
           05 FILLER                   PICTURE X(9) VALUE SPACE.
       01  RECNO                       PICTURE 9(5)  VALUE ZERO.
       01  ADJUSTED-NUM        PIC X(8) VALUE "NO".
       01  FD1-STATUS                  PICTURE XX   VALUE SPACE.
       01  EXCUT-COUNTER-06V00         PICTURE 9(6) VALUE ZERO.
       01  KEYSUB                      PICTURE 9(3) COMPUTATIONAL.
       01  INVKEY-COUNTER              PICTURE 9(3) COMPUTATIONAL.
       01  RECORDS-WRITTEN             PICTURE 9(3).
       01  RECKEY-NUM                  PICTURE 9(3).
       01  ALTKEY1-NUM                 PICTURE 9(3).
       01  ALTKEY2-NUM                 PICTURE 9(3).
       01  RECORD-KEY-CONTENT.
           05 FILLER PIC X(53) VALUE
                "BBBBBBBBBC002EEEEEEEEEF002ALTKEY1WWWWWWWWWV398ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBBBBBBBCC004EEEEEEEEFF004ALTKEY1WWWWWWWWVV396ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBBBBBBCCC006EEEEEEEFFF006ALTKEY1WWWWWWWVVV394ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBBBBBCCCC008EEEEEEFFFF008ALTKEY1WWWWWWVVVV392ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBBBBCCCCC010EEEEEFFFFF010ALTKEY1WWWWWVVVVV390ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBBBCCCCCC012EEEEFFFFFF012ALTKEY1WWWWVVVVVV388ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBBCCCCCCC014EEEFFFFFFF014ALTKEY1WWWVVVVVVV386ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BBCCCCCCCC016EEFFFFFFFF016ALTKEY1WWVVVVVVVV384ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "BCCCCCCCCC018EFFFFFFFFF018ALTKEY1WVVVVVVVVV382ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCCCCCCC020FFFFFFFFFF020ALTKEY1VVVVVVVVVV380ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCCCCCCD022FFFFFFFFFG022ALTKEY1VVVVVVVVVV380ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCCCCCDD024FFFFFFFFGG024ALTKEY1VVVVVVVVUU376ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCCCCDDD026FFFFFFFGGG026ALTKEY1VVVVVVVUUU374ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCCCDDDD028FFFFFFGGGG028ALTKEY1VVVVVVUUUU372ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCCDDDDD030FFFFFGGGGG030ALTKEY1VVVVVUUUUU370ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCCDDDDDD032FFFFGGGGGG032ALTKEY1VVVVUUUUUU368ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCCDDDDDDD034FFFGGGGGGG034ALTKEY1VVVUUUUUUU366ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CCDDDDDDDD036FFGGGGGGGG036ALTKEY1VVUUUUUUUU364ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "CDDDDDDDDD038FGGGGGGGGG038ALTKEY1VUUUUUUUUU362ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDDDDDDD040GGGGGGGGGG040ALTKEY1UUUUUUUUUU360ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDDDDDDE042GGGGGGGGGH042ALTKEY1UUUUUUUUUU360ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDDDDDEE044GGGGGGGGHH044ALTKEY1UUUUUUUUTT356ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDDDDEEE046GGGGGGGHHH046ALTKEY1UUUUUUUTTT354ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDDDEEEE048GGGGGGHHHH048ALTKEY1UUUUUUTTTT352ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDDEEEEE050GGGGGHHHHH050ALTKEY1UUUUUTTTTT350ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDDEEEEEE052GGGGHHHHHH052ALTKEY1UUUUTTTTTT348ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDDEEEEEEE054GGGHHHHHHH054ALTKEY1UUUTTTTTTT346ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DDEEEEEEEE056GGHHHHHHHH056ALTKEY1UUTTTTTTTT344ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "DEEEEEEEEE058GHHHHHHHHH058ALTKEY1UTTTTTTTTT342ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEEEEEEE060HHHHHHHHHH060ALTKEY1TTTTTTTTTT340ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEEEEEEF062HHHHHHHHHI062ALTKEY1TTTTTTTTTT340ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEEEEEFF064HHHHHHHHII064ALTKEY1TTTTTTTTSS336ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEEEEFFF066HHHHHHHIII066ALTKEY1TTTTTTTSSS334ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEEEFFFF068HHHHHHIIII068ALTKEY1TTTTTTSSSS332ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEEFFFFF070HHHHHIIIII070ALTKEY1TTTTTSSSSS330ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEEFFFFFF072HHHHIIIIII072ALTKEY1TTTTSSSSSS328ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEEFFFFFFF074HHHIIIIIII074ALTKEY1TTTSSSSSSS326ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EEFFFFFFFF076HHIIIIIIII076ALTKEY1TTSSSSSSSS324ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "EFFFFFFFFF078HIIIIIIIII078ALTKEY1TSSSSSSSSS322ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFFFFFFF080IIIIIIIIII080ALTKEY1SSSSSSSSSS320ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFFFFFFG082IIIIIIIIIJ082ALTKEY1SSSSSSSSSS320ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFFFFFGG084IIIIIIIIJJ084ALTKEY1SSSSSSSSRR316ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFFFFGGG086IIIIIIIJJJ086ALTKEY1SSSSSSSRRR314ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFFFGGGG088IIIIIIJJJJ088ALTKEY1SSSSSSRRRR312ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFFGGGGG090IIIIIJJJJJ090ALTKEY1SSSSSRRRRR310ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFFGGGGGG092IIIIJJJJJJ092ALTKEY1SSSSRRRRRR308ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFFGGGGGGG094IIIJJJJJJJ094ALTKEY1SSSRRRRRRR306ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FFGGGGGGGG096IIJJJJJJJJ096ALTKEY1SSRRRRRRRR304ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "FGGGGGGGGG098IJJJJJJJJJ098ALTKEY1SRRRRRRRRR302ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "GGGGGGGGGG100JJJJJJJJJJ100ALTKEY1RRRRRRRRRR300ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "RRRRSSSSSS352VVVVWWWWWW352ALTKEY1GGGGFFFFFF048ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "RRRSSSSSSS354VVVWWWWWWW354ALTKEY1GGGFFFFFFF046ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "RRSSSSSSSS356VVWWWWWWWW356ALTKEY1GGFFFFFFFF044ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "RSSSSSSSSS358VWWWWWWWWW358ALTKEY1GFFFFFFFFF042ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSSSSSSS360WWWWWWWWWW360ALTKEY1FFFFFFFFFF040ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSSSSSST362WWWWWWWWWX362ALTKEY1FFFFFFFFFF040ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSSSSSTT364WWWWWWWWXX364ALTKEY1FFFFFFFFEE036ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSSSSTTT366WWWWWWWXXX366ALTKEY1FFFFFFFEEE034ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSSSTTTT368WWWWWWXXXX368ALTKEY1FFFFFFEEEE032ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSSTTTTT370WWWWWXXXXX370ALTKEY1FFFFFEEEEE030ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSSTTTTTT372WWWWXXXXXX372ALTKEY1FFFFEEEEEE028ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSSTTTTTTT374WWWXXXXXXX374ALTKEY1FFFEEEEEEE026ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "SSTTTTTTTT376WWXXXXXXXX376ALTKEY1FFEEEEEEEE024ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "STTTTTTTTT378WXXXXXXXXX378ALTKEY1FEEEEEEEEE022ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTTTTTTT380XXXXXXXXXX380ALTKEY1EEEEEEEEEE020ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTTTTTTU382XXXXXXXXXY382ALTKEY1EEEEEEEEEE020ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTTTTTUU384XXXXXXXXYY384ALTKEY1EEEEEEEEDD016ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTTTTUUU386XXXXXXXYYY386ALTKEY1EEEEEEEDDD014ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTTTUUUU388XXXXXXYYYY388ALTKEY1EEEEEEDDDD012ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTTUUUUU390XXXXXYYYYY390ALTKEY1EEEEEDDDDD010ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTTUUUUUU392XXXXYYYYYY392ALTKEY1EEEEDDDDDD008ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTTUUUUUUU394XXXYYYYYYY394ALTKEY1EEEDDDDDDD006ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TTUUUUUUUU396XXYYYYYYYY396ALTKEY1EEDDDDDDDD004ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "TUUUUUUUUU398XYYYYYYYYY398ALTKEY1EDDDDDDDDD002ALTKEY2".
           05 FILLER PIC X(53) VALUE
                "UUUUUUUUUU400YYYYYYYYYY400ALTKEY1DDDDDDDDDD000ALTKEY2".
       01  RECORD-KEY-DATA   REDEFINES  RECORD-KEY-CONTENT.
           05 KEY-VALUES                  OCCURS 75  TIMES.
             10 RECKEY-VALUE           PICTURE X(13).
             10 ALTKEY1-VALUE          PICTURE X(20).
             10 ALTKEY2-VALUE          PICTURE X(20).
       01  INIT-FLAG                   PICTURE 9.
       01  HOLD-FILESTATUS-RECORD.
           05 FILESTATUS               PICTURE XX  OCCURS 10 TIMES.
       01  FILE-RECORD-INFORMATION-REC.
           03 FILE-RECORD-INFO-SKELETON.
              05 FILLER                 PICTURE X(48)       VALUE
                   "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
              05 FILLER                 PICTURE X(46)       VALUE
                   ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
              05 FILLER                 PICTURE X(26)       VALUE
                   ",LFIL=000000,ORG=  ,LBLR= ".
              05 FILLER                 PICTURE X(37)       VALUE
                   ",RECKEY=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY1=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY2=                             ".
              05 FILLER                 PICTURE X(7)        VALUE SPACE.
           03 FILE-RECORD-INFO          OCCURS  10  TIMES.
              05 FILE-RECORD-INFO-P1-120.
                 07 FILLER              PIC X(5).
                 07 XFILE-NAME           PIC X(6).
                 07 FILLER              PIC X(8).
                 07 XRECORD-NAME         PIC X(6).
                 07 FILLER              PIC X(1).
                 07 REELUNIT-NUMBER     PIC 9(1).
                 07 FILLER              PIC X(7).
                 07 XRECORD-NUMBER       PIC 9(6).
                 07 FILLER              PIC X(6).
                 07 UPDATE-NUMBER       PIC 9(2).
                 07 FILLER              PIC X(5).
                 07 ODO-NUMBER          PIC 9(4).
                 07 FILLER              PIC X(5).
                 07 XPROGRAM-NAME        PIC X(5).
                 07 FILLER              PIC X(7).
                 07 XRECORD-LENGTH       PIC 9(6).
                 07 FILLER              PIC X(7).
                 07 CHARS-OR-RECORDS    PIC X(2).
                 07 FILLER              PIC X(1).
                 07 XBLOCK-SIZE          PIC 9(4).
                 07 FILLER              PIC X(6).
                 07 RECORDS-IN-FILE     PIC 9(6).
                 07 FILLER              PIC X(5).
                 07 XFILE-ORGANIZATION   PIC X(2).
                 07 FILLER              PIC X(6).
                 07 XLABEL-TYPE          PIC X(1).
              05 FILE-RECORD-INFO-P121-240.
                 07 FILLER              PIC X(8).
                 07 XRECORD-KEY          PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY1      PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY2      PIC X(29).
                 07 FILLER              PIC X(7).
       01  TEST-RESULTS.
           02 FILLER                   PIC X      VALUE SPACE.
           02 FEATURE                  PIC X(20)  VALUE SPACE.
           02 FILLER                   PIC X      VALUE SPACE.
           02 P-OR-F                   PIC X(5)   VALUE SPACE.
           02 FILLER                   PIC X      VALUE SPACE.
           02  PAR-NAME.
             03 FILLER                 PIC X(19)  VALUE SPACE.
             03  PARDOT-X              PIC X      VALUE SPACE.
             03 DOTVALUE               PIC 99     VALUE ZERO.
           02 FILLER                   PIC X(8)   VALUE SPACE.
           02 RE-MARK                  PIC X(61).
       01  TEST-COMPUTED.
           02 FILLER                   PIC X(30)  VALUE SPACE.
           02 FILLER                   PIC X(17)  VALUE
                  "       COMPUTED=".
           02 COMPUTED-X.
           03 COMPUTED-A               PIC X(20)  VALUE SPACE.
           03 COMPUTED-N               REDEFINES COMPUTED-A
                                       PIC -9(9).9(9).
           03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
           03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
           03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
           03       CM-18V0 REDEFINES COMPUTED-A.
               04 COMPUTED-18V0                    PIC -9(18).
               04 FILLER                           PIC X.
           03 FILLER PIC X(50) VALUE SPACE.
       01  TEST-CORRECT.
           02 FILLER PIC X(30) VALUE SPACE.
           02 FILLER PIC X(17) VALUE "       CORRECT =".
           02 CORRECT-X.
           03 CORRECT-A                  PIC X(20) VALUE SPACE.
           03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
           03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
           03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
           03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
           03      CR-18V0 REDEFINES CORRECT-A.
               04 CORRECT-18V0                     PIC -9(18).
               04 FILLER                           PIC X.
           03 FILLER PIC X(2) VALUE SPACE.
           03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
       01  CCVS-C-1.
           02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PASS  PARAGRAPH-NAME                                                 REMARKS".
           02 FILLER                     PIC X(20)    VALUE SPACE.
       01  CCVS-C-2.
           02 FILLER                     PIC X        VALUE SPACE.
           02 FILLER                     PIC X(6)     VALUE "TESTED".
           02 FILLER                     PIC X(15)    VALUE SPACE.
           02 FILLER                     PIC X(4)     VALUE "FAIL".
           02 FILLER                     PIC X(94)    VALUE SPACE.
       01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
       01  REC-CT                        PIC 99       VALUE ZERO.
       01  DELETE-COUNTER                PIC 999      VALUE ZERO.
       01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
       01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
       01  PASS-COUNTER                  PIC 999      VALUE ZERO.
       01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
       01  ERROR-HOLD                    PIC 999      VALUE ZERO.
       01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
       01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
       01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
       01  CCVS-H-1.
           02  FILLER                    PIC X(39)    VALUE SPACES.
           02  FILLER                    PIC X(42)    VALUE
           "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
           02  FILLER                    PIC X(39)    VALUE SPACES.
       01  CCVS-H-2A.
         02  FILLER                        PIC X(40)  VALUE SPACE.
         02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
         02  FILLER                        PIC XXXX   VALUE
           "4.2 ".
         02  FILLER                        PIC X(28)  VALUE
                  " COPY - NOT FOR DISTRIBUTION".
         02  FILLER                        PIC X(41)  VALUE SPACE.
       
       01  CCVS-H-2B.
         02  FILLER                        PIC X(15)  VALUE
                  "TEST RESULT OF ".
         02  TEST-ID                       PIC X(9).
         02  FILLER                        PIC X(4)   VALUE
                  " IN ".
         02  FILLER                        PIC X(12)  VALUE
           " HIGH       ".
         02  FILLER                        PIC X(22)  VALUE
                  " LEVEL VALIDATION FOR ".
         02  FILLER                        PIC X(58)  VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
       01  CCVS-H-3.
           02  FILLER                      PIC X(34)  VALUE
                  " FOR OFFICIAL USE ONLY    ".
           02  FILLER                      PIC X(58)  VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER                      PIC X(28)  VALUE
                  "  COPYRIGHT   1985 ".
       01  CCVS-E-1.
           02 FILLER                       PIC X(52)  VALUE SPACE.
           02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN                     PIC X(9).
           02 FILLER                       PIC X(45)  VALUE SPACES.
       01  CCVS-E-2.
           02  FILLER                      PIC X(31)  VALUE SPACE.
           02  FILLER                      PIC X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
               03 FILLER                   PIC X      VALUE SPACE.
               03 ENDER-DESC               PIC X(44)  VALUE
                  "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER                      PIC X(22)  VALUE
                  " FOR OFFICIAL USE ONLY".
           02  FILLER                      PIC X(12)  VALUE SPACE.
           02  FILLER                      PIC X(58)  VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER                      PIC X(13)  VALUE SPACE.
           02 FILLER                       PIC X(15)  VALUE
                   " COPYRIGHT 1985".
       01  CCVS-E-4.
           02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
           02 FILLER                       PIC X(4)   VALUE " OF ".
           02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
           02 FILLER                       PIC X(40)  VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER                       PIC X(19)  VALUE
                  "*** INFORMATION ***".
           02 INFO-TEXT.
             04 FILLER                     PIC X(8)   VALUE SPACE.
             04 XXCOMPUTED                 PIC X(20).
             04 FILLER                     PIC X(5)   VALUE SPACE.
             04 XXCORRECT                  PIC X(20).
           02 INF-ANSI-REFERENCE           PIC X(48).
       01  HYPHEN-LINE.
           02 FILLER  PIC IS X VALUE IS SPACE.
           02 FILLER  PIC IS X(65)    VALUE IS "*****************************************************************".
           02 FILLER  PIC IS X(54)    VALUE IS "******************************************************".
       01  CCVS-PGM-ID                     PIC X(9)   VALUE
           "IX211A".
       PROCEDURE DIVISION.
       CCVS1 SECTION.
       OPEN-FILES.
      *>     OPEN I-O RAW-DATA.
      *>     MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
      *>     READ RAW-DATA INVALID KEY GO TO END-E-1.
      *>     MOVE "ABORTED " TO C-ABORT.
      *>     ADD 1 TO C-NO-OF-TESTS.
      *>     ACCEPT C-DATE  FROM DATE.
      *>     ACCEPT C-TIME  FROM TIME.
      *>     REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
      *> END-E-1.
      *>     CLOSE RAW-DATA.
           OPEN    OUTPUT PRINT-FILE.
           MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
           MOVE    SPACE TO TEST-RESULTS.
           PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
           MOVE    ZERO TO REC-SKL-SUB.
           PERFORM CCVS-INIT-FILE 9 TIMES.
       CCVS-INIT-FILE.
           ADD     1 TO REC-SKL-SUB.
           MOVE    FILE-RECORD-INFO-SKELETON
                TO FILE-RECORD-INFO (REC-SKL-SUB).
       CCVS-INIT-EXIT.
           GO TO CCVS1-EXIT.
       CLOSE-FILES.
      *>     OPEN I-O RAW-DATA.
      *>     MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
      *>     READ RAW-DATA INVALID KEY GO TO END-E-2.
      *>     MOVE "OK.     " TO C-ABORT.
      *>     MOVE PASS-COUNTER TO C-OK.
      *>     MOVE ERROR-HOLD   TO C-ALL.
      *>     MOVE ERROR-COUNTER TO C-FAIL.
      *>     MOVE DELETE-COUNTER TO C-DELETED.
      *>     MOVE INSPECT-COUNTER TO C-INSPECT.
      *>     REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
      *> END-E-2.
      *>     CLOSE RAW-DATA.
           PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
       TERMINATE-CCVS.
      *>     EXIT PROGRAM.
      *> TERMINATE-CALL.
           STOP     RUN.
       INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
              PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
                ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       HEAD-ROUTINE.
           MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
           MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
       COLUMN-NAMES-ROUTINE.
           MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
       END-ROUTINE.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
       END-RTN-EXIT.
           MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
       END-ROUTINE-1.
            ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
            ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
            ADD PASS-COUNTER TO ERROR-HOLD.
      *>      IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
            MOVE PASS-COUNTER TO CCVS-E-4-1.
            MOVE ERROR-HOLD TO CCVS-E-4-2.
            MOVE CCVS-E-4 TO CCVS-E-2-2.
            MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
        END-ROUTINE-12.
            MOVE "TEST(S) FAILED" TO ENDER-DESC.
           IF       ERROR-COUNTER IS EQUAL TO ZERO
               MOVE "NO " TO ERROR-TOTAL
               ELSE
               MOVE ERROR-COUNTER TO ERROR-TOTAL.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-13.
           IF DELETE-COUNTER IS EQUAL TO ZERO
               MOVE "NO " TO ERROR-TOTAL  ELSE
               MOVE DELETE-COUNTER TO ERROR-TOTAL.
           MOVE "TEST(S) DELETED     " TO ENDER-DESC.
           MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
            IF   INSPECT-COUNTER EQUAL TO ZERO
                MOVE "NO " TO ERROR-TOTAL
            ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
            MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
            MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
       WRITE-LINE.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 42
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
      *>         MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
      *>         MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
      *>         MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
      *>         MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN.
       WRT-LN.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT.
           PERFORM WRT-LN.
       FAIL-ROUTINE.
           IF     COMPUTED-X NOT EQUAL TO SPACE
                  GO TO   FAIL-ROUTINE-WRITE.
           IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
           MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
           MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE   SPACES TO INF-ANSI-REFERENCE.
           GO TO  FAIL-ROUTINE-EX.
       FAIL-ROUTINE-WRITE.
           MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
           MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
           MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
           MOVE   SPACES TO COR-ANSI-REFERENCE.
       FAIL-ROUTINE-EX. EXIT.
       BAIL-OUT.
           IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
           IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
       BAIL-OUT-WRITE.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
           MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE   SPACES TO INF-ANSI-REFERENCE.
       BAIL-OUT-EX. EXIT.
       CCVS1-EXIT.
           EXIT.
       SECT-0001-IX211A SECTION.
       WRITE-INT-GF-01.
           OPEN    OUTPUT IX-FD1.
           MOVE    "IX-FD1" TO XFILE-NAME           (1).
           MOVE    "R1-F-G" TO  XRECORD-NAME        (1).
           MOVE    ZERO     TO  XRECORD-NUMBER      (1).
           MOVE    "RC"     TO  CHARS-OR-RECORDS    (1).
           MOVE    CCVS-PGM-ID TO  XPROGRAM-NAME       (1).
           MOVE    240      TO  XRECORD-LENGTH      (1).
           MOVE    001      TO  XBLOCK-SIZE         (1).
           MOVE    "IX"     TO  XFILE-ORGANIZATION  (1).
           MOVE    "S"      TO  XLABEL-TYPE         (1).
           MOVE    200      TO  RECORDS-IN-FILE     (1).
           MOVE    "CREATE-FILE-FD1" TO FEATURE.
           MOVE    "WRITE-TEST-GF-01" TO PAR-NAME.
           MOVE    ZERO TO KEYSUB.
           MOVE    ZERO TO INVKEY-COUNTER.
       WRITE-INIT-GF-01-01.
           PERFORM WRITE-TEST-GF-01-1  50 TIMES.
           PERFORM WRITE-TEST-GF-01-2  125 TIMES.
           PERFORM WRITE-TEST-GF-01-1  25 TIMES.
           GO TO   WRITE-TEST-GF-01.
       WRITE-TEST-GF-01-1.
           ADD     001  TO XRECORD-NUMBER (1).
           ADD     001  TO  KEYSUB.
           MOVE    RECKEY-VALUE (KEYSUB) TO FD1-RECKEY-1-13.
           MOVE    ALTKEY1-VALUE (KEYSUB) TO FD1-ALTKEY1-1-20.
           MOVE    ALTKEY2-VALUE (KEYSUB) TO FD1-ALTKEY2-1-20.
           MOVE    WRK-FD1-RECKEY   TO    XRECORD-KEY (1).
           MOVE    WRK-FD1-ALTKEY1  TO ALTERNATE-KEY1 (1).
           MOVE    WRK-FD1-ALTKEY2  TO ALTERNATE-KEY2 (1).
           MOVE    FILE-RECORD-INFO (1)  TO IX-FD1R1-F-G-240.
           WRITE   IX-FD1R1-F-G-240
                              INVALID KEY ADD 001 TO INVKEY-COUNTER.
           ADD     001 TO  EXCUT-COUNTER-06V00.
       WRITE-TEST-GF-01-2.
           ADD     002  TO FD1-RECKEY-11-13.
           ADD     002 TO FD1-ALTKEY1-11-13.
           SUBTRACT  002 FROM FD1-ALTKEY2-11-13.
           ADD     001  TO XRECORD-NUMBER (1).
           MOVE    WRK-FD1-RECKEY   TO    XRECORD-KEY (1).
           MOVE    WRK-FD1-ALTKEY1  TO ALTERNATE-KEY1 (1).
           MOVE    WRK-FD1-ALTKEY2  TO ALTERNATE-KEY2 (1).
           MOVE    FILE-RECORD-INFO (1) TO IX-FD1R1-F-G-240.
           WRITE   IX-FD1R1-F-G-240
                              INVALID KEY ADD 001 TO INVKEY-COUNTER.
           ADD     001 TO EXCUT-COUNTER-06V00.
       WRITE-TEST-GF-01.
           SUBTRACT INVKEY-COUNTER FROM EXCUT-COUNTER-06V00
                   GIVING RECORDS-WRITTEN.
           MOVE    200  TO CORRECT-18V0.
           MOVE    RECORDS-WRITTEN TO COMPUTED-18V0.
           IF      RECORDS-WRITTEN EQUAL TO 200
                   PERFORM  PASS
                   ELSE
                   PERFORM FAIL.
           MOVE    "RECORDS IN FILE" TO RE-MARK.
           GO TO   WRITE-TEST-GF-01-END.
       WRITE-DELETE-GF-01.
           PERFORM DE-LETE.
       WRITE-TEST-GF-01-END.
           PERFORM  PRINT-DETAIL.
           CLOSE   IX-FD1.
       READ-INIT-F1-01.
           OPEN    INPUT  IX-FD1.
           MOVE    "READ-TEST-F1-01" TO PAR-NAME.
           MOVE    "READ FILE IX-FD1" TO FEATURE.
           MOVE    ZERO TO EXCUT-COUNTER-06V00.
           MOVE    02   TO RECKEY-NUM.
           MOVE    002 TO ALTKEY1-NUM.
       READ-TEST-F1-01-1.
           READ     IX-FD1 NEXT
                   AT END GO TO READ-TEST-F1-01.
           MOVE    IX-REC-KEY-AREA TO WRK-FD1-RECKEY.
           MOVE    IX-ALT-KEY1-AREA TO WRK-FD1-ALTKEY1.
           IF      FD1-RECKEY-11-13 EQUAL TO RECKEY-NUM
                   AND FD1-ALTKEY1-11-13 EQUAL TO ALTKEY1-NUM
                   NEXT SENTENCE
                   ELSE
                   PERFORM  READ-FAIL-F1-01.
           IF      EXCUT-COUNTER-06V00 GREATER THAN 200
                   GO TO READ-TEST-F1-01.
           ADD     001  TO EXCUT-COUNTER-06V00.
           ADD     002  TO RECKEY-NUM
           ADD     002  TO ALTKEY1-NUM.
           GO TO   READ-TEST-F1-01-1.
       READ-TEST-F1-01.
           IF      EXCUT-COUNTER-06V00 EQUAL TO 200
                   PERFORM PASS ELSE
                   PERFORM FAIL.
           MOVE    EXCUT-COUNTER-06V00 TO  COMPUTED-18V0.
           MOVE    200  TO  CORRECT-18V0.
           MOVE    "RECORDS IN FILE" TO RE-MARK.
           GO TO   READ-EXIT-F1-01.
       READ-FAIL-F1-01.
           PERFORM FAIL.
           MOVE    FD1-RECKEY-11-13  TO COMPUTED-18V0.
           MOVE    RECKEY-NUM  TO CORRECT-18V0.
           MOVE "NUM EMBEDDED IN RECKEY; IX-28 READ; IX-41 WRITE"
                    TO RE-MARK.
       READ-EXIT-F1-01.
           PERFORM PRINT-DETAIL.
           CLOSE   IX-FD1.
       READ-INIT-F1-02.
           OPEN I-O  IX-FD1.
           MOVE "START & READ NEXT   " TO FEATURE.
           MOVE "READ-TEST-F1-02     " TO PAR-NAME.
           MOVE    "SSSSSSSSTT364"  TO FD1-RECKEY-1-13.
           MOVE    "WWWWWWWWXX364ALTKEY1"  TO FD1-ALTKEY1-1-20.
           MOVE    "FFFFFFFFEE036ALTKEY2"  TO FD1-ALTKEY2-1-20.
           MOVE    WRK-FD1-RECKEY TO IX-REC-KEY-AREA.
           MOVE    WRK-FD1-ALTKEY1 TO IX-ALT-KEY1-AREA.
           MOVE    WRK-FD1-ALTKEY2 TO IX-ALT-KEY2-AREA.
       READ-TEST-F1-02.
      *> 
      *>   READ-TEST-F1-02 - THIS TEST READS A RECORD AND CHECKS THE
      *>                     RECORD MADE AVAILABLE.  THE PURPOSE IS TO
      *>                     ESTABLISH IX-FD1-ALTKEY1 AS THE KEY OF REF-
      *>                     ERENCE AND TO MAKE A RECORD AVAILABLE
      *>                     FOR TESTING THE REWRITE STATEMENT IN THE
      *>                     NEXT TEST.         RECORD 182 (ALTERNATE KEY
      *>                     "WWWWWWWWXX364ALTKEY1") IS EXPECTED TO BE
      *>                     RETRIEVED.
      *> 
           START   IX-FD1
                          KEY IS EQUAL TO IX-FD1-ALTKEY1
                INVALID KEY MOVE "INVALID KEY ON START" TO COMPUTED-A
                           GO TO READ-FAIL-F1-02.
           READ    IX-FD1  NEXT  AT END
                   MOVE  "AT END ON READ"  TO COMPUTED-A
                   GO TO  READ-FAIL-F1-02.
           MOVE    IX-FD1R1-F-G-240  TO FILE-RECORD-INFO (1).
           IF      XRECORD-NUMBER (1) EQUAL TO 182
                   PERFORM   PASS
                   GO TO   READ-WRITE-F1-02.
       READ-FAIL-F1-02.
           PERFORM FAIL.
           MOVE    "RECORD 182 RETRIEVED"  TO CORRECT-A.
           MOVE "SEQUENTIAL READ; IX-28 4.5.2"  TO RE-MARK.
       READ-WRITE-F1-02.
           PERFORM PRINT-DETAIL.
       RWRT-TEST-GF-01.
           MOVE "REWRITE             " TO FEATURE.
           MOVE "RWRT-TEST-GF-01     " TO PAR-NAME.
      *> 
      *>   RWRT-TEST-GF-01 - THE TEST MODIFIES THE CONTENTS OF ALTERNATE-
      *>                     KEY1 OF THE RECORD RETRIEVED BY THE TEST
      *>                     BEFORE AND REWRITES THE RECORD.THE NEW ALTER-
      *>                     NATE KEY VALUE IS "WWWWWWXXXX369ALTKEY1"
      *>                     WHICH BECOMES SEQUENTIAL RECORD NUMBER  184.
      *>                     THE NEW KEY FOR THE FILE HAS A KEY VALUE
      *>                     SEQUENTIALLY GREATER THAN THE RECORD VALUE
      *>                     RETRIEVED FROM RECORD. THE SEQUENTIAL RECORD
      *>                     RETRIEVED BEFORE THE REWRITE WAS NUMBER
      *>                     182.  THE CURRENT RECORD POINTER FOR THE FILE
      *>                     IS NOT EXPECTED TO BE MODIFIED BY
      *>                     EXECUTION OF THE REWRITE.
      *> 
           MOVE    182  TO ODO-NUMBER (1).
           ADD     01  TO UPDATE-NUMBER (1).
           MOVE    "WWWWWWXXXX369ALTKEY1"  TO FD1-ALTKEY1-1-20.
           MOVE    WRK-FD1-ALTKEY1  TO ALTERNATE-KEY1 (1).
           MOVE    FILE-RECORD-INFO (1) TO IX-FD1R1-F-G-240.
           REWRITE IX-FD1R1-F-G-240  INVALID KEY
                           MOVE   "INVALID KEY REWRITE" TO COMPUTED-A
                           GO TO   RWRT-FAIL-GF-01.
           PERFORM PASS.
           GO TO   RWRT-WRITE-GF-01.
       RWRT-FAIL-GF-01.
           PERFORM FAIL.
           MOVE "IX-33 4.6.2       "  TO RE-MARK.
       RWRT-WRITE-GF-01.
           PERFORM PRINT-DETAIL.
       READ-INIT-F1-03.
           MOVE "READ NEXT AT END    " TO FEATURE.
           MOVE "READ-TEST-F1-03     " TO PAR-NAME.
       READ-TEST-F1-03.
      *> 
      *>   READ-TEST-F1-03 - THIS TEST PERFORMS A SEQUENTIAL READ AND
      *>                     CHECKS THE RECORD MADE AVAILABLE.  THE KEY OF
      *>                     REFERENCE IS EXPECTED TO BE THAT ESTABLISHED
      *>                     BEFORE.              THE LOGICAL RECORD
      *>                     RETRIEVED IS EXPECTED TO BE THAT RECORD THAT
      *>                     WOULD HAVE BEEN RETRIEVED HAD THE ALTERNATE
      *>                     KEY NOT BEEN CHANGE BY THE REWRITE IN
      *>                     RWRT-TEST-GF-01.
      *> 
           READ    IX-FD1  NEXT  AT END
                           MOVE   "AT END ON READ"  TO COMPUTED-A
                   GO TO   READ-FAIL-F1-03.
           MOVE    IX-FD1R1-F-G-240  TO FILE-RECORD-INFO (1).
           IF      XRECORD-NUMBER (1) EQUAL TO 183
                   PERFORM  PASS
                   GO TO READ-WRITE-F1-03.
           MOVE    58  TO RECNO.
           PERFORM DISPLAY-ALTERNATE-KEY1.
           MOVE    XRECORD-NUMBER (1) TO COMPUTED-18V0.
       READ-FAIL-F1-03.
            PERFORM FAIL.
           MOVE    183  TO CORRECT-18V0.
           MOVE "RECORD NUMBER; IX-28"  TO RE-MARK.
       READ-WRITE-F1-03.
           PERFORM PRINT-DETAIL.
       READ-INIT-F1-04.
           MOVE "READ NEXT 4 RECS    " TO FEATURE.
           MOVE "READ-TEST-F1-04     " TO PAR-NAME.
           MOVE    ZERO TO EXCUT-COUNTER-06V00.
           MOVE    183  TO RECKEY-NUM.
       READ-TEST-F1-04.
      *> 
      *>   READ-TEST-F1-04 - THE TEST SEQUENTIALLY READS THE NEXT 4 REC-
      *>                     ORDS AND CHECKS THE RECORD NUMBER FIELD OF
      *>                     EACH RECORD RETRIEVED.  THE CONTENTS OF
      *>                     THE RECORD NUMBER FIELD IS EXPECTED TO BE
      *>                     184, 182, 185 AND 186 (ALTERNATE KEY VALUES
      *>                     WWWWWWXXXX368ALTKEY1 THROUGH WWWXXXXXXX372
      *>                     ALTKEY1 RESPECTIVELY).  THE RECORD IN WHICH
      *>                     THE ALTERNATE KEY VALUE WAS CHANGED TO
      *>                     WWWWWWXXXX369ALTKEY1 (SEQUENTIAL RECORD 184
      *>                     AFTER THE REORDING OCCURS I.E, AS A RESULT OF
      *>                     CHANGING THE ALTERNATE KEY VALUE IN
      *>                     RWRT-TEST-GF-01) SHOULD BE MADE AVAILABLE.
      *> 
           READ    IX-FD1  NEXT  AT END
                           MOVE  "AT END ON READ"  TO COMPUTED-A
                           MOVE   "SUCCESSFUL READ"  TO CORRECT-A
                           GO TO   READ-FAIL-F1-04.
           MOVE    IX-FD1R1-F-G-240  TO FILE-RECORD-INFO (1).
           IF      EXCUT-COUNTER-06V00  EQUAL TO  1
                   MOVE  182 TO RECKEY-NUM    ELSE
                   ADD     001  TO RECKEY-NUM.
           IF      XRECORD-NUMBER (1)  NOT EQUAL TO RECKEY-NUM
                   MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0
                   MOVE    RECKEY-NUM TO CORRECT-18V0
                   GO TO   READ-FAIL-F1-04.
           IF      EXCUT-COUNTER-06V00  EQUAL TO  1
                   MOVE  184  TO RECKEY-NUM.
           ADD     001  TO EXCUT-COUNTER-06V00.
           IF      EXCUT-COUNTER-06V00  NOT LESS THAN 4
                   PERFORM  PASS
                   GO TO READ-WRITE-F1-04.
           GO TO READ-TEST-F1-04.
       READ-FAIL-F1-04.
           PERFORM  FAIL.
           MOVE "IX-28, IX-32" TO RE-MARK.
       READ-WRITE-F1-04.
           PERFORM PRINT-DETAIL.
           CLOSE   IX-FD1.
       
       
       READ-INIT-F1-004.
           OPEN    INPUT IX-FD1.
           MOVE    "READ UPDATED ALTKEY"  TO FEATURE.
           MOVE    "READ-TEST-F1-004" TO PAR-NAME.
           MOVE    "SSSSSSSSSS360"  TO FD1-RECKEY-1-13.
           MOVE    "WWWWWWWWWW360ALTKEY1"  TO FD1-ALTKEY1-1-20.
           MOVE    "FFFFFFFFFF040ALTKEY2"  TO FD1-ALTKEY2-1-20.
           MOVE    WRK-FD1-RECKEY TO IX-REC-KEY-AREA.
           MOVE    WRK-FD1-ALTKEY1  TO IX-ALT-KEY1-AREA.
           MOVE    WRK-FD1-ALTKEY2 TO IX-ALT-KEY2-AREA.
           MOVE    180  TO RECKEY-NUM.
           START   IX-FD1
                          KEY IS EQUAL TO IX-FD1-ALTKEY1
             INVALID KEY   MOVE  "INVALID KEY ON START"  TO COMPUTED-A
                   GO TO READ-FAIL-004.
           MOVE    179  TO RECKEY-NUM.
           MOVE    ZERO TO EXCUT-COUNTER-06V00.
           MOVE   4     TO REC-CT.
       READ-TEST-F1.
           ADD 1 TO REC-CT.
           MOVE "READ  UPDATED RECS  " TO FEATURE.
           MOVE "READ-TEST-F1-       " TO PAR-NAME.
      *> 
      *> READ-TEST-F1-04 - THIS TEST READS THAT SEGMENT OF THE FILE
      *>                   UPDATED IN THE FIRST 4 TESTS AND CHECKS THE NEW
      *>                   SEQUENTIAL ORDER OF THE RECORDS. THE SEQUENTIAL
      *>                   RETRIEVAL OF THE RECORDS FROM THE FILE IS
      *>                   EXPECTED TO REFLECT THE UPDATED KEY SEQUENCE.
      *>                                        THE START STATEMENT
      *>                   EXTABLISHES ALTERNATE KEY1  AS THE KEY OF REF-
      *>                   ERENCE AND CURRENT RECORD POINTER TO POINT TO
      *>                   RELATIVE  RECORD NUMBER 180 (ALTERNATE-KEY1
      *>                   VALUE WWWWWWWWWW360ALTKEY1   BEFORE THE FILE
      *>                   READING BEGINS.
      *> 
           ADD     001  TO RECKEY-NUM.
           READ    IX-FD1 NEXT  AT END
                   MOVE  "AT END ON READ"  TO COMPUTED-A
                   GO TO READ-FAIL-004.
           MOVE    IX-FD1R1-F-G-240 TO FILE-RECORD-INFO (1).
           IF      RECKEY-NUM EQUAL TO 182
                   MOVE  "YES"  TO ADJUSTED-NUM
                   ADD  001  TO RECKEY-NUM.
      *> 
      *>     THE ABOVE IF STATEMENT ADJUSTS THE RECKEY-NUM TO ACCOUNT
      *>     FOR THE VOID LEFT IN THE NUMBERING SEQUENCE WHEN THE RECORD
      *>     WAS REWRITTEN WITH A NEW ALTERNATE KEY.  THE RELATIVE
      *>     RETREIVAL POSITION OF THE RECORD IN THE FILE SHOULD HAVE
      *>     CHANGED FROM 182  TO 184.
      *> 
           IF      RECKEY-NUM EQUAL TO 185
                   AND  ADJUSTED-NUM EQUAL TO "YES"
                   MOVE  "NO" TO ADJUSTED-NUM
                   SUBTRACT  001  FROM RECKEY-NUM
      *> 
      *>      THE SUBTRACT STATEMENT IS TO READJUST RECKEY-NUM  FOR
      *>     INSERTED     RECORD CAUSED BY UPDATE OF ALTERNATE KEY IN
      *>     THE RECORD.  THE SEQUENTIAL RETRIEVAL POSITION OF UPDATED
      *>     RECORD SHOULD BE POSITION NUMBER 184.
      *> 
                   PERFORM  READ-TEST-004-1
                   ADD   001  TO EXCUT-COUNTER-06V00
                   GO TO READ-TEST-F1.
           IF      XRECORD-NUMBER (1)  EQUAL TO RECKEY-NUM
                   PERFORM  READ-PASS-004
                   ELSE
                   MOVE  XRECORD-NUMBER (1)  TO COMPUTED-18V0
                   PERFORM  READ-FAIL-004.
           ADD     001  TO EXCUT-COUNTER-06V00.
           IF      EXCUT-COUNTER-06V00  LESS THAN 11
                   GO TO READ-TEST-F1.
           GO TO   READ-END-004.
       READ-TEST-004-1.
           IF      XRECORD-NUMBER (1)  EQUAL TO 182
                   PERFORM  READ-PASS-004
                   ELSE
                   MOVE  "WWWWWWXXXX369ALTKEY1"  TO CORRECT-A
                   MOVE  ALTERNATE-KEY1 (1) TO WRK-FD1-ALTKEY1
                   MOVE  FD1-ALTKEY1-1-20  TO COMPUTED-A
                   MOVE  SPACE TO P-OR-F
                 MOVE   "ALTERNATE RECORD KEY1 VALUES; IX-33" TO RE-MARK
                   PERFORM  PRINT-DETAIL
                   MOVE   XRECORD-NUMBER (1)  TO COMPUTED-18V0
                   MOVE  182 TO CORRECT-18V0
                   PERFORM FAIL
                   PERFORM  PRINT-DETAIL.
       READ-PASS-004.
           PERFORM PASS
           PERFORM PRINT-DETAIL.
       READ-FAIL-004.
           PERFORM FAIL.
           MOVE    RECKEY-NUM TO CORRECT-18V0.
           MOVE    "RECORD NUMBER; IX-28, IX-33 "  TO RE-MARK.
           PERFORM PRINT-DETAIL.
       READ-END-004.
           CLOSE   IX-FD1.
       
           GO TO CCVS-EXIT.
       
       
       INX-INITIALIZE-RECORD.
           MOVE    "GGGGGGGGGG200" TO  FD1-RECKEY-1-13.
           MOVE    ZERO  TO INIT-FLAG.
           MOVE    9999  TO XRECORD-NUMBER (1).
           MOVE    SPACE TO IX-FD1R1-F-G-240.
           MOVE    WRK-FD1-RECKEY TO IX-REC-KEY-AREA.
           START   IX-FD1
                           KEY IS EQUAL TO IX-FD1-KEY
                INVALID KEY MOVE   1  TO INIT-FLAG.
           READ    IX-FD1 NEXT INTO FILE-RECORD-INFO (1)
                           AT END  MOVE  1 TO INIT-FLAG.
           IF      XRECORD-NUMBER (1) NOT EQUAL TO 100
                   MOVE 1 TO INIT-FLAG.
       DISPLAY-RECORD-KEYS.
           MOVE    XRECORD-KEY (1)  TO WRK-FD1-RECKEY.
           MOVE    FD1-RECKEY-1-13  TO COMPUTED-A.
           MOVE    RECKEY-VALUE (RECNO)  TO CORRECT-A.
           MOVE    SPACE TO P-OR-F.
           MOVE    "RECORD KEY VALUES" TO RE-MARK.
           PERFORM PRINT-DETAIL.
       DISPLAY-ALTERNATE-KEY1.
           MOVE    ALTERNATE-KEY1 (1)  TO WRK-FD1-ALTKEY1.
           MOVE    FD1-ALTKEY1-1-20  TO COMPUTED-A.
           MOVE    ALTKEY1-VALUE (RECNO)  TO CORRECT-A.
           MOVE    SPACE TO P-OR-F.
           MOVE    "ALTERNATE RECORD KEY1 VALUES"  TO RE-MARK.
           PERFORM PRINT-DETAIL.
       DISPLAY-ALTERNATE-KEY2.
           MOVE    ALTERNATE-KEY2 (1) TO WRK-FD1-ALTKEY2.
           MOVE    FD1-ALTKEY2-1-20  TO COMPUTED-A.
           MOVE    ALTKEY2-VALUE (RECNO)  TO CORRECT-A.
           MOVE    SPACE TO P-OR-F.
           MOVE    "ALTERNATE RECORD KEY2 VALUES"  TO RE-MARK.
           PERFORM PRINT-DETAIL.
       
       
       CCVS-EXIT SECTION.
       CCVS-999999.
           GO TO CLOSE-FILES.
      *> END-OF,IX211A