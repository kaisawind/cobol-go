      *> HEADER,COBOL,CM202M
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           CM202M.
       AUTHOR.
      *>CE     FEDERAL COMPILER TESTING CENTER.
       INSTALLATION.
      *>CE     GENERAL SERVICES ADMINISTRATION
      *>CE      AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
      *>CE     SOFTWARE DEVELOPMENT OFFICE.
      *>CE     5203 LEESBURG PIKE  SUITE 1100
      *>CE     FALLS CHURCH VIRGINIA 22041.
      *>CE 
      *>CE     PHONE   (703) 756-6153
      *>CE 
      *>CE     " HIGH       ".
       DATE-WRITTEN.
      *>CE     CCVS-74 VERSION 4.0 - 1980 JULY 1.
      *>CE     CREATION DATE     /    VALIDATION DATE
      *>CE     "4.2 ".
       SECURITY.
      *>CE     NONE.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE
           LABEL RECORDS
           XXXXX084
           DATA RECORD IS PRINT-REC DUMMY-RECORD.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       WORKING-STORAGE SECTION.
       77  END-FLAG PIC 9.
       77  FAIL-SAFE PIC 999 COMP.
       77  ELAPSED-TIME PIC 999.
       77  ENABLE-ALL-MSG PIC X(57) VALUE
           "ATTEMPT TO ENTER MESSAGES.  BOTH SOURCES ARE NOW ENABLED.".
       01  INIT-TIME.
           02  I-HRS PIC 99.
           02  I-MINS PIC 99.
           02  I-SECS PIC 99V99.
       01  TEST-TIME.
           02  T-HRS PIC 99.
           02  T-MINS PIC 99.
           02  T-SECS PIC 99V99.
       01  SKIP-MSG-1 PIC X(71) VALUE "SEGMENTED-MSG-TEST-05: THERE SHOULD BE NO BLANK LINES BETWEEN THIS LINE".
       01  SKIP-MSG-2 PIC X(17) VALUE "AND THIS ONE.".
       01  INCOMP-MSG.
           02  FILLER PIC X(20) VALUE "INCOMPLETE-MSG-TEST-".
           02  INC-MSG-NO PIC 99.
           02  FILLER PIC X(33) VALUE " FAILURE IF THIS SEGMENT APPEARS.".
       01  ENABLE-MSG.
           02  FILLER PIC X(34) VALUE "ATTEMPT TO ENTER MESSAGES.  ONLY """.
           02  SELECTED-SOURCE PIC X(12).
           02  FILLER PIC X(13) VALUE """ IS ENABLED.".
       01  DISABLE-MSG.
           02  FILLER PIC X(36) VALUE
           "TERMINALS DEACTIVATED FOR INPUT:    ".
           02  TERMINAL-1 PIC X(14) VALUE
           XXXXX042.
           02  TERMINAL-2 PIC X(12) VALUE
           XXXXX043.
       01  SEND-MSG.
           02  FILLER PIC X(17) VALUE "SEND-STATUS-TEST-".
           02  TEST-NUMB PIC 99 VALUE 1.
           02  FILLER PIC X(42) VALUE
           " FAILURE.  THIS MESSAGE SHOULD NOT APPEAR.".
       01  ONE-TERMINAL-MSG.
           02  FILLER PIC X(15) VALUE "ONLY TERMINAL """.
           02  SELECTED-DEST PIC X(12) VALUE
           XXXXX032.
           02  FILLER PIC X(30) VALUE
           """ SHOULD RECEIVE THIS MESSAGE.".
       01  SEG-INIT.
           02  FILLER PIC X(19) VALUE "SEGMENTED-MSG-TEST-".
           02  SEG-TEST-NO PIC 99.
           02  FILLER PIC X(19) VALUE " SEGMENT INITIATED ".
           02  FILLER PIC X(16) VALUE "-LENGTH FAILURE ".
       01  SEG-CONT PIC X(10) VALUE "-CONTINUED".
       01  MSG-COMP PIC X(14) VALUE "-MSG COMPLETE.".
       01  GROUP-COMP PIC X(16) VALUE "-GROUP COMPLETE.".
       01  TEST-RESULTS.
           02 FILLER                    PICTURE X VALUE SPACE.
           02 FEATURE                   PICTURE X(18).
           02 FILLER                    PICTURE X VALUE SPACE.
           02 P-OR-F                    PICTURE X(5).
           02 FILLER                    PICTURE X  VALUE SPACE.
           02  PAR-NAME PIC X(20).
           02 FILLER                    PICTURE X VALUE SPACE.
           02  COMPUTED-A.
               03  FILLER PIC X(9).
               03  COMPUTED-STATUS PIC XX.
               03  FILLER PIC X(9).
           02 FILLER                    PICTURE X VALUE SPACE.
           02  CORRECT-A.
               03  FILLER PIC X(9).
               03  CORRECT-STATUS PIC XX.
               03  FILLER PIC X(9).
           02 FILLER                    PICTURE X VALUE SPACE.
           02  RE-MARK.
               03  MSG-1 PIC X.
               03  FILLER PIC X(29).
       01  COLUMNS-LINE-1.
           02  FILLER PIC X(3) VALUE SPACES.
           02  FILLER PIC X(17) VALUE "FEATURE TESTED".
           02  FILLER PIC X(9) VALUE "RESLT".
           02  FILLER PIC X(21) VALUE "PARAGRAPH NAME".
           02  FILLER PIC X(22) VALUE "COMPUTED DATA".
           02  FILLER PIC X(29) VALUE "CORRECT DATA".
           02  FILLER PIC X(7) VALUE "REMARKS".
       01  COLUMNS-LINE-2.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(18) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(5) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(20) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(20) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(20) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(31) VALUE ALL "-".
       01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
       01  REC-CT PICTURE 99 VALUE ZERO.
       01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
       01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
       01  INSPECT-COUNTER PIC 999 VALUE ZERO.
       01  PASS-COUNTER PIC 999 VALUE ZERO.
       01  TOTAL-ERROR PIC 999 VALUE ZERO.
       01  ERROR-HOLD PIC 999 VALUE ZERO.
       01  DUMMY-HOLD PIC X(120) VALUE SPACE.
       01  RECORD-COUNT PIC 9(5) VALUE ZERO.
       01  CCVS-H-1.
           02  FILLER   PICTURE X(27)  VALUE SPACE.
           02 FILLER PICTURE X(67) VALUE
           " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION   SYSTEM".
           02  FILLER     PICTURE X(26)  VALUE SPACE.
       01  CCVS-H-2.
           02 FILLER PICTURE X(52) VALUE IS
           "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
           02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
           02 TEST-ID PICTURE IS X(9).
           02 FILLER PICTURE IS X(40) VALUE IS SPACE.
       01  CCVS-H-3.
           02  FILLER PICTURE X(34) VALUE
           " FOR OFFICIAL USE ONLY    ".
           02  FILLER PICTURE X(58) VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER PICTURE X(28) VALUE
           "  COPYRIGHT   1974 ".
       01  CCVS-E-1.
           02 FILLER PICTURE IS X(52) VALUE IS SPACE.
           02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN PICTURE IS X(9).
           02 FILLER PICTURE X(45) VALUE IS
           " NTIS DISTRIBUTION COBOL 74".
       01  CCVS-E-2.
           02  FILLER                   PICTURE X(31)  VALUE
           SPACE.
           02  FILLER                   PICTURE X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
               03 FILLER PICTURE IS X VALUE IS SPACE.
               03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER PICTURE X(22) VALUE
           " FOR OFFICIAL USE ONLY".
           02  FILLER PICTURE X(12) VALUE SPACE.
           02  FILLER PICTURE X(58) VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER PICTURE X(13) VALUE SPACE.
           02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
       01  CCVS-E-4.
           02 CCVS-E-4-1 PIC XXX VALUE SPACE.
           02 FILLER PIC XXXX VALUE " OF ".
           02 CCVS-E-4-2 PIC XXX VALUE SPACE.
           02 FILLER PIC X(40) VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
           02 INFO-TEXT.
           04 FILLER PIC X(20) VALUE SPACE.
           04 XXCOMPUTED PIC X(20).
           04 FILLER PIC X(5) VALUE SPACE.
           04 XXCORRECT PIC X(20).
       01  HYPHEN-LINE.
           02 FILLER PICTURE IS X VALUE IS SPACE.
           02 FILLER PICTURE IS X(65) VALUE IS "*****************************************************************".
           02 FILLER PICTURE IS X(54) VALUE IS "******************************************************".
       01  CCVS-PGM-ID PIC X(6) VALUE
           "CM202M".
       COMMUNICATION SECTION.
       CD  CM-INQUE-1 INPUT.
       01  INQUE-1-RECORD.
           02  QUEUE-SET PIC X(12) VALUE
           XXXXX030.
           02  FILLER PIC X(36) VALUE SPACES.
           02  FILLER PIC X(14).
           02  SYM-SOURCE PIC X(12).
           02  IN-LENGTH PIC 9999.
           02  END-KEY PIC X.
           02  IN-STATUS PIC XX.
           02  MSG-COUNT PIC 9(6).
       CD  CM-OUTQUE-1 OUTPUT
           DESTINATION COUNT DEST-COUNT
           TEXT LENGTH OUT-LENGTH
           STATUS KEY OUT-STATUS
           DESTINATION TABLE OCCURS 2 TIMES INDEXED BY I1
           ERROR KEY ERR-KEY
           DESTINATION SYM-DEST.
       PROCEDURE    DIVISION.
       SECT-CM202M-0001 SECTION.
       CM202M-INIT.
           OPEN     OUTPUT PRINT-FILE.
           MOVE "CM202M     " TO TEST-ID.
           MOVE     TEST-ID TO ID-AGAIN.
           MOVE    SPACE TO TEST-RESULTS.
           PERFORM HEAD-ROUTINE.
           MOVE 2 TO DEST-COUNT
           MOVE
           XXXXX032
               TO SYM-DEST (1).
           MOVE
           XXXXX035
               TO SYM-DEST (2).
           ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
           XXXXX033.
           MOVE
           XXXXX042
               TO SELECTED-SOURCE  SYM-SOURCE.
           MOVE 59 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM ENABLE-MSG WITH EMI.
           ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           PERFORM DELAY-FOR-30.
           DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           MOVE
           XXXXX043
               TO SELECTED-SOURCE  SYM-SOURCE.
           SEND CM-OUTQUE-1 FROM ENABLE-MSG WITH EMI.
           ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           PERFORM DELAY-FOR-30.
           MOVE 57 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM ENABLE-ALL-MSG WITH EMI.
           MOVE
           XXXXX042
               TO SYM-SOURCE.
           ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           PERFORM DELAY-FOR-30.
           DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           MOVE
           XXXXX043
               TO SYM-SOURCE.
           DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           MOVE 62 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM DISABLE-MSG WITH EMI.
           PERFORM DELAY-FOR-30.
       BEGIN-CM202M-STATUS-TESTS.
           MOVE 200 TO FAIL-SAFE.
           MOVE "RCV MSG/SHORT AREA" TO FEATURE.
           MOVE "RECEIVE-TEST-01" TO PAR-NAME.
           MOVE " SEE REMARKS COLUMN " TO COMPUTED-A.
           MOVE "  INSPECT RESULTS" TO CORRECT-A.
       RECEIVE-TEST-01.
           RECEIVE CM-INQUE-1 MESSAGE INTO MSG-1  NO DATA
               MOVE "QUEUE TESTED EMPTY" TO COMPUTED-A
               MOVE SPACES TO CORRECT-A RE-MARK
               PERFORM FAIL  PERFORM PRINT-DETAIL
               GO TO RECEIVE-TEST-02-INIT.
           IF END-KEY IS EQUAL TO "1"
               MOVE SPACE TO CORRECT-A
               MOVE "   ESI WAS SENSED   " TO COMPUTED-A
               PERFORM FAIL
               PERFORM PRINT-DETAIL
               GO TO RECEIVE-TEST-02-INIT.
           PERFORM PRINT-DETAIL.
           IF END-KEY IS NOT EQUAL TO "0" GO TO RECEIVE-TEST-02-INIT.
           MOVE "RECEIVE-TEST-01-CONT" TO PAR-NAME.
           SUBTRACT 1 FROM FAIL-SAFE.
           IF FAIL-SAFE IS EQUAL TO 0
               MOVE "FAIL-SAFE ACTIVATED" TO CORRECT-A
               MOVE "****** WARNING *****" TO COMPUTED-A
               PERFORM PRINT-DETAIL
               GO TO RECEIVE-TEST-02-INIT.
           PERFORM PRINT-DETAIL.
           GO TO RECEIVE-TEST-01.
       RECEIVE-DELETE-01.
           PERFORM DE-LETE.
           PERFORM PRINT-DETAIL.
       RECEIVE-TEST-02-INIT.
           MOVE 200 TO FAIL-SAFE.
           MOVE "RCV SEG/SHORT AREA" TO FEATURE.
           MOVE "RECEIVE-TEST-02" TO PAR-NAME.
           MOVE " SEE REMARKS COLUMN " TO COMPUTED-A.
           MOVE "  INSPECT RESULTS" TO CORRECT-A.
       RECEIVE-TEST-02.
           RECEIVE CM-INQUE-1 SEGMENT INTO MSG-1  NO DATA
               MOVE "QUEUE TESTED EMPTY" TO COMPUTED-A
               MOVE SPACES TO CORRECT-A  RE-MARK
               PERFORM FAIL  PERFORM PRINT-DETAIL
               GO TO RECEIVE-TEST-03-INIT.
           PERFORM PRINT-DETAIL.
           IF END-KEY IS NOT EQUAL TO "0" GO TO RECEIVE-TEST-03-INIT.
           MOVE "RECEIVE-TEST-02-CONT" TO PAR-NAME.
           SUBTRACT 1 FROM FAIL-SAFE.
           IF FAIL-SAFE IS EQUAL TO 0
               MOVE "FAIL-SAFE ACTIVATED" TO CORRECT-A
               MOVE "****** WARNING *****" TO COMPUTED-A
               PERFORM PRINT-DETAIL
               GO TO RECEIVE-TEST-03-INIT.
           PERFORM PRINT-DETAIL.
           GO TO RECEIVE-TEST-02.
       RECEIVE-DELETE-02.
           PERFORM DE-LETE.
           PERFORM PRINT-DETAIL.
       RECEIVE-TEST-03-INIT.
           MOVE "RCV SEG REPEATEDLY" TO FEATURE.
           MOVE "RECEIVE-TEST-03" TO PAR-NAME.
       RECEIVE-TEST-03.
           MOVE "COMPTD SHOWS END KEY" TO CORRECT-A.
           MOVE ALL "*" TO RE-MARK.
           RECEIVE CM-INQUE-1 SEGMENT INTO RE-MARK
               NO DATA GO TO ENABL-STATUS-TEST-01.
           MOVE END-KEY TO COMPUTED-STATUS.
           PERFORM PRINT-DETAIL.
           MOVE "RECEIVE-TEST-03-CONT" TO PAR-NAME.
           GO TO RECEIVE-TEST-03.
       RECEIVE-DELETE-03.
           PERFORM DE-LETE.
           PERFORM PRINT-DETAIL.
       ENABL-STATUS-TEST-01.
           MOVE "ENABLE TERMINAL" TO FEATURE.
           MOVE "BAD PASSWORD SUPPLIED" TO RE-MARK.
           ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY "GARBAGE".
           IF IN-STATUS IS EQUAL TO "40"
               PERFORM PASS GO TO ENABL-STATUS-WRITE-01.
           MOVE IN-STATUS TO COMPUTED-STATUS.
           MOVE "40" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO ENABL-STATUS-WRITE-01.
       ENABL-STATUS-DELETE-01.
           PERFORM DE-LETE.
       ENABL-STATUS-WRITE-01.
           MOVE "ENABL-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ENABL-STATUS-TEST-02.
           MOVE "BAD SOURCE NAME USED" TO RE-MARK.
           MOVE "GARBAGE" TO SYM-SOURCE.
           ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           IF IN-STATUS IS EQUAL TO "21"
               PERFORM PASS  GO TO ENABL-STATUS-WRITE-02.
           MOVE IN-STATUS TO COMPUTED-STATUS.
           MOVE "21" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO ENABL-STATUS-WRITE-02.
       ENABL-STATUS-DELETE-02.
           PERFORM DE-LETE.
       ENABL-STATUS-WRITE-02.
           MOVE "ENABL-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       DISAB-STATUS-TEST-01.
           MOVE "DISABLE TERMINAL" TO FEATURE.
           MOVE "BAD PASSWORD SUPPLIED" TO RE-MARK.
           MOVE
           XXXXX042
               TO SYM-SOURCE.
           DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY "GARBAGE".
           IF IN-STATUS IS EQUAL TO "40"
               PERFORM PASS  GO TO DISAB-STATUS-WRITE-01.
           MOVE IN-STATUS TO COMPUTED-STATUS.
           MOVE "40" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO DISAB-STATUS-WRITE-01.
       DISAB-STATUS-DELETE-01.
           PERFORM DE-LETE.
       DISAB-STATUS-WRITE-01.
           MOVE "DISAB-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       DISAB-STATUS-TEST-02.
           MOVE "BAD SOURCE NAME USED" TO RE-MARK.
           MOVE "GARBAGE" TO SYM-SOURCE.
           DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
           XXXXX031.
           IF IN-STATUS IS EQUAL TO "21"
               PERFORM PASS  GO TO DISAB-STATUS-WRITE-02.
           MOVE IN-STATUS TO COMPUTED-STATUS.
           MOVE "21" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO DISAB-STATUS-WRITE-02.
       DISAB-STATUS-DELETE-02.
           PERFORM DE-LETE.
       DISAB-STATUS-WRITE-02.
           MOVE "DISAB-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       SEND-STATUS-TEST-01.
           MOVE "COUNT EXCEEDS LIMIT" TO RE-MARK.
           MOVE 3 TO DEST-COUNT.
           MOVE 61 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEND-MSG WITH EMI.
           IF OUT-STATUS IS EQUAL TO "30"
               PERFORM PASS  GO TO SEND-STATUS-WRITE-01.
           MOVE OUT-STATUS TO COMPUTED-STATUS.
           MOVE "30" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO SEND-STATUS-WRITE-01.
       SEND-STATUS-DELETE-01.
           PERFORM DE-LETE.
       SEND-STATUS-WRITE-01.
           MOVE "DESTINATION COUNT" TO FEATURE.
           MOVE "SEND-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
           MOVE 2 TO DEST-COUNT.
       SEND-STATUS-TEST-02.
           MOVE 2 TO TEST-NUMB.
           MOVE 0 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEND-MSG.
           IF OUT-STATUS IS EQUAL TO "60"
               PERFORM PASS  GO TO SEND-STATUS-WRITE-02.
           MOVE OUT-STATUS TO COMPUTED-STATUS.
           MOVE "60" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO SEND-STATUS-WRITE-02.
       SEND-STATUS-DELETE-02.
           PERFORM DE-LETE.
       SEND-STATUS-WRITE-02.
           MOVE "PARTIAL SEGMENT" TO FEATURE.
           MOVE "ZERO CHARACTER COUNT USED" TO RE-MARK.
           MOVE "SEND-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       SEND-STATUS-TEST-03.
           MOVE 0 TO END-FLAG.
           MOVE 3 TO TEST-NUMB.
           MOVE 61 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 WITH END-FLAG.
           IF OUT-STATUS IS EQUAL TO "60"
               PERFORM PASS  GO TO SEND-STATUS-WRITE-03.
           MOVE OUT-STATUS TO COMPUTED-STATUS.
           MOVE "60" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO SEND-STATUS-WRITE-03.
       SEND-STATUS-DELETE-03.
           PERFORM DE-LETE.
       SEND-STATUS-WRITE-03.
           MOVE "NO SENDING AREA SPECIFIED" TO RE-MARK.
           MOVE "SEND-STATUS-TEST-03" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       SEND-STATUS-TEST-04.
           MOVE 57 TO OUT-LENGTH.
           MOVE "GARBAGE" TO SYM-DEST (2).
           SEND CM-OUTQUE-1 FROM ONE-TERMINAL-MSG WITH EMI.
           IF OUT-STATUS IS NOT EQUAL TO "20"
               MOVE OUT-STATUS TO COMPUTED-STATUS
               MOVE "STATUS SHOULD BE 20" TO CORRECT-A
               PERFORM FAIL
           ELSE IF ERR-KEY (2) IS NOT EQUAL TO "1"
               MOVE ERR-KEY (2) TO COMPUTED-STATUS
               MOVE " ERROR KEY (2) = 1" TO CORRECT-A
               PERFORM FAIL
           ELSE IF ERR-KEY (1) IS NOT EQUAL TO "0"
               MOVE ERR-KEY (1) TO COMPUTED-STATUS
               MOVE " ERROR KEY (1) = 0" TO CORRECT-A
               PERFORM FAIL
           ELSE PERFORM PASS.
           GO TO SEND-STATUS-WRITE-04.
       SEND-STATUS-DELETE-04.
           PERFORM DE-LETE.
       SEND-STATUS-WRITE-04.
           MOVE "SYMBOLIC DESTINAT""N (2) IS BAD" TO RE-MARK.
           MOVE "SEND-STATUS-TEST-04" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
           MOVE
           XXXXX035
               TO SYM-DEST (2).
       SEGMENTED-MSG-TEST-01.
           MOVE 1 TO SEG-TEST-NO.
           MOVE 39 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEG-INIT WITH ESI.
           MOVE 14 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM MSG-COMP WITH EMI.
       SEGMENTED-MSG-TEST-02.
           MOVE 2 TO SEG-TEST-NO.
           MOVE 39 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEG-INIT WITH ESI.
           MOVE 16 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM GROUP-COMP WITH EGI.
       SEGMENTED-MSG-TEST-03.
           MOVE 3 TO SEG-TEST-NO.
           MOVE 39 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEG-INIT.
           MOVE 10 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEG-CONT WITH ESI.
           MOVE 14 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM MSG-COMP WITH EMI.
       SEGMENTED-MSG-TEST-04.
           MOVE 4 TO SEG-TEST-NO.
           MOVE 0 TO END-FLAG.
           MOVE 39 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEG-INIT WITH END-FLAG.
           MOVE 1 TO END-FLAG.
           MOVE 10 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM SEG-CONT WITH END-FLAG.
           MOVE 2 TO END-FLAG.
           MOVE 14 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM MSG-COMP WITH END-FLAG.
           MOVE 3 TO END-FLAG.
           MOVE 16 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM GROUP-COMP WITH END-FLAG.
       SEGMENTED-MSG-TEST-05.
           MOVE 71 TO OUT-LENGTH.
           MOVE 0 TO END-FLAG.
           SEND CM-OUTQUE-1 FROM SKIP-MSG-1 WITH END-FLAG
               BEFORE ADVANCING 4 LINES.
           MOVE 17 TO OUT-LENGTH.
           MOVE 3 TO END-FLAG.
           SEND CM-OUTQUE-1 FROM SKIP-MSG-2 WITH END-FLAG.
       SINGLE-TERMINAL-TEST-01.
           MOVE 1 TO DEST-COUNT.
           MOVE 57 TO OUT-LENGTH.
           SEND CM-OUTQUE-1 FROM ONE-TERMINAL-MSG WITH EGI.
           MOVE 2 TO DEST-COUNT.
       INCOMPLETE-MSG-TEST-01.
           MOVE 55 TO OUT-LENGTH.
           MOVE 1 TO INC-MSG-NO.
           SEND CM-OUTQUE-1 FROM INCOMP-MSG.
       INCOMPLETE-MSG-TEST-02.
           MOVE 55 TO OUT-LENGTH.
           MOVE 2 TO INC-MSG-NO.
           SEND CM-OUTQUE-1 FROM INCOMP-MSG WITH ESI.
       INCOMPLETE-MSG-TEST-03.
           MOVE 0 TO END-FLAG.
           MOVE 55 TO OUT-LENGTH.
           MOVE 3 TO INC-MSG-NO.
           SEND CM-OUTQUE-1 FROM INCOMP-MSG WITH END-FLAG.
       INCOMPLETE-MSG-TEST-04.
           MOVE 1 TO END-FLAG.
           MOVE 55 TO OUT-LENGTH.
           MOVE 4 TO INC-MSG-NO.
           SEND CM-OUTQUE-1 FROM INCOMP-MSG WITH END-FLAG.
       STOP-WITHOUT-COMPLETING-MSG.
           PERFORM END-ROUTINE THRU END-ROUTINE-4.
           CLOSE PRINT-FILE.
           STOP RUN.
       DELAY-FOR-30 SECTION.
       TAKE-INIT-TIME.
           ACCEPT INIT-TIME FROM TIME.
       TEST-ELAPSED-TIME.
           ACCEPT TEST-TIME FROM TIME.
           COMPUTE ELAPSED-TIME =
               (T-HRS * 3600 + T-MINS * 60 + T-SECS) -
               (I-HRS * 3600 + I-MINS * 60 + I-SECS).
           IF ELAPSED-TIME IS LESS THAN 30 GO TO TEST-ELAPSED-TIME.
       COMMON-SUBROUTINES SECTION.
       PASS.
           MOVE "PASS" TO P-OR-F.
       FAIL.
           ADD      1 TO ERROR-COUNTER.
           MOVE "FAIL*" TO P-OR-F.
       DE-LETE.
           MOVE     SPACE TO P-OR-F.
           MOVE     "    ************    " TO COMPUTED-A.
           MOVE     "    ************    " TO CORRECT-A.
           MOVE "****TEST DELETED****" TO RE-MARK.
           ADD 1 TO DELETE-CNT.
       PRINT-DETAIL.
           MOVE     TEST-RESULTS TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE     SPACE TO P-OR-F.
           MOVE     SPACE TO COMPUTED-A.
           MOVE SPACE TO CORRECT-A.
           MOVE SPACE TO RE-MARK.
           MOVE SPACE TO FEATURE.
       COLUMN-NAMES-ROUTINE.
           MOVE     COLUMNS-LINE-1 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           MOVE     COLUMNS-LINE-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           PERFORM  BLANK-LINE-PRINT.
       END-ROUTINE.
           MOVE     HYPHEN-LINE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       PARA-Z.
           PERFORM  BLANK-LINE-PRINT 4 TIMES.
           MOVE     CCVS-E-1 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-1.
           PERFORM  BLANK-LINE-PRINT.
           IF       ERROR-COUNTER IS EQUAL TO ZERO
                    GO TO END-ROUTINE-2.
           MOVE     ERROR-COUNTER TO ERROR-TOTAL.
           GO TO    END-ROUTINE-3.
       END-ROUTINE-2.
           MOVE " NO" TO ERROR-TOTAL.
       END-ROUTINE-3.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           IF DELETE-CNT IS EQUAL TO ZERO
               MOVE " NO" TO ERROR-TOTAL  ELSE
           MOVE DELETE-CNT TO ERROR-TOTAL.
           MOVE "TESTS DELETED     " TO ENDER-DESC.
           MOVE CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-4.
           MOVE CCVS-E-3 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       BLANK-LINE-PRINT.
           MOVE     SPACE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       WRITE-LINE.
           WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
       HEAD-ROUTINE.
           MOVE CCVS-H-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER ADVANCING PAGE.
           MOVE CCVS-H-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE CCVS-H-3 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 5 LINES.
           MOVE HYPHEN-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
      *> END-OF,CM202M