      *> HEADER,COBOL,DB104A
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           DB104A.
       AUTHOR.
      *>CE     FEDERAL COMPILER TESTING CENTER.
       INSTALLATION.
      *>CE     GENERAL SERVICES ADMINISTRATION
      *>CE      AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
      *>CE     SOFTWARE DEVELOPMENT OFFICE.
      *>CE     5203 LEESBURG PIKE  SUITE 1100
      *>CE     FALLS CHURCH VIRGINIA 22041.
      *>CE 
      *>CE     PHONE   (703) 756-6153
      *>CE 
      *>CE     " HIGH       ".
       DATE-WRITTEN.
      *>CE     CCVS-74 VERSION 4.0 - 1980 JULY 1.
      *>CE     CREATION DATE     /    VALIDATION DATE
      *>CE     "4.2 ".
       SECURITY.
      *>CE     NONE.
      *>CE 
      *>CE     *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
      *>CE 
      *>CE                        PROGRAM ABSTRACT
      *>CE 
      *>CE     DB104A TESTS THE CAPABILITY OF THE DEBUG MODULE TO HANDLE
      *>CE     PROCEDURES TIED TO SORT INPUT, SORT OUTPUT, AND FILE
      *>CE     DECLARATIVE PROCEDURES.  THIS PROGRAM IS TO BE COMPILED AND
      *>CE     EXECUTED WITH BOTH COMPILE AND OBJECT TIME DEBUGGING
      *>CE     SWITCHES ENABLED.  THE PROGRAM FIRST BUILDS A SEQUENTIAL
      *>CE     FILE CONTAINING 99 EIGHTY CHARACTER RECORDS.  THIS FILE
      *>CE     IS THEN SORTED.
      *>CE 
      *>CE     ALL DEBUGGING PROCEDURES SHOULD BE INCLUDED IN COMPILATION
      *>CE     AND GENERATE CODE.  BEFORE BEGINNING EXECUTION OF THE OBJECT
      *>CE     PROGRAM, THE JOB CONTROL LANGUAGE NECESSARY TO ACTIVATE
      *>CE     THE OBJECT TIME DEBUGGING SWITCH MUST BE SUBMITTED.
      *>CE 
      *>CE     EXECUTION OF THE PROGRAM"S SORT SHOULD TRIGGER DEBUGGING
      *>CE     PROCEDURES AT THE BEGINNING OF THE SORT INPUT AND SORT
      *>CE     OUTPUT PROCEDURES.  DURING EXECUTION OF THE SORT INPUT
      *>CE     PROCEDURE, END-OF-FILE CONDITION ON THE INPUT FILE SHOULD
      *>CE     TRIGGER A DECLARATIVE PROCEDURE ASSOCIATED WITH THE FILE, 
      *>CE     AND THIS IN TURN SHOULD CAUSE EXECUTION OF A DEBUGGING
      *>CE     PROCEDURE MONITORING THE FILE DECLARATIVE PROCEDURE.
      *>CE 
      *>CE     THE PERFORMANCE OF THE SORT VERB IS NOT CHECKED IN DB104.
      *>CE 
      *>CE 
      *>CE 
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082
               WITH DEBUGGING MODE.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
           SELECT GEN-FILE ASSIGN TO
           XXXXX014
           FILE STATUS IS GEN-STATUS.
      *>       XXXXX014  REPLACE WITH SEQUENTIAL ACCESS SCRATCH FILE NAME
           SELECT SORT-FILE ASSIGN TO
           XXXXX027.
      *>       XXXXX27  REPLACE WITH SORT FILE NAME
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE
           LABEL RECORDS
           XXXXX084
           DATA RECORD IS PRINT-REC DUMMY-RECORD.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       FD  GEN-FILE
           VALUE OF
           XXXXX074
      *>       XXXXX074  REPLACE WITH IMPLEMENTOR NAME (*OPT C ONLY)
           IS
           XXXXX075
      *>       XXXXX075  REPLACE WITH VALUE CLAUSE OBJECT (*OPT C ONLY)
      *>     XXXXX069
      *>       XXXXX069  REPLACE WITH ADDITIONAL INFO (*OPT G ONLY)
           LABEL RECORD IS STANDARD.
       01  GEN-REC PIC X(80).
       SD  SORT-FILE.
       01  SORT-REC.
           02  FILLER PIC X(34).
           02  SORT-REC-NO PIC 9(6).
           02  FILLER PIC X(40).
       WORKING-STORAGE SECTION.
       77  RESULT-FLAG PIC 99 COMP VALUE 0.
       77  DBLINE-HOLD PIC X(6).
       77  DBNAME-HOLD PIC X(30).
       77  DBCONT-HOLD PIC X(30).
       01  FILE-RECORD-INFORMATION-REC.
           03 FILE-RECORD-INFO-SKELETON.
              05 FILLER                 PICTURE X(48)       VALUE
                   "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
              05 FILLER                 PICTURE X(46)       VALUE
                   ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
              05 FILLER                 PICTURE X(26)       VALUE
                   ",LFIL=000000,ORG=  ,LBLR= ".
              05 FILLER                 PICTURE X(37)       VALUE
                   ",RECKEY=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY1=                             ".
              05 FILLER                 PICTURE X(38)       VALUE
                   ",ALTKEY2=                             ".
              05 FILLER                 PICTURE X(7)        VALUE SPACE.
           03 FILE-RECORD-INFO          OCCURS  10  TIMES.
              05 FILE-RECORD-INFO-P1-120.
                 07 FILLER              PIC X(5).
                 07 XFILE-NAME           PIC X(6).
                 07 FILLER              PIC X(8).
                 07 XRECORD-NAME         PIC X(6).
                 07 FILLER              PIC X(1).
                 07 REELUNIT-NUMBER     PIC 9(1).
                 07 FILLER              PIC X(7).
                 07 XRECORD-NUMBER       PIC 9(6).
                 07 FILLER              PIC X(6).
                 07 UPDATE-NUMBER       PIC 9(2).
                 07 FILLER              PIC X(5).
                 07 ODO-NUMBER          PIC 9(4).
                 07 FILLER              PIC X(5).
                 07 XPROGRAM-NAME        PIC X(5).
                 07 FILLER              PIC X(7).
                 07 XRECORD-LENGTH       PIC 9(6).
                 07 FILLER              PIC X(7).
                 07 CHARS-OR-RECORDS    PIC X(2).
                 07 FILLER              PIC X(1).
                 07 XBLOCK-SIZE          PIC 9(4).
                 07 FILLER              PIC X(6).
                 07 RECORDS-IN-FILE     PIC 9(6).
                 07 FILLER              PIC X(5).
                 07 XFILE-ORGANIZATION   PIC X(2).
                 07 FILLER              PIC X(6).
                 07 XLABEL-TYPE          PIC X(1).
              05 FILE-RECORD-INFO-P121-240.
                 07 FILLER              PIC X(8).
                 07 XRECORD-KEY          PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY1      PIC X(29).
                 07 FILLER              PIC X(9).
                 07 ALTERNATE-KEY2      PIC X(29).
                 07 FILLER              PIC X(7).
       01  GEN-STATUS.
           02  END-FLAG PIC X.
           02  FILLER PIC X.
       01  SIZE-13.
           02  FILLER PIC XX.
           02  SIZE-11.
               03  FILLER PIC X.
               03  SIZE-10.
                   04  FILLER PIC XX.
                   04  SIZE-8.
                       05  FILLER PIC X.
                       05  SIZE-7 PIC X(7).
       01  TEST-RESULTS.
           02 FILLER                    PICTURE X VALUE SPACE.
           02 FEATURE                   PICTURE X(20) VALUE SPACE.
           02 FILLER                    PICTURE X VALUE SPACE.
           02 P-OR-F                    PICTURE X(5) VALUE SPACE.
           02 FILLER                    PICTURE X  VALUE SPACE.
           02  PAR-NAME.
             03 FILLER PICTURE X(12) VALUE SPACE.
             03  PARDOT-X PICTURE X  VALUE SPACE.
             03 DOTVALUE PICTURE 99  VALUE ZERO.
             03 FILLER PIC X(5) VALUE SPACE.
           02 FILLER PIC X(10) VALUE SPACE.
           02 RE-MARK PIC X(61).
       01  TEST-COMPUTED.
           02 FILLER PIC X(30) VALUE SPACE.
           02 FILLER PIC X(17) VALUE "       COMPUTED=".
           02 COMPUTED-X.
           03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
           03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
           03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
           03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
           03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
           03       CM-18V0 REDEFINES COMPUTED-A.
               04 COMPUTED-18V0                   PICTURE -9(18).
               04 FILLER                          PICTURE X.
           03 FILLER PIC X(50) VALUE SPACE.
       01  TEST-CORRECT.
           02 FILLER PIC X(30) VALUE SPACE.
           02 FILLER PIC X(17) VALUE "       CORRECT =".
           02 CORRECT-X.
           03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
           03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
           03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
           03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
           03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
           03      CR-18V0 REDEFINES CORRECT-A.
               04 CORRECT-18V0                    PICTURE -9(18).
               04 FILLER                          PICTURE X.
           03 FILLER PIC X(50) VALUE SPACE.
       01  CCVS-C-1.
           02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PASS  PARAGRAPH-NAME                                                  REMARKS".
           02 FILLER PICTURE IS X(20) VALUE IS SPACE.
       01  CCVS-C-2.
           02 FILLER PICTURE IS X VALUE IS SPACE.
           02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
           02 FILLER PICTURE IS X(15) VALUE IS SPACE.
           02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
           02 FILLER PICTURE IS X(94) VALUE IS SPACE.
       01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
       01  REC-CT PICTURE 99 VALUE ZERO.
       01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
       01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
       01  INSPECT-COUNTER PIC 999 VALUE ZERO.
       01  PASS-COUNTER PIC 999 VALUE ZERO.
       01  TOTAL-ERROR PIC 999 VALUE ZERO.
       01  ERROR-HOLD PIC 999 VALUE ZERO.
       01  DUMMY-HOLD PIC X(120) VALUE SPACE.
       01  RECORD-COUNT PIC 9(5) VALUE ZERO.
       01  CCVS-H-1.
           02  FILLER   PICTURE X(27)  VALUE SPACE.
           02 FILLER PICTURE X(67) VALUE
           " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION   SYSTEM".
           02  FILLER     PICTURE X(26)  VALUE SPACE.
       01  CCVS-H-2.
           02 FILLER PICTURE X(52) VALUE IS
           "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
           02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
           02 TEST-ID PICTURE IS X(9).
           02 FILLER PICTURE IS X(40) VALUE IS SPACE.
       01  CCVS-H-3.
           02  FILLER PICTURE X(34) VALUE
           " FOR OFFICIAL USE ONLY    ".
           02  FILLER PICTURE X(58) VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER PICTURE X(28) VALUE
           "  COPYRIGHT   1974 ".
       01  CCVS-E-1.
           02 FILLER PICTURE IS X(52) VALUE IS SPACE.
           02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN PICTURE IS X(9).
           02 FILLER PICTURE X(45) VALUE IS
           " NTIS DISTRIBUTION COBOL 74".
       01  CCVS-E-2.
           02  FILLER                   PICTURE X(31)  VALUE
           SPACE.
           02  FILLER                   PICTURE X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
               03 FILLER PICTURE IS X VALUE IS SPACE.
               03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER PICTURE X(22) VALUE
           " FOR OFFICIAL USE ONLY".
           02  FILLER PICTURE X(12) VALUE SPACE.
           02  FILLER PICTURE X(58) VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER PICTURE X(13) VALUE SPACE.
           02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
       01  CCVS-E-4.
           02 CCVS-E-4-1 PIC XXX VALUE SPACE.
           02 FILLER PIC XXXX VALUE " OF ".
           02 CCVS-E-4-2 PIC XXX VALUE SPACE.
           02 FILLER PIC X(40) VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
           02 INFO-TEXT.
           04 FILLER PIC X(20) VALUE SPACE.
           04 XXCOMPUTED PIC X(20).
           04 FILLER PIC X(5) VALUE SPACE.
           04 XXCORRECT PIC X(20).
       01  HYPHEN-LINE.
           02 FILLER PICTURE IS X VALUE IS SPACE.
           02 FILLER PICTURE IS X(65) VALUE IS "*****************************************************************".
           02 FILLER PICTURE IS X(54) VALUE IS "******************************************************".
       01  CCVS-PGM-ID PIC X(6) VALUE
           "DB104A".
       PROCEDURE DIVISION.
       DECLARATIVES.
       SORT-IN-PROC SECTION.
           USE FOR DEBUGGING ON SORT-IN.
       BEGIN-SORT-IN-PROC.
           MOVE 1 TO RESULT-FLAG.
       DB-COMMON.
           MOVE DEBUG-LINE TO DBLINE-HOLD.
           MOVE DEBUG-NAME TO DBNAME-HOLD.
           MOVE DEBUG-CONTENTS TO DBCONT-HOLD.
       SORT-OUT-PROC SECTION.
           USE FOR DEBUGGING ON SORT-OUT.
       BEGIN-SORT-OUT-PROC.
           MOVE 2 TO RESULT-FLAG.
           PERFORM DB-COMMON.
       USE-PROC SECTION.
           USE FOR DEBUGGING ON AT-END-PROC.
       BEGIN-USE-PROC.
           ADD 3 TO RESULT-FLAG.
           PERFORM DB-COMMON.
       AT-END-PROC SECTION.
           USE AFTER ERROR PROCEDURE ON GEN-FILE.
       BEGIN-AT-END-PROC.
           ADD 4 TO RESULT-FLAG.
       END DECLARATIVES.
       CCVS1 SECTION.
       OPEN-FILES.
           OPEN     OUTPUT PRINT-FILE.
           MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
           MOVE    SPACE TO TEST-RESULTS.
           PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
           GO TO CCVS1-EXIT.
       CLOSE-FILES.
           PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
       TERMINATE-CCVS.
      *>     EXIT PROGRAM.
      *> TERMINATE-CALL.
           STOP     RUN.
       INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
              PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
                ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       HEAD-ROUTINE.
           MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
           MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
       COLUMN-NAMES-ROUTINE.
           MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
       END-ROUTINE.
           MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
       END-RTN-EXIT.
           MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
       END-ROUTINE-1.
            ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
            ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
            ADD PASS-COUNTER TO ERROR-HOLD.
      *>      IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
            MOVE PASS-COUNTER TO CCVS-E-4-1.
            MOVE ERROR-HOLD TO CCVS-E-4-2.
            MOVE CCVS-E-4 TO CCVS-E-2-2.
            MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
        END-ROUTINE-12.
            MOVE "TEST(S) FAILED" TO ENDER-DESC.
           IF       ERROR-COUNTER IS EQUAL TO ZERO
               MOVE "NO " TO ERROR-TOTAL
               ELSE
               MOVE ERROR-COUNTER TO ERROR-TOTAL.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-13.
           IF DELETE-CNT IS EQUAL TO ZERO
               MOVE "NO " TO ERROR-TOTAL  ELSE
               MOVE DELETE-CNT TO ERROR-TOTAL.
           MOVE "TEST(S) DELETED     " TO ENDER-DESC.
           MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
            IF   INSPECT-COUNTER EQUAL TO ZERO
                MOVE "NO " TO ERROR-TOTAL
            ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
            MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
            MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
           MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
       WRITE-LINE.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 50
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN.
       WRT-LN.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT.
           PERFORM WRT-LN.
       FAIL-ROUTINE.
           IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
           IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
           MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
           GO TO FAIL-ROUTINE-EX.
       FAIL-ROUTINE-WRITE.
           MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
       FAIL-ROUTINE-EX. EXIT.
       BAIL-OUT.
           IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
           IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
       BAIL-OUT-WRITE.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
       BAIL-OUT-EX. EXIT.
       CCVS1-EXIT.
           EXIT.
       BEGIN-FILE-GENERATION.
           MOVE FILE-RECORD-INFO-SKELETON TO FILE-RECORD-INFO (1).
           MOVE "GEN-FI" TO XFILE-NAME (1).
           MOVE "GEN-RE" TO XRECORD-NAME (1).
           MOVE "DB104A" TO XPROGRAM-NAME (1).
           MOVE 80 TO XRECORD-LENGTH (1).
           OPEN OUTPUT GEN-FILE.
           MOVE 99 TO XRECORD-NUMBER (1).
       GEN-LOOP.
           MOVE FILE-RECORD-INFO (1) TO GEN-REC.
           WRITE GEN-REC.
           IF XRECORD-NUMBER (1) IS GREATER THAN 5
               SUBTRACT 5 FROM XRECORD-NUMBER (1)
               GO TO GEN-LOOP.
       END-OF-GEN-LOOP.
           MOVE 98 TO XRECORD-NUMBER (1).
           PERFORM GEN-LOOP.
           MOVE 97 TO XRECORD-NUMBER (1).
           PERFORM GEN-LOOP.
           MOVE 96 TO XRECORD-NUMBER (1).
           PERFORM GEN-LOOP.
           MOVE 95 TO XRECORD-NUMBER (1).
           PERFORM GEN-LOOP.
           CLOSE GEN-FILE.
      *> *****************************************************************
      *>     THE DEBUG-LINE (INSPT) SUBTESTS FOR THE TESTS NAMED IN THE  *
      *>     OUTPUT REPORT AS "SORT-IN-2" AND "SORT-OUT-2" SHOULD POINT  *
      *>     TO THE "SORT" STATEMENT WHICH APPEARS IN THE PARAGRAPH      *
      *>     BELOW NAMED "BEGIN-TESTS".                                  *
      *> *****************************************************************
       BEGIN-TESTS.
           MOVE 0 TO RESULT-FLAG.
           SORT SORT-FILE ON ASCENDING KEY SORT-REC-NO
               INPUT PROCEDURE IS SORT-IN
               OUTPUT PROCEDURE IS SORT-OUT.
           GO TO AFTER-SORT.
       SORT-IN SECTION.
       SORT-IN-1.
           MOVE "SORT-IN-1" TO PAR-NAME.
           IF RESULT-FLAG IS NOT EQUAL TO 1
               MOVE "DEBUG PROCEDURE NOT EXECUTED" TO RE-MARK
               PERFORM FAIL-1
               PERFORM SORT-IN-WRITE
               GO TO SORT-IN-5
               ELSE  PERFORM PASS-1
               MOVE "DEBUG PROCEDURE EXECUTED" TO RE-MARK.
           PERFORM SORT-IN-WRITE.
           GO TO SORT-IN-2.
       SORT-IN-DELETE.
           MOVE "SORT-IN" TO PAR-NAME.
           PERFORM DE-LETE-1.
           PERFORM SORT-IN-WRITE.
           GO TO SORT-IN-5.
       SORT-IN-WRITE.
           MOVE "DEBUG SORT INPUT" TO FEATURE.
           PERFORM PRINT-DETAIL-1.
       SORT-IN-2.
           MOVE "SORT-IN-2" TO PAR-NAME.
           MOVE DBLINE-HOLD TO COMPUTED-A.
           MOVE "DEBUG-LINE, SEE NEXT LINE" TO RE-MARK.
           MOVE "<===  DEBUG-LINE" TO CORRECT-A.
           PERFORM   INSPT-1.
           PERFORM SORT-IN-WRITE.
       SORT-IN-3.
           MOVE DBNAME-HOLD TO SIZE-7.
           IF SIZE-7 IS EQUAL TO "SORT-IN"
               PERFORM PASS-1 ELSE
               MOVE "SORT-IN" TO CORRECT-A
               MOVE DBNAME-HOLD TO COMPUTED-A
               PERFORM FAIL-1.
           MOVE "DEBUG-NAME" TO RE-MARK.
           MOVE "SORT-IN-3" TO PAR-NAME.
           PERFORM SORT-IN-WRITE.
       SORT-IN-4.
           MOVE DBCONT-HOLD TO SIZE-10.
           IF SIZE-10 IS EQUAL TO "SORT INPUT"
               PERFORM PASS-1 ELSE
               MOVE "SORT INPUT" TO CORRECT-A
               MOVE DBCONT-HOLD TO COMPUTED-A
               PERFORM FAIL-1.
           MOVE "DEBUG-CONTENTS" TO RE-MARK.
           MOVE "SORT-IN-4" TO PAR-NAME.
           PERFORM SORT-IN-WRITE.
       SORT-IN-5.
           OPEN INPUT GEN-FILE.
           MOVE 0 TO RESULT-FLAG.
      *> *****************************************************************
      *>     THE DEBUG-LINE (INSPT) SUBTEST FOR THE TEST NAMED IN THE    *
      *>     OUTPUT REPORT AS "SORT-USE-TEST" SHOULD POINT TO THE        *
      *>     EXECUTABLE STATEMENT WHICH FOLLOWS THIS COMMENT SET AND     *
      *>     WHICH READS, "READ GEN-FILE".                               *
      *> *****************************************************************
       SORT-USE-TEST.
           READ GEN-FILE
      *>         AT END GO TO SORT-USE-DELETE.
      *> 
      *>     IN CASE IMPLEMENTATION FAILS TO NOTIFY PROGRAM OF
      *>     END-OF-FILE VIA STATUS OR DECLARATIVE PROC, REMOVE ASTERISK
      *>     FROM THE FIRST OF THESE COMMENT LINES AND PERMIT THE AT END
      *>     CLAUSE TO BE COMPILED; THIS WILL RESULT IN TEST DELETION.
      *> 
           IF RESULT-FLAG IS EQUAL TO 3
               CLOSE GEN-FILE GO TO SORT-USE-1.
           IF RESULT-FLAG IS EQUAL TO 4
               CLOSE GEN-FILE GO TO SORT-USE-3.
           IF RESULT-FLAG IS EQUAL TO 7
               CLOSE GEN-FILE
               PERFORM PASS-1
               MOVE "BOTH PROCEDURES EXECUTED" TO RE-MARK
               PERFORM SORT-USE-WRITE
               GO TO SORT-USE-2.
           IF END-FLAG IS EQUAL TO "1"
               CLOSE GEN-FILE GO TO SORT-USE-4.
           RELEASE SORT-REC FROM GEN-REC.
           GO TO SORT-USE-TEST.
       SORT-USE-DELETE.
           CLOSE GEN-FILE.
           PERFORM DE-LETE-1.
           GO TO SORT-USE-WRITE.
       SORT-USE-1.
           MOVE "ERROR PROCEDURE NOT COMPLETED" TO RE-MARK.
           PERFORM SORT-USE-WRITE.
       SORT-USE-2.
           MOVE "DEBUG-LINE, SEE NEXT LINE" TO RE-MARK.
           MOVE "<===  DEBUG-LINE" TO CORRECT-A.
           MOVE DBLINE-HOLD TO COMPUTED-A.
           PERFORM   INSPT-1.
           PERFORM SORT-USE-WRITE.
           MOVE DBNAME-HOLD TO SIZE-11.
           IF SIZE-11 IS EQUAL TO "AT-END-PROC"
               PERFORM PASS-1 ELSE
               MOVE DBNAME-HOLD TO COMPUTED-A
               MOVE "AT-END-PROC" TO CORRECT-A
               PERFORM FAIL-1.
           MOVE "DEBUG-NAME" TO RE-MARK.
           PERFORM SORT-USE-WRITE.
           MOVE DBCONT-HOLD TO SIZE-13.
           IF SIZE-13 IS EQUAL TO "USE PROCEDURE"
               PERFORM PASS-1 ELSE
               MOVE DBCONT-HOLD TO COMPUTED-A
               MOVE "USE PROCEDURE" TO CORRECT-A
               PERFORM FAIL-1.
           MOVE "DEBUG-CONTENTS" TO RE-MARK.
           GO TO SORT-USE-WRITE.
       SORT-USE-3.
           MOVE "DEBUG ON USE PROC NOT EXECUTED" TO RE-MARK.
           PERFORM FAIL-1.
           GO TO SORT-USE-WRITE.
       SORT-USE-4.
           MOVE "DEBUG AND USE PROCS BOTH FAIL" TO RE-MARK.
           PERFORM FAIL-1.
       SORT-USE-WRITE.
           MOVE "SORT-USE-TEST" TO PAR-NAME.
           MOVE "DEBUG USE PROC" TO FEATURE.
           PERFORM PRINT-DETAIL-1.
       SORT-USE-DONE.
           GO TO SORT-IN-EXIT.
       INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL-1.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
              PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
                ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       WRITE-LINE-1.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 50
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
      *>         MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN-1.
       WRT-LN-1.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT-1.
           PERFORM WRT-LN-1.
       FAIL-ROUTINE-1.
           IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
           IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
           MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
           GO TO FAIL-ROUTINE-EX-1.
       FAIL-RTN-WRITE-1.
           MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
       FAIL-ROUTINE-EX-1. EXIT.
       BAIL-OUT-1.
           IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
           IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
       BAIL-OUT-WRITE-1.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
       BAIL-OUT-EX-1. EXIT.
       SORT-IN-EXIT.
           MOVE 0 TO RESULT-FLAG.
       SORT-OUT SECTION.
       SORT-OUT-1.
           MOVE "SORT-OUT-1" TO PAR-NAME.
           IF RESULT-FLAG IS NOT EQUAL TO 2
               PERFORM FAIL-2
               MOVE "DEBUG PROCEDURE NOT EXECUTED" TO RE-MARK
               GO TO SORT-OUT-WRITE.
           PERFORM PASS-2.
           MOVE "DEBUG PROCEDURE EXECUTED" TO RE-MARK.
           PERFORM SORT-OUT-WRITE.
       SORT-OUT-2.
           MOVE "SORT-OUT-2" TO PAR-NAME.
           MOVE DBLINE-HOLD TO COMPUTED-A.
           MOVE "DEBUG-LINE, SEE NEXT LINE" TO RE-MARK.
           MOVE "<===  DEBUG-LINE" TO CORRECT-A.
           PERFORM   INSPT-2.
           PERFORM SORT-OUT-WRITE.
       SORT-OUT-3.
           MOVE "SORT-OUT-3" TO PAR-NAME.
           MOVE DBNAME-HOLD TO SIZE-8.
           IF SIZE-8 IS EQUAL TO "SORT-OUT"
               PERFORM PASS-2 ELSE
               MOVE "SORT-OUT" TO CORRECT-A
               MOVE DBNAME-HOLD TO COMPUTED-A
               PERFORM FAIL-2.
           MOVE "DEBUG-NAME" TO RE-MARK.
           PERFORM SORT-OUT-WRITE.
       SORT-OUT-4.
           MOVE "SORT-OUT-4" TO PAR-NAME.
           MOVE DBCONT-HOLD TO SIZE-11.
           IF SIZE-11 IS EQUAL TO "SORT OUTPUT"
               PERFORM PASS-2 ELSE
               MOVE "SORT OUTPUT" TO CORRECT-A
               MOVE DBCONT-HOLD TO COMPUTED-A
           PERFORM FAIL-2.
           MOVE "DEBUG-CONTENTS" TO RE-MARK.
           GO TO SORT-OUT-WRITE.
       SORT-OUT-DELETE.
           MOVE "SORT-OUT" TO PAR-NAME.
           PERFORM DE-LETE-2.
       SORT-OUT-WRITE.
           MOVE "DEBUG SORT OUTPUT" TO FEATURE.
           PERFORM PRINT-DETAIL-2.
       SORT-OUT-5.
           OPEN OUTPUT GEN-FILE.
       SORT-OUT-6.
           RETURN SORT-FILE INTO GEN-REC
               AT END GO TO SORT-OUT-EXIT.
           WRITE GEN-REC.
           GO TO SORT-OUT-6.
       INSPT-2. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
       PASS-2.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
       FAIL-2.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
       DE-LETE-2.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
           MOVE "****TEST DELETED****" TO RE-MARK.
       PRINT-DETAIL-2.
           IF REC-CT NOT EQUAL TO ZERO
                   MOVE "." TO PARDOT-X
                   MOVE REC-CT TO DOTVALUE.
           MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-2.
           IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-2
              PERFORM FAIL-ROUTINE-2 THRU FAIL-ROUTINE-EX-2
                ELSE PERFORM BAIL-OUT-2 THRU BAIL-OUT-EX-2.
           MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
           MOVE SPACE TO CORRECT-X.
           IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
           MOVE     SPACE TO RE-MARK.
       WRITE-LINE-2.
           ADD 1 TO RECORD-COUNT.
      *>     IF RECORD-COUNT GREATER 50
      *>         MOVE DUMMY-RECORD TO DUMMY-HOLD
      *>         MOVE SPACE TO DUMMY-RECORD
      *>         WRITE DUMMY-RECORD AFTER ADVANCING PAGE
      *>         MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-2
      *>         MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-2 2 TIMES
      *>         MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-2
      *>         MOVE DUMMY-HOLD TO DUMMY-RECORD
      *>         MOVE ZERO TO RECORD-COUNT.
           PERFORM WRT-LN-2.
       WRT-LN-2.
           WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
           MOVE SPACE TO DUMMY-RECORD.
       BLANK-LINE-PRINT-2.
           PERFORM WRT-LN-2.
       FAIL-ROUTINE-2.
           IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
           IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
           MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
           GO TO FAIL-ROUTINE-EX-2.
       FAIL-RTN-WRITE-2.
           MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-2
           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-2 2 TIMES.
       FAIL-ROUTINE-EX-2. EXIT.
       BAIL-OUT-2.
           IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-2.
           IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-2.
       BAIL-OUT-WRITE-2.
           MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
           MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
       BAIL-OUT-EX-2. EXIT.
       SORT-OUT-EXIT.
           CLOSE GEN-FILE.
           MOVE 0 TO RESULT-FLAG.
       END-OF-SORT SECTION.
       AFTER-SORT.
           EXIT.
      *> DUMP-CODING SECTION.
      *> BEGIN-DUMP.
      *>     OPEN INPUT GEN-FILE.
      *>     PERFORM BLANK-LINE-PRINT.
      *>     MOVE " DUMP OF GEN-FILE FOLLOWS:" TO PRINT-REC.
      *>     PERFORM WRITE-LINE.
      *> DUMP-FILE-1.
      *>     READ GEN-FILE AT END GO TO DUMP-FILE-2.
      *>     MOVE GEN-REC TO PRINT-REC.
      *>     PERFORM WRITE-LINE.
      *>     GO TO DUMP-FILE-1.
      *> DUMP-FILE-2.
      *>     CLOSE GEN-FILE.
       CCVS-EXIT SECTION.
       CCVS-999999.
           GO TO CLOSE-FILES.
      *> END-OF,DB104A