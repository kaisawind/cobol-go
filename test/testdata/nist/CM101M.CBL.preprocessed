      *> HEADER,COBOL,CM101M
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           CM101M.
       AUTHOR.
      *>CE     FEDERAL COMPILER TESTING CENTER.
      *>  INSTALLATION.
      *>CE     GENERAL SERVICES ADMINISTRATION
      *>CE *     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
      *>CE      SOFTWARE DEVELOPMENT OFFICE.
      *>CE      5203 LEESBURG PIKE  SUITE 1100
      *>CE      FALLS CHURCH VIRGINIA 22041.
      *>CE 
      *>CE      PHONE   (703) 756-6153
      *>CE 
      *>CE      " HIGH       ".
       DATE-WRITTEN.
      *>CE     CCVS-74 VERSION 4.0 - 1980 JULY 1.
      *>CE     CREATION DATE     /    VALIDATION DATE
      *>CE     "4.2 ".
       SECURITY.
      *>CE     NONE.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE
           LABEL RECORDS
           XXXXX084
           DATA RECORD IS PRINT-REC DUMMY-RECORD.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       WORKING-STORAGE SECTION.
       77  PASSWORD1 PIC X(10) VALUE
           XXXXX031.
       77  DISABLE-STATUS PIC XX VALUE "99".
       77  POLL-COUNT PIC 9(8).
       77  INIT-TIME PIC 9(8).
       77  COMP-TIME PIC 9(8).
       01  SYSTEM-TIME.
           02  SYS-HRS PIC 99.
           02  SYS-MINS PIC 99.
           02  SYS-SECS PIC 99V99.
       01  MSG-TIME.
           02  HOURS PIC 99.
           02  MINUTES PIC 99.
           02  SECONDS PIC 99V99.
       01  SPEC-LINE-1.
           02  FILLER PIC X(40) VALUE
           " INITIAL ENABLE RETURNED STATUS CODE OF ".
           02  INIT-ENABLE-STATUS PIC XX.
       01  INCOMING-MSG.
           02  KILL-FIELD PIC X(4).
           02  FILLER PIC X(68).
       01  LOG-HDR-1.
           02  FILLER PIC X(48) VALUE SPACES.
           02  FILLER PIC X(24) VALUE "LOG OF INCOMING MESSAGES".
       01  LOG-HDR-2.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(19) VALUE "SYMBOLIC SOURCE IS ".
           02  SYM-SOURCE PIC X(25).
           02  FILLER PIC X(16) VALUE "MESSAGE DATE IS ".
           02  MSG-DATE PIC 9(6) VALUE ZERO.
       01  LOG-HDR-3.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(12) VALUE "TIME  RECVD".
           02  FILLER PIC X(9) VALUE "LOG LAG".
           02  FILLER PIC X(7) VALUE "LENGTH".
           02  FILLER PIC X(4) VALUE "END".
           02  FILLER PIC X(3) VALUE "QD".
           02  FILLER PIC X(40) VALUE "POLL COUNT".
           02  FILLER PIC X(16) VALUE "MESSAGE CONTENTS".
       01  LOG-HDR-4.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(11) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACES.
           02  FILLER PIC X(7) VALUE ALL "-".
           02  FILLER PIC X(2) VALUE SPACES.
           02  FILLER PIC X(6) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC XXX VALUE "---".
           02  FILLER PIC X VALUE SPACES.
           02  FILLER PIC XX VALUE "--".
           02  FILLER PIC X VALUE SPACES.
           02  FILLER PIC X(10) VALUE ALL "-".
           02  FILLER PIC X(2) VALUE SPACES.
           02  FILLER PIC X(72) VALUE ALL "-".
       01  LOG-LINE.
           02  FILLER PIC X VALUE SPACE.
           02  RECEIPT-TIME.
               03  HOURS PIC 99.
               03  FILLER PIC X VALUE ":".
               03  MINUTES PIC 99.
               03  FILLER PIC X VALUE ":".
               03  SECONDS PIC 99.99.
           02  LAG-TIME PIC -(4)9.99.
           02  FILLER PIC XX VALUE SPACES.
           02  MESSAGE-LENGTH PIC ZZZ9.
           02  FILLER PIC XXX VALUE SPACES.
           02  SENTINEL PIC XXX.
           02  FILLER PIC X VALUE SPACES.
           02  QUEUE-DEPTH PIC 99.
           02  FILLER PIC X VALUE SPACES.
           02  IDLE-COUNT PIC ZZ,ZZZ,ZZ9.
           02  IDLE-OVERFLOW REDEFINES IDLE-COUNT PIC X(10).
           02  FILLER PIC XX VALUE SPACES.
           02  MSG PIC X(72).
           66  LONG-NARRATIVE RENAMES LAG-TIME THRU MSG.
           66  SHORT-NARRATIVE RENAMES IDLE-COUNT THRU MSG.
       01  TEST-RESULTS.
           02 FILLER                    PICTURE X VALUE SPACE.
           02 FEATURE                   PICTURE X(18).
           02 FILLER                    PICTURE X VALUE SPACE.
           02 P-OR-F                    PICTURE X(5).
           02 FILLER                    PICTURE X  VALUE SPACE.
           02  PAR-NAME PIC X(20).
           02 FILLER                    PICTURE X VALUE SPACE.
           02  COMPUTED-A.
               03  FILLER PIC X(9) VALUE SPACES.
               03  COMPUTED-STATUS PIC XX.
               03  FILLER PIC X(9) VALUE SPACES.
           02 FILLER                    PICTURE X VALUE SPACE.
           02  CORRECT-A.
               03  FILLER PIC X(9) VALUE SPACES.
               03  CORRECT-STATUS PIC XX.
               03  FILLER PIC X(9) VALUE SPACES.
           02 FILLER                    PICTURE X VALUE SPACE.
           02 RE-MARK                   PICTURE X(30).
       01  COLUMNS-LINE-1.
           02  FILLER PIC X(3) VALUE SPACES.
           02  FILLER PIC X(17) VALUE "FEATURE TESTED".
           02  FILLER PIC X(9) VALUE "RESLT".
           02  FILLER PIC X(21) VALUE "PARAGRAPH NAME".
           02  FILLER PIC X(22) VALUE "COMPUTED DATA".
           02  FILLER PIC X(29) VALUE "CORRECT DATA".
           02  FILLER PIC X(7) VALUE "REMARKS".
       01  COLUMNS-LINE-2.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(18) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(5) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(20) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(20) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(20) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(31) VALUE ALL "-".
       01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
       01  REC-CT PICTURE 99 VALUE ZERO.
       01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
       01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
       01  INSPECT-COUNTER PIC 999 VALUE ZERO.
       01  PASS-COUNTER PIC 999 VALUE ZERO.
       01  TOTAL-ERROR PIC 999 VALUE ZERO.
       01  ERROR-HOLD PIC 999 VALUE ZERO.
       01  DUMMY-HOLD PIC X(120) VALUE SPACE.
       01  RECORD-COUNT PIC 9(5) VALUE ZERO.
       01  CCVS-H-1.
           02  FILLER   PICTURE X(27)  VALUE SPACE.
           02 FILLER PICTURE X(67) VALUE
           " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION   SYSTEM".
           02  FILLER     PICTURE X(26)  VALUE SPACE.
       01  CCVS-H-2.
           02 FILLER PICTURE X(52) VALUE IS
           "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
           02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
           02 TEST-ID PICTURE IS X(9).
           02 FILLER PICTURE IS X(40) VALUE IS SPACE.
       01  CCVS-H-3.
           02  FILLER PICTURE X(34) VALUE
           " FOR OFFICIAL USE ONLY    ".
           02  FILLER PICTURE X(58) VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER PICTURE X(28) VALUE
           "  COPYRIGHT   1974 ".
       01  CCVS-E-1.
           02 FILLER PICTURE IS X(52) VALUE IS SPACE.
           02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN PICTURE IS X(9).
           02 FILLER PICTURE X(45) VALUE IS
           " NTIS DISTRIBUTION COBOL 74".
       01  CCVS-E-2.
           02  FILLER                   PICTURE X(31)  VALUE
           SPACE.
           02  FILLER                   PICTURE X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
               03 FILLER PICTURE IS X VALUE IS SPACE.
               03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER PICTURE X(22) VALUE
           " FOR OFFICIAL USE ONLY".
           02  FILLER PICTURE X(12) VALUE SPACE.
           02  FILLER PICTURE X(58) VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER PICTURE X(13) VALUE SPACE.
           02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
       01  CCVS-E-4.
           02 CCVS-E-4-1 PIC XXX VALUE SPACE.
           02 FILLER PIC XXXX VALUE " OF ".
           02 CCVS-E-4-2 PIC XXX VALUE SPACE.
           02 FILLER PIC X(40) VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
           02 INFO-TEXT.
           04 FILLER PIC X(20) VALUE SPACE.
           04 XXCOMPUTED PIC X(20).
           04 FILLER PIC X(5) VALUE SPACE.
           04 XXCORRECT PIC X(20).
       01  HYPHEN-LINE.
           02 FILLER PICTURE IS X VALUE IS SPACE.
           02 FILLER PICTURE IS X(65) VALUE IS "*****************************************************************".
           02 FILLER PICTURE IS X(54) VALUE IS "******************************************************".
       01  CCVS-PGM-ID PIC X(6) VALUE
           "CM101M".
       COMMUNICATION SECTION.
       CD  CM-INQUE-1 FOR INPUT
           SYMBOLIC QUEUE IS MAIN-QUEUE
           SYMBOLIC SUB-QUEUE-1 IS NO-SPEC-1
           SYMBOLIC SUB-QUEUE-2 IS NO-SPEC-2
           SYMBOLIC SUB-QUEUE-3 IS NO-SPEC-3
           MESSAGE DATE IS DATE-RECEIVED
           MESSAGE TIME IS TIME-RECEIVED
           SYMBOLIC SOURCE IS WHERE-FROM
           TEXT LENGTH IS MSG-LENGTH
           END KEY IS END-KEY
           STATUS KEY IS STATUS-KEY
           MESSAGE COUNT IS MSG-COUNT.
       PROCEDURE    DIVISION.
       SECT-CM101M-0001 SECTION.
       CM101M-INIT.
           OPEN     OUTPUT PRINT-FILE.
           MOVE "CM101M     " TO TEST-ID.
           MOVE     TEST-ID TO ID-AGAIN.
           MOVE    SPACE TO TEST-RESULTS.
           PERFORM HEAD-ROUTINE.
           MOVE
           XXXXX030
           TO MAIN-QUEUE.
           MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           ENABLE INPUT  CM-INQUE-1 WITH KEY
           XXXXX031.
           MOVE STATUS-KEY TO INIT-ENABLE-STATUS.
           MOVE SPEC-LINE-1 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE HYPHEN-LINE TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
       LOG-INIT.
           MOVE ZERO TO POLL-COUNT.
           MOVE ALL "*" TO MSG.
       LOG-MSG.
           MOVE   SPACES TO INCOMING-MSG.
           RECEIVE CM-INQUE-1 MESSAGE INTO INCOMING-MSG
               NO DATA PERFORM INCREMENT-POLL-COUNT GO TO LOG-MSG.
           ACCEPT SYSTEM-TIME FROM TIME.
           ACCEPT CM-INQUE-1 MESSAGE COUNT.
           IF STATUS-KEY IS NOT EQUAL TO ZERO
               DISPLAY "RUN ABORTED - STATUS KEY WAS " STATUS-KEY
               STOP RUN.
           IF MSG-DATE IS EQUAL TO ZERO PERFORM LOG-HEADER.
           IF KILL-FIELD IS EQUAL TO "KILL"
               ACCEPT INIT-TIME FROM TIME
               DISABLE INPUT CM-INQUE-1 WITH KEY
           XXXXX031
               ACCEPT COMP-TIME FROM TIME
               MOVE STATUS-KEY TO DISABLE-STATUS.
           MOVE TIME-RECEIVED TO MSG-TIME.
           MOVE CORR MSG-TIME TO RECEIPT-TIME.
           COMPUTE LAG-TIME =
               ((SYS-HRS * 3600) + (SYS-MINS * 60) + SYS-SECS) -
               ((HOURS OF MSG-TIME * 3600) + (MINUTES OF MSG-TIME * 60)
               + SECONDS OF MSG-TIME).
           IF END-KEY IS EQUAL TO "3"
               MOVE "EGI" TO SENTINEL
               ELSE IF END-KEY IS EQUAL TO "2"
               MOVE "EMI" TO SENTINEL
                   ELSE MOVE END-KEY TO SENTINEL.
           MOVE MSG-COUNT TO QUEUE-DEPTH.
           MOVE MSG-LENGTH TO MESSAGE-LENGTH.
           IF POLL-COUNT IS EQUAL TO 99999999
               MOVE " OVERFLOW " TO IDLE-OVERFLOW
               ELSE MOVE POLL-COUNT TO IDLE-COUNT.
           MOVE INCOMING-MSG TO MSG.
           MOVE LOG-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
       LOG-MSG-01.
           IF KILL-FIELD IS EQUAL TO "WAIT"
               PERFORM GET-INITIAL-TIME
               PERFORM DELAY-FOR-30-SECS
               GO TO LOG-INIT.
           IF KILL-FIELD IS NOT EQUAL TO "KILL" GO TO LOG-INIT.
       DISABLE-CM-INQUE-1.
           MOVE INIT-TIME TO MSG-TIME.
           MOVE CORR MSG-TIME TO RECEIPT-TIME.
           MOVE "-DISABLE COMMAND INITIATED FROM PROGRAM"
               TO LONG-NARRATIVE.
           MOVE LOG-LINE TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE COMP-TIME TO MSG-TIME.
           MOVE CORR MSG-TIME TO RECEIPT-TIME.
           MOVE "- STATUS CODE OF" TO LONG-NARRATIVE.
           MOVE DISABLE-STATUS TO QUEUE-DEPTH.
           MOVE "AND EXECUTION CONTROL RETURNED FROM MCS"
               TO SHORT-NARRATIVE.
           MOVE LOG-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE SPACES TO PRINT-REC.
           PERFORM WRITE-LINE.
       GET-INITIAL-TIME.
           ACCEPT SYSTEM-TIME FROM TIME.
           COMPUTE INIT-TIME =
               SYS-HRS * 3600 + SYS-MINS * 60 + SYS-SECS.
       LOOK-FOR-LATE-TRANSMISSIONS.
           ACCEPT CM-INQUE-1 MESSAGE COUNT.
           IF MSG-COUNT IS NOT EQUAL TO ZERO
               PERFORM LOG-INIT THRU LOG-MSG
               GO TO LOOK-FOR-LATE-TRANSMISSIONS.
       GET-TIME-DIFFERENCE.
           ACCEPT SYSTEM-TIME FROM TIME.
           COMPUTE COMP-TIME =
               SYS-HRS * 3600 + SYS-MINS * 60 + SYS-SECS - INIT-TIME.
       CHECK-FOR-15.
           IF COMP-TIME IS LESS THAN 15
               GO TO LOOK-FOR-LATE-TRANSMISSIONS.
       15-SECONDS-HAVE-ELAPSED.
           MOVE HYPHEN-LINE TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE HYPHEN-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
       STATUS-TESTS-INIT.
           MOVE " BEGIN INPUT STATUS TESTS" TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE COLUMNS-LINE-1 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE COLUMNS-LINE-2 TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE SPACES TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE "MCS STATUS WORD" TO FEATURE.
       REC-STATUS-TEST-01.
           MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           RECEIVE CM-INQUE-1 MESSAGE INTO INCOMING-MSG
               NO DATA ADD 0 TO POLL-COUNT.
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO REC-STATUS-WRITE-01.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO REC-STATUS-WRITE-01.
       REC-STATUS-DELETE-01.
           PERFORM DE-LETE.
       REC-STATUS-WRITE-01.
           MOVE "REC-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       REC-STATUS-TEST-02.
           MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE "DUMMYNAME" TO NO-SPEC-1.
           MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
           RECEIVE CM-INQUE-1 MESSAGE INTO INCOMING-MSG
               NO DATA ADD 0 TO POLL-COUNT.
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO REC-STATUS-WRITE-02.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO REC-STATUS-WRITE-02.
       REC-STATUS-DELETE-02.
           PERFORM DE-LETE.
       REC-STATUS-WRITE-02.
           MOVE "REC-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ACCPT-STATUS-TEST-01.
           MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           ACCEPT CM-INQUE-1 MESSAGE COUNT.
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO ACCPT-STATUS-WRITE-01.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO ACCPT-STATUS-WRITE-01.
       ACCPT-STATUS-DELETE-01.
           PERFORM DE-LETE.
       ACCPT-STATUS-WRITE-01.
           MOVE "ACCPT-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ACCPT-STATUS-TEST-02.
           MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE "DUMMYNAME" TO NO-SPEC-1.
           MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
           ACCEPT CM-INQUE-1 COUNT.
           IF STATUS-KEY IS EQUAL TO "20"
           PERFORM PASS GO TO ACCPT-STATUS-WRITE-02.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
            GO TO ACCPT-STATUS-WRITE-02.
       ACCPT-STATUS-DELETE-02.
           PERFORM DE-LETE.
       ACCPT-STATUS-WRITE-02.
           MOVE "ACCPT-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ENABL-STATUS-TEST-01.
           MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           ENABLE INPUT CM-INQUE-1 WITH KEY
           XXXXX031
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO ENABL-STATUS-WRITE-01.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO ENABL-STATUS-WRITE-01.
       ENABL-STATUS-DELETE-01.
           PERFORM DE-LETE.
       ENABL-STATUS-WRITE-01.
           MOVE "ENABL-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ENABL-STATUS-TEST-02.
           MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE "DUMMYNAME" TO NO-SPEC-1.
           MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
           ENABLE INPUT CM-INQUE-1 KEY
               PASSWORD1.
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO ENABL-STATUS-WRITE-02.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO ENABL-STATUS-WRITE-02.
       ENABL-STATUS-DELETE-02.
           PERFORM DE-LETE.
       ENABL-STATUS-WRITE-02.
           MOVE "ENABL-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ENABL-STATUS-TEST-03.
           MOVE "INVALID PASSWORD USED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           ENABLE INPUT CM-INQUE-1 WITH KEY "LETMEIN".
           IF STATUS-KEY IS EQUAL TO "40"
               PERFORM PASS GO TO ENABL-STATUS-WRITE-03.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "40" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO ENABL-STATUS-WRITE-03.
       ENABL-STATUS-DELETE-03.
           PERFORM DE-LETE.
       ENABL-STATUS-WRITE-03.
           MOVE "ENABL-STATUS-TEST-03" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       ENABL-STATUS-TEST-04.
           MOVE "NO QUEUE NAME / WRONG PASSWORD" TO RE-MARK.
           MOVE  "99" TO STATUS-KEY.
           MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           ENABLE INPUT CM-INQUE-1 WITH KEY
               "LETMEIN".
           MOVE "INFO" TO P-OR-F.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "  INFO TEST FOR BOTH" TO CORRECT-A.
           GO TO ENABL-STATUS-WRITE-04.
       ENABL-STATUS-DELETE-04.
           PERFORM DE-LETE.
       ENABL-STATUS-WRITE-04.
           MOVE "ENABL-STATUS-TEST-04" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       DISAB-STATUS-TEST-01.
           MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           DISABLE INPUT CM-INQUE-1 WITH KEY
           XXXXX031
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO DISAB-STATUS-WRITE-01.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO DISAB-STATUS-WRITE-01.
       DISAB-STATUS-DELETE-01.
           PERFORM DE-LETE.
       DISAB-STATUS-WRITE-01.
           MOVE "DISAB-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       DISAB-STATUS-TEST-02.
           MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE "DUMMYNAME" TO NO-SPEC-1.
           MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
           DISABLE INPUT CM-INQUE-1 WITH KEY
           PASSWORD1.
           IF STATUS-KEY IS EQUAL TO "20"
               PERFORM PASS GO TO DISAB-STATUS-WRITE-02.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "20" TO CORRECT-STATUS.
           PERFORM FAIL.
            GO TO DISAB-STATUS-WRITE-02.
       DISAB-STATUS-DELETE-02.
           PERFORM DE-LETE.
       DISAB-STATUS-WRITE-02.
           MOVE "DISAB-STATUS-TEST-02" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       DISAB-STATUS-TEST-03.
           MOVE "INVALID PASSWORD USED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           DISABLE INPUT CM-INQUE-1 WITH KEY
           "KILLITNOW".
           IF STATUS-KEY IS EQUAL TO "40"
               PERFORM PASS GO TO DISAB-STATUS-WRITE-03.
           MOVE STATUS-KEY TO COMPUTED-STATUS.
           MOVE "40" TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO DISAB-STATUS-WRITE-03.
       DISAB-STATUS-DELETE-03.
           PERFORM DE-LETE.
       DISAB-STATUS-WRITE-03.
           MOVE "DISAB-STATUS-TEST-03" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       RENAB-STATUS-TEST-01.
           MOVE "RE-ENABLE PREVIOUSLY DISABLED" TO RE-MARK.
           MOVE "99" TO STATUS-KEY.
           MOVE
           XXXXX030
               TO MAIN-QUEUE.
           MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
           ENABLE INPUT CM-INQUE-1 KEY
           PASSWORD1.
           IF STATUS-KEY IS EQUAL TO ZERO
               PERFORM PASS GO TO RENAB-STATUS-WRITE-01.
           MOVE STATUS-KEY TO COMPUTED-STATUS
           MOVE ZERO TO CORRECT-STATUS.
           PERFORM FAIL.
           GO TO RENAB-STATUS-WRITE-01.
       RENAB-STATUS-DELETE-01.
           PERFORM DE-LETE.
       RENAB-STATUS-WRITE-01.
           MOVE "RENAB-STATUS-TEST-01" TO PAR-NAME.
           PERFORM PRINT-DETAIL.
       CLOSE-FILES.
           PERFORM END-ROUTINE THRU END-ROUTINE-3.
           CLOSE    PRINT-FILE.
           STOP     RUN.
       PASS.
           MOVE "PASS" TO P-OR-F.
       FAIL.
           ADD      1 TO ERROR-COUNTER.
           MOVE "FAIL*" TO P-OR-F.
       DE-LETE.
           MOVE     SPACE TO P-OR-F.
           MOVE     "    ************    " TO COMPUTED-A.
           MOVE     "    ************    " TO CORRECT-A.
           MOVE "****TEST DELETED****" TO RE-MARK.
           ADD 1 TO DELETE-CNT.
       PRINT-DETAIL.
           MOVE     TEST-RESULTS TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE     SPACE TO P-OR-F.
           MOVE     SPACE TO COMPUTED-A.
           MOVE SPACE TO CORRECT-A.
       END-ROUTINE.
           MOVE     HYPHEN-LINE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       PARA-Z.
           PERFORM  BLANK-LINE-PRINT 4 TIMES.
           MOVE     CCVS-E-1 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-1.
           PERFORM  BLANK-LINE-PRINT.
           IF       ERROR-COUNTER IS EQUAL TO ZERO
                    GO TO END-ROUTINE-2.
           MOVE     ERROR-COUNTER TO ERROR-TOTAL.
           GO TO    END-ROUTINE-3.
       END-ROUTINE-2.
           MOVE " NO" TO ERROR-TOTAL.
       END-ROUTINE-3.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           IF DELETE-CNT IS EQUAL TO ZERO
               MOVE " NO" TO ERROR-TOTAL  ELSE
           MOVE DELETE-CNT TO ERROR-TOTAL.
           MOVE "TESTS DELETED     " TO ENDER-DESC.
           MOVE CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-4.
           MOVE CCVS-E-3 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       BLANK-LINE-PRINT.
           MOVE     SPACE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       WRITE-LINE.
           WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
       INCREMENT-POLL-COUNT.
           ADD 1 TO POLL-COUNT ON SIZE ERROR ADD 0 TO POLL-COUNT.
       DELAY-FOR-30-SECS.
           PERFORM GET-TIME-DIFFERENCE.
           IF COMP-TIME IS LESS THAN 30
               GO TO DELAY-FOR-30-SECS.
       LOG-HEADER.
           MOVE LOG-HDR-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER 3 LINES.
           MOVE DATE-RECEIVED TO MSG-DATE.
           MOVE WHERE-FROM TO SYM-SOURCE.
           MOVE LOG-HDR-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 3 LINES.
           MOVE LOG-HDR-3 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE LOG-HDR-4 TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE SPACES TO PRINT-REC.
           PERFORM WRITE-LINE.
       HEAD-ROUTINE.
           MOVE CCVS-H-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER ADVANCING PAGE.
           MOVE CCVS-H-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE CCVS-H-3 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 5 LINES.
           MOVE HYPHEN-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
      *> END-OF,CM101M