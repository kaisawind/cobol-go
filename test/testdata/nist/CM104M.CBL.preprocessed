      *> HEADER,COBOL,CM104M
       IDENTIFICATION DIVISION.
       PROGRAM-ID.
           CM104M.
       AUTHOR.
      *>CE     FEDERAL COMPILER TESTING CENTER.
      *>  INSTALLATION.
      *>CE      GENERAL SERVICES ADMINISTRATION
      *>CE *     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
      *>CE      SOFTWARE DEVELOPMENT OFFICE.
      *>CE      5203 LEESBURG PIKE  SUITE 1100
      *>CE      FALLS CHURCH VIRGINIA 22041.
      *>CE 
      *>CE      PHONE   (703) 756-6153
      *>CE 
      *>CE      " HIGH       ".
       DATE-WRITTEN.
      *>CE     CCVS-74 VERSION 4.0 - 1980 JULY 1.
      *>CE     CREATION DATE     /    VALIDATION DATE
      *>CE     "4.2 ".
       SECURITY.
      *>CE     NONE.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           XXXXX082.
       OBJECT-COMPUTER.
           XXXXX083.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PRINT-FILE ASSIGN TO
           XXXXX055.
       DATA DIVISION.
       FILE SECTION.
       FD  PRINT-FILE
           LABEL RECORDS
           XXXXX084
           DATA RECORD IS PRINT-REC DUMMY-RECORD.
       01  PRINT-REC PICTURE X(120).
       01  DUMMY-RECORD PICTURE X(120).
       WORKING-STORAGE SECTION.
       01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
       01  REC-CT PICTURE 99 VALUE ZERO.
       01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
       01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
       01  INSPECT-COUNTER PIC 999 VALUE ZERO.
       01  PASS-COUNTER PIC 999 VALUE ZERO.
       01  TOTAL-ERROR PIC 999 VALUE ZERO.
       01  ERROR-HOLD PIC 999 VALUE ZERO.
       01  DUMMY-HOLD PIC X(120) VALUE SPACE.
       01  RECORD-COUNT PIC 9(5) VALUE ZERO.
       01  CCVS-H-1.
           02  FILLER   PICTURE X(27)  VALUE SPACE.
           02 FILLER PICTURE X(67) VALUE
           " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION   SYSTEM".
           02  FILLER     PICTURE X(26)  VALUE SPACE.
       01  CCVS-H-2.
           02 FILLER PICTURE X(52) VALUE IS
           "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
           02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
           02 TEST-ID PICTURE IS X(9).
           02 FILLER PICTURE IS X(40) VALUE IS SPACE.
       01  CCVS-H-3.
           02  FILLER PICTURE X(34) VALUE
           " FOR OFFICIAL USE ONLY    ".
           02  FILLER PICTURE X(58) VALUE
           "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
           02  FILLER PICTURE X(28) VALUE
           "  COPYRIGHT   1974 ".
       01  CCVS-E-1.
           02 FILLER PICTURE IS X(52) VALUE IS SPACE.
           02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
           02 ID-AGAIN PICTURE IS X(9).
           02 FILLER PICTURE X(45) VALUE IS
           " NTIS DISTRIBUTION COBOL 74".
       01  CCVS-E-2.
           02  FILLER                   PICTURE X(31)  VALUE
           SPACE.
           02  FILLER                   PICTURE X(21)  VALUE SPACE.
           02 CCVS-E-2-2.
               03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
               03 FILLER PICTURE IS X VALUE IS SPACE.
               03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
       01  CCVS-E-3.
           02  FILLER PICTURE X(22) VALUE
           " FOR OFFICIAL USE ONLY".
           02  FILLER PICTURE X(12) VALUE SPACE.
           02  FILLER PICTURE X(58) VALUE
           "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
           02  FILLER PICTURE X(13) VALUE SPACE.
           02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
       01  CCVS-E-4.
           02 CCVS-E-4-1 PIC XXX VALUE SPACE.
           02 FILLER PIC XXXX VALUE " OF ".
           02 CCVS-E-4-2 PIC XXX VALUE SPACE.
           02 FILLER PIC X(40) VALUE
            "  TESTS WERE EXECUTED SUCCESSFULLY".
       01  XXINFO.
           02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
           02 INFO-TEXT.
           04 FILLER PIC X(20) VALUE SPACE.
           04 XXCOMPUTED PIC X(20).
           04 FILLER PIC X(5) VALUE SPACE.
           04 XXCORRECT PIC X(20).
       01  HYPHEN-LINE.
           02 FILLER PICTURE IS X VALUE IS SPACE.
           02 FILLER PICTURE IS X(65) VALUE IS "*****************************************************************".
           02 FILLER PICTURE IS X(54) VALUE IS "******************************************************".
       01  CCVS-PGM-ID PIC X(6) VALUE
           "CM104M".
       01  LOG-HDR-1.
           02  FILLER PIC X(54) VALUE SPACES.
           02  FILLER PIC X(11) VALUE "MESSAGE LOG".
       01  LOG-HDR-2.
           02  FILLER PIC XXX VALUE SPACES.
           02  FILLER PIC X(12) VALUE "SYMBOLIC".
           02  FILLER PIC X(15) VALUE "TIME MCS".
           02  FILLER PIC X(6) VALUE "SEND".
           02  FILLER PIC X(4) VALUE "MSG".
           02  FILLER PIC XXX VALUE "IN".
           02  FILLER PIC X(3) VALUE "OUT".
       01  LOG-HDR-3.
           02  FILLER PIC X(4) VALUE SPACES.
           02  FILLER PIC X(11) VALUE "SOURCE".
           02  FILLER PIC X(11) VALUE "RECEIVED".
           02  FILLER PIC XXX VALUE "QD".
           02  FILLER PIC X(7) VALUE "COMPLT".
           02  FILLER PIC X(4) VALUE "LTH".
           02  FILLER PIC XXX VALUE "ST".
           02  FILLER PIC X(33) VALUE "STAT".
           02  FILLER PIC X(16) VALUE "MESSAGE CONTENTS".
       01  LOG-HDR-4.
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(12) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(11) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC XXX VALUE "--".
           02  FILLER PIC X(6) VALUE ALL "-".
           02  FILLER PIC X VALUE SPACE.
           02  FILLER PIC X(4) VALUE "---".
           02  FILLER PIC XXX VALUE "--".
           02  FILLER PIC X(5) VALUE "----".
           02  FILLER PIC X(72) VALUE ALL "-".
       01  LOG-LINE.
           02  FILLER PIC X VALUE SPACE.
           02  SYM-SOURCE PIC X(12).
           02  FILLER PIC X VALUE SPACE.
           02  LOG-TIME.
               03  HRS PIC 99.
               03  FILLER PIC X VALUE ":".
               03  MINS PIC 99.
               03  FILLER PIC X VALUE ":".
               03  SECS PIC 99.99.
           02  FILLER PIC X VALUE SPACE.
           02  QUEUE-DEPTH PIC Z9.
           02  OUT-TIME PIC -(4).99.
           02  FILLER PIC X VALUE SPACE.
           02  MSG-LENGTH PIC ZZ9.
           02  FILLER PIC X VALUE SPACE.
           02  IN-STATUS PIC XX.
           02  FILLER PIC X VALUE SPACE.
           02  OUT-STATUS PIC XX.
           02  FILLER PIC X VALUE "/".
           02  OUT-ERR-KEY PIC X.
           02  FILLER PIC X VALUE SPACE.
           02  MSG.
               03  KILL-FIELD PIC X(4).
               03  FILLER PIC X(68).
       01  SEND-TIME.
           02  S-HRS PIC 99.
           02  S-MINS PIC 99.
           02  S-SECS PIC 99V99.
       COMMUNICATION SECTION.
       CD  CM-INQUE-1 FOR INPUT.
       01  INQUE-1-SPECIFICATIONS.
           02  QUEUE-1 PIC X(24) VALUE
           XXXXX030.
           02  FILLER PIC X(30) VALUE SPACES.
           02  TIME-RECEIVED-1.
               03  HRS PIC 99.
               03  MINS PIC 99.
               03  SECS PIC 99V99.
           02  SOURCE-1 PIC X(12).
           02  IN-LENGTH-1 PIC 9(4).
           02  END-KEY-1 PIC X.
           02  IN-STATUS-1 PIC XX.
           02  MSG-COUNT-1 PIC 9(6).
       01  INQUE-1-DUMMY-RECORD PIC X(87).
       01  INQUE-1-DUMMY-TABLE.
           02  DUMMY-NAME PIC 9 OCCURS 87 TIMES INDEXED BY I1.
       CD  CM-OUTQUE-1 FOR OUTPUT.
       01  OUTQUE-1-SPECIFIACTIONS.
           02  DEST-COUNT-1 PIC 9(4) VALUE IS 1.
           02  OUT-LENGTH-1 PIC 9(4).
           02  OUT-STATUS-1 PIC XX.
           02  ERR-KEY-1 PIC X.
           02  SYM-DEST-1 PIC X(12) VALUE
           XXXXX032.
       01  OUTQUE-1-DUMMY-RECORD PIC X(23).
       01  OUTQUE-1-DUMMY-TABLE.
           02  DUMMY-NAME OCCURS 23 TIMES PIC X.
       CD  CM-INQUE-2 FOR INPUT
           FILLER FILLER FILLER FILLER FILLER FILLER SOURCE-2
           IN-LENGTH-2 END-KEY-2 IN-STATUS-2 MSG-COUNT-2.
       01  INQUE-2-RECORD.
           02  FILLER PIC X(54) VALUE
           XXXXX034.
           02  TIME-RECEIVED-2.
               03  HRS PIC 99.
               03  MINS PIC 99.
               03  SECS PIC 99V99.
           02  FILLER PIC X(25).
       CD  CM-OUTQUE-2 FOR OUTPUT
           TEXT LENGTH OUT-LENGTH-2
           STATUS KEY OUT-STATUS-2
           ERROR KEY ERR-KEY-2.
       01  OUTQUE-2-RECORD.
           02  FILLER PIC 9(4) VALUE 1.
           02  FILLER PIC X(7) VALUE SPACES.
           02  FILLER PIC X(12) VALUE
           XXXXX035.
       PROCEDURE    DIVISION.
       SECT-CM104M-0001 SECTION.
       CM104M-INIT.
           OPEN     OUTPUT PRINT-FILE.
           MOVE "CM104M     " TO TEST-ID.
           MOVE     TEST-ID TO ID-AGAIN.
           PERFORM HEAD-ROUTINE.
           PERFORM LOG-HEADER.
           ENABLE INPUT CM-INQUE-1 WITH KEY
           XXXXX031.
           ENABLE INPUT CM-INQUE-2 WITH KEY
           XXXXX036.
           ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
           XXXXX033.
           ENABLE OUTPUT CM-OUTQUE-2 WITH KEY
           XXXXX037.
       CM104M-POLL-1.
           MOVE SPACES TO MSG.
           RECEIVE CM-INQUE-1 MESSAGE INTO MSG
               NO DATA GO TO CM104M-POLL-2.
           ACCEPT CM-INQUE-1 COUNT.
           IF IN-LENGTH-1 IS GREATER THAN 72
               MOVE 72 TO OUT-LENGTH-2
                   ELSE MOVE IN-LENGTH-1 TO OUT-LENGTH-2.
           SEND CM-OUTQUE-2 FROM MSG WITH EMI.
           ACCEPT SEND-TIME FROM TIME.
           MOVE SOURCE-1 TO SYM-SOURCE.
           MOVE CORR TIME-RECEIVED-1 TO LOG-TIME.
           COMPUTE OUT-TIME =
               (S-HRS * 3600 + S-MINS * 60 + S-SECS) -
               (HRS OF TIME-RECEIVED-1 * 3600 + MINS OF TIME-RECEIVED-1
                * 60 + SECS OF TIME-RECEIVED-1).
           MOVE MSG-COUNT-1 TO QUEUE-DEPTH.
           MOVE IN-LENGTH-1 TO MSG-LENGTH.
           MOVE IN-STATUS-1 TO IN-STATUS.
           MOVE OUT-STATUS-2 TO OUT-STATUS.
           MOVE ERR-KEY-2 TO OUT-ERR-KEY.
           MOVE LOG-LINE TO PRINT-REC.
           WRITE PRINT-REC.
           IF KILL-FIELD IS EQUAL TO "KILL" GO TO CM104M-FINI.
       CM104M-POLL-2.
           MOVE SPACES TO MSG.
           RECEIVE CM-INQUE-2 MESSAGE INTO MSG
               NO DATA GO TO CM104M-POLL-1.
           ACCEPT CM-INQUE-2 COUNT.
           IF IN-LENGTH-2 IS GREATER THAN 72
               MOVE 72 TO OUT-LENGTH-1
                   ELSE MOVE IN-LENGTH-2 TO OUT-LENGTH-1.
           SEND CM-OUTQUE-1 FROM MSG WITH EMI.
           ACCEPT SEND-TIME FROM TIME.
           MOVE SOURCE-2 TO SYM-SOURCE.
           MOVE CORR TIME-RECEIVED-2 TO LOG-TIME.
           COMPUTE OUT-TIME =
               (S-HRS * 3600 + S-MINS * 60 + S-SECS) -
               (HRS OF TIME-RECEIVED-2 * 3600 + MINS OF TIME-RECEIVED-2
                * 60 + SECS OF TIME-RECEIVED-2).
           MOVE MSG-COUNT-2 TO QUEUE-DEPTH.
           MOVE IN-LENGTH-2 TO MSG-LENGTH.
           MOVE IN-STATUS-2 TO IN-STATUS.
           MOVE OUT-STATUS-1 TO OUT-STATUS.
           MOVE ERR-KEY-1 TO OUT-ERR-KEY.
           MOVE LOG-LINE TO PRINT-REC.
           WRITE PRINT-REC.
           IF KILL-FIELD IS EQUAL TO "KILL" GO TO CM104M-FINI.
           GO TO CM104M-POLL-1.
       CM104M-FINI.
           PERFORM END-ROUTINE THRU END-ROUTINE-3.
           CLOSE    PRINT-FILE.
           STOP     RUN.
       END-ROUTINE.
           MOVE     HYPHEN-LINE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       PARA-Z.
           PERFORM  BLANK-LINE-PRINT 4 TIMES.
           MOVE     CCVS-E-1 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       END-ROUTINE-3.
           MOVE     CCVS-E-2 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
           MOVE CCVS-E-3 TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       BLANK-LINE-PRINT.
           MOVE     SPACE TO DUMMY-RECORD.
           PERFORM WRITE-LINE.
       WRITE-LINE.
           WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
       LOG-HEADER.
           MOVE LOG-HDR-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER 3 LINES.
           MOVE LOG-HDR-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 3 LINES.
           MOVE LOG-HDR-3 TO PRINT-REC.
           WRITE PRINT-REC
           MOVE LOG-HDR-4 TO PRINT-REC.
           PERFORM WRITE-LINE.
           MOVE SPACES TO PRINT-REC.
           PERFORM WRITE-LINE.
       HEAD-ROUTINE.
           MOVE CCVS-H-1 TO PRINT-REC
           WRITE PRINT-REC
               AFTER ADVANCING PAGE.
           MOVE CCVS-H-2 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 2 LINES.
           MOVE CCVS-H-3 TO PRINT-REC.
           WRITE PRINT-REC
               AFTER 5 LINES.
           MOVE HYPHEN-LINE TO PRINT-REC.
           PERFORM WRITE-LINE.
      *> END-OF,CM104M